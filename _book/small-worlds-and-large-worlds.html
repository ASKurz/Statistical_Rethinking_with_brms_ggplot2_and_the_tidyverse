<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>2 Small Worlds and Large Worlds | Statistical Rethinking with brms, ggplot2, and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in McElreath’s textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="2 Small Worlds and Large Worlds | Statistical Rethinking with brms, ggplot2, and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in McElreath’s textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKURZ/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Small Worlds and Large Worlds | Statistical Rethinking with brms, ggplot2, and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in McElreath’s textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz">


<meta name="date" content="2019-04-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="the-golem-of-prague.html">
<link rel="next" href="sampling-the-imaginary.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>This is a love letter</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#updates"><i class="fa fa-check"></i>Updates</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this"><i class="fa fa-check"></i>Why this?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#my-assumptions-about-you"><i class="fa fa-check"></i>My assumptions about you</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-and-understand-this-project"><i class="fa fa-check"></i>How to use and understand this project</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#you-can-do-this-too"><i class="fa fa-check"></i>You can do this, too</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a><ul>
<li class="chapter" data-level="" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a><ul>
<li class="chapter" data-level="2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#the-garden-of-forking-data"><i class="fa fa-check"></i><b>2.1</b> The garden of forking data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#counting-possibilities."><i class="fa fa-check"></i><b>2.1.1</b> Counting possibilities.</a></li>
<li class="chapter" data-level="2.1.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#using-prior-information."><i class="fa fa-check"></i><b>2.1.2</b> Using prior information.</a></li>
<li class="chapter" data-level="2.1.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#from-counts-to-probability."><i class="fa fa-check"></i><b>2.1.3</b> From counts to probability.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#building-a-model"><i class="fa fa-check"></i><b>2.2</b> Building a model</a><ul>
<li class="chapter" data-level="2.2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#a-data-story."><i class="fa fa-check"></i><b>2.2.1</b> A data story.</a></li>
<li class="chapter" data-level="2.2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#bayesian-updating."><i class="fa fa-check"></i><b>2.2.2</b> Bayesian updating.</a></li>
<li class="chapter" data-level="2.2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#evaluate."><i class="fa fa-check"></i><b>2.2.3</b> Evaluate.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#components-of-the-model"><i class="fa fa-check"></i><b>2.3</b> Components of the model</a><ul>
<li class="chapter" data-level="2.3.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#likelihood."><i class="fa fa-check"></i><b>2.3.1</b> Likelihood.</a></li>
<li class="chapter" data-level="2.3.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#parameters."><i class="fa fa-check"></i><b>2.3.2</b> Parameters.</a></li>
<li class="chapter" data-level="2.3.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#prior."><i class="fa fa-check"></i><b>2.3.3</b> Prior.</a></li>
<li class="chapter" data-level="2.3.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#posterior."><i class="fa fa-check"></i><b>2.3.4</b> Posterior.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#making-the-model-go"><i class="fa fa-check"></i><b>2.4</b> Making the model go</a><ul>
<li class="chapter" data-level="2.4.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#grid-approximation."><i class="fa fa-check"></i><b>2.4.1</b> Grid approximation.</a></li>
<li class="chapter" data-level="2.4.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#quadratic-approximation."><i class="fa fa-check"></i><b>2.4.2</b> Quadratic approximation.</a></li>
<li class="chapter" data-level="2.4.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#markov-chain-monte-carlo."><i class="fa fa-check"></i><b>2.4.3</b> Markov chain Monte Carlo.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a><ul>
<li class="chapter" data-level="3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-from-a-grid-like-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-like approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a><ul>
<li class="chapter" data-level="3.2.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-boundaries."><i class="fa fa-check"></i><b>3.2.1</b> Intervals of defined boundaries.</a></li>
<li class="chapter" data-level="3.2.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-mass."><i class="fa fa-check"></i><b>3.2.2</b> Intervals of defined mass.</a></li>
<li class="chapter" data-level="3.2.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#point-estimates."><i class="fa fa-check"></i><b>3.2.3</b> Point estimates.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a><ul>
<li class="chapter" data-level="3.3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#dummy-data."><i class="fa fa-check"></i><b>3.3.1</b> Dummy data.</a></li>
<li class="chapter" data-level="3.3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#model-checking."><i class="fa fa-check"></i><b>3.3.2</b> Model checking.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#summary-lets-practice-in-brms"><i class="fa fa-check"></i><b>3.4</b> <del>Summary</del> Let’s practice in brms</a></li>
<li class="chapter" data-level="" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>4</b> Linear Models</a><ul>
<li class="chapter" data-level="4.1" data-path="linear-models.html"><a href="linear-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why normal distributions are normal</a><ul>
<li class="chapter" data-level="4.1.1" data-path="linear-models.html"><a href="linear-models.html#normal-by-addition."><i class="fa fa-check"></i><b>4.1.1</b> Normal by addition.</a></li>
<li class="chapter" data-level="4.1.2" data-path="linear-models.html"><a href="linear-models.html#normal-by-multiplication."><i class="fa fa-check"></i><b>4.1.2</b> Normal by multiplication.</a></li>
<li class="chapter" data-level="4.1.3" data-path="linear-models.html"><a href="linear-models.html#normal-by-log-multiplication."><i class="fa fa-check"></i><b>4.1.3</b> Normal by log-multiplication.</a></li>
<li class="chapter" data-level="4.1.4" data-path="linear-models.html"><a href="linear-models.html#using-gaussian-distributions."><i class="fa fa-check"></i><b>4.1.4</b> Using Gaussian distributions.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="linear-models.html"><a href="linear-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a><ul>
<li class="chapter" data-level="4.2.1" data-path="linear-models.html"><a href="linear-models.html#re-describing-the-globe-tossing-model."><i class="fa fa-check"></i><b>4.2.1</b> Re-describing the globe tossing model.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="linear-models.html"><a href="linear-models.html#a-gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> A Gaussian model of height</a><ul>
<li class="chapter" data-level="4.3.1" data-path="linear-models.html"><a href="linear-models.html#the-data."><i class="fa fa-check"></i><b>4.3.1</b> The data.</a></li>
<li class="chapter" data-level="4.3.2" data-path="linear-models.html"><a href="linear-models.html#the-model."><i class="fa fa-check"></i><b>4.3.2</b> The model.</a></li>
<li class="chapter" data-level="4.3.3" data-path="linear-models.html"><a href="linear-models.html#grid-approximation-of-the-posterior-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Grid approximation of the posterior distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="linear-models.html"><a href="linear-models.html#sampling-from-the-posterior."><i class="fa fa-check"></i><b>4.3.4</b> Sampling from the posterior.</a></li>
<li class="chapter" data-level="4.3.5" data-path="linear-models.html"><a href="linear-models.html#fitting-the-model-with-map-brm."><i class="fa fa-check"></i><b>4.3.5</b> Fitting the model with <del><code>map()</code></del> <code>brm()</code>.</a></li>
<li class="chapter" data-level="4.3.6" data-path="linear-models.html"><a href="linear-models.html#sampling-from-a-map-brm-fit."><i class="fa fa-check"></i><b>4.3.6</b> Sampling from a <del><code>map()</code></del> <code>brm()</code> fit.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="linear-models.html"><a href="linear-models.html#adding-a-predictor"><i class="fa fa-check"></i><b>4.4</b> Adding a predictor</a><ul>
<li class="chapter" data-level="4.4.1" data-path="linear-models.html"><a href="linear-models.html#the-linear-model-strategy"><i class="fa fa-check"></i><b>4.4.1</b> The linear model strategy</a></li>
<li class="chapter" data-level="4.4.2" data-path="linear-models.html"><a href="linear-models.html#fitting-the-model."><i class="fa fa-check"></i><b>4.4.2</b> Fitting the model.</a></li>
<li class="chapter" data-level="4.4.3" data-path="linear-models.html"><a href="linear-models.html#interpreting-the-model-fit."><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the model fit.</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="linear-models.html"><a href="linear-models.html#polynomial-regression"><i class="fa fa-check"></i><b>4.5</b> Polynomial regression</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html"><i class="fa fa-check"></i><b>5</b> Multivariate Linear Models</a><ul>
<li class="chapter" data-level="5.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#spurious-associations"><i class="fa fa-check"></i><b>5.1</b> Spurious associations</a><ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multivariate-notation."><i class="fa fa-check"></i><b>5.1.1</b> Multivariate notation.</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#fitting-the-model.-1"><i class="fa fa-check"></i><b>5.1.2</b> Fitting the model.</a></li>
<li class="chapter" data-level="5.1.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#plotting-multivariate-posteriors."><i class="fa fa-check"></i><b>5.1.3</b> Plotting multivariate posteriors.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#masked-relationship"><i class="fa fa-check"></i><b>5.2</b> Masked relationship</a></li>
<li class="chapter" data-level="5.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multicollinearity"><i class="fa fa-check"></i><b>5.3</b> Multicollinearity</a><ul>
<li class="chapter" data-level="5.3.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multicollinear-legs."><i class="fa fa-check"></i><b>5.3.1</b> Multicollinear legs.</a></li>
<li class="chapter" data-level="5.3.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multicollinear-milk."><i class="fa fa-check"></i><b>5.3.2</b> Multicollinear <code>milk</code>.</a></li>
<li class="chapter" data-level="5.3.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#post-treatment-bias."><i class="fa fa-check"></i><b>5.3.3</b> Post-treatment bias.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#categorical-varaibles"><i class="fa fa-check"></i><b>5.4</b> Categorical varaibles</a><ul>
<li class="chapter" data-level="5.4.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#binary-categories."><i class="fa fa-check"></i><b>5.4.1</b> Binary categories.</a></li>
<li class="chapter" data-level="5.4.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#many-categories."><i class="fa fa-check"></i><b>5.4.2</b> Many categories.</a></li>
<li class="chapter" data-level="5.4.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#adding-regular-predictor-variables."><i class="fa fa-check"></i><b>5.4.3</b> Adding regular predictor variables.</a></li>
<li class="chapter" data-level="5.4.4" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#another-approach-unique-intercepts."><i class="fa fa-check"></i><b>5.4.4</b> Another approach: Unique intercepts.</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#ordinary-least-squares-and-lm"><i class="fa fa-check"></i><b>5.5</b> <del>Ordinary least squares and <code>lm()</code></del></a></li>
<li class="chapter" data-level="" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html"><i class="fa fa-check"></i><b>6</b> Overfitting, Regularization, and Information Criteria</a><ul>
<li class="chapter" data-level="6.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>6.1</b> The problem with parameters</a><ul>
<li class="chapter" data-level="6.1.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#more-parameters-always-improve-fit."><i class="fa fa-check"></i><b>6.1.1</b> More parameters always improve fit.</a></li>
<li class="chapter" data-level="6.1.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#too-few-parameters-hurts-too."><i class="fa fa-check"></i><b>6.1.2</b> Too few parameters hurts, too.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#information-theory-and-model-performance"><i class="fa fa-check"></i><b>6.2</b> Information theory and model performance</a><ul>
<li class="chapter" data-level="6.2.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#firing-the-weatherperson."><i class="fa fa-check"></i><b>6.2.1</b> Firing the weatherperson.</a></li>
<li class="chapter" data-level="6.2.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#information-and-uncertainty."><i class="fa fa-check"></i><b>6.2.2</b> Information and uncertainty.</a></li>
<li class="chapter" data-level="6.2.3" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#from-entropy-to-accuracy."><i class="fa fa-check"></i><b>6.2.3</b> From entropy to accuracy.</a></li>
<li class="chapter" data-level="6.2.4" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#from-divergence-to-deviance."><i class="fa fa-check"></i><b>6.2.4</b> From divergence to deviance.</a></li>
<li class="chapter" data-level="6.2.5" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#from-deviance-to-out-of-sample."><i class="fa fa-check"></i><b>6.2.5</b> From deviance to out-of-sample.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#regularization"><i class="fa fa-check"></i><b>6.3</b> Regularization</a></li>
<li class="chapter" data-level="6.4" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#information-criteria"><i class="fa fa-check"></i><b>6.4</b> Information criteria</a><ul>
<li class="chapter" data-level="6.4.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#dic."><i class="fa fa-check"></i><b>6.4.1</b> DIC.</a></li>
<li class="chapter" data-level="6.4.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#waic."><i class="fa fa-check"></i><b>6.4.2</b> WAIC.</a></li>
<li class="chapter" data-level="6.4.3" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#dic-and-waic-as-estimates-of-deviance."><i class="fa fa-check"></i><b>6.4.3</b> DIC and WAIC as estimates of deviance.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#using-information-criteria"><i class="fa fa-check"></i><b>6.5</b> Using information criteria</a><ul>
<li class="chapter" data-level="6.5.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#model-comparison."><i class="fa fa-check"></i><b>6.5.1</b> Model comparison.</a></li>
<li class="chapter" data-level="6.5.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#model-averaging."><i class="fa fa-check"></i><b>6.5.2</b> Model averaging.</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#summary-bonus-r2-talk"><i class="fa fa-check"></i><b>6.6</b> <del>Summary</del> Bonus: <span class="math inline">\(R^2\)</span> talk</a></li>
<li class="chapter" data-level="" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#reference-5"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>7</b> Interactions</a><ul>
<li class="chapter" data-level="7.1" data-path="interactions.html"><a href="interactions.html#building-an-interaction."><i class="fa fa-check"></i><b>7.1</b> Building an interaction.</a><ul>
<li class="chapter" data-level="7.1.1" data-path="interactions.html"><a href="interactions.html#adding-a-dummy-variable-doesnt-work."><i class="fa fa-check"></i><b>7.1.1</b> Adding a dummy variable doesn’t work.</a></li>
<li class="chapter" data-level="7.1.2" data-path="interactions.html"><a href="interactions.html#adding-a-linear-interaction-does-work."><i class="fa fa-check"></i><b>7.1.2</b> Adding a linear interaction does work.</a></li>
<li class="chapter" data-level="7.1.3" data-path="interactions.html"><a href="interactions.html#plotting-the-interaction."><i class="fa fa-check"></i><b>7.1.3</b> Plotting the interaction.</a></li>
<li class="chapter" data-level="7.1.4" data-path="interactions.html"><a href="interactions.html#interpreting-an-interaction-estimate."><i class="fa fa-check"></i><b>7.1.4</b> Interpreting an interaction estimate.</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="interactions.html"><a href="interactions.html#symmetry-of-the-linear-interaction."><i class="fa fa-check"></i><b>7.2</b> Symmetry of the linear interaction.</a><ul>
<li class="chapter" data-level="7.2.1" data-path="interactions.html"><a href="interactions.html#buridans-interaction."><i class="fa fa-check"></i><b>7.2.1</b> Buridan’s interaction.</a></li>
<li class="chapter" data-level="7.2.2" data-path="interactions.html"><a href="interactions.html#africa-depends-upon-ruggedness."><i class="fa fa-check"></i><b>7.2.2</b> Africa depends upon ruggedness.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="interactions.html"><a href="interactions.html#continuous-interactions"><i class="fa fa-check"></i><b>7.3</b> Continuous interactions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="interactions.html"><a href="interactions.html#the-data.-1"><i class="fa fa-check"></i><b>7.3.1</b> The data.</a></li>
<li class="chapter" data-level="7.3.2" data-path="interactions.html"><a href="interactions.html#the-un-centered-models."><i class="fa fa-check"></i><b>7.3.2</b> The un-centered models.</a></li>
<li class="chapter" data-level="7.3.3" data-path="interactions.html"><a href="interactions.html#center-and-re-estimate."><i class="fa fa-check"></i><b>7.3.3</b> Center and re-estimate.</a></li>
<li class="chapter" data-level="7.3.4" data-path="interactions.html"><a href="interactions.html#plotting-implied-predictions."><i class="fa fa-check"></i><b>7.3.4</b> Plotting implied predictions.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="interactions.html"><a href="interactions.html#interactions-in-design-formulas"><i class="fa fa-check"></i><b>7.4</b> Interactions in design formulas</a></li>
<li class="chapter" data-level="7.5" data-path="interactions.html"><a href="interactions.html#summary-bonus-marginal_effects"><i class="fa fa-check"></i><b>7.5</b> <del>Summary</del> Bonus: <code>marginal_effects()</code></a></li>
<li class="chapter" data-level="" data-path="interactions.html"><a href="interactions.html#reference-6"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="interactions.html"><a href="interactions.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>8</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="8.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#good-king-markov-and-his-island-kingdom"><i class="fa fa-check"></i><b>8.1</b> Good King Markov and His island kingdom</a></li>
<li class="chapter" data-level="8.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#markov-chain-monte-carlo-1"><i class="fa fa-check"></i><b>8.2</b> Markov chain Monte Carlo</a></li>
<li class="chapter" data-level="8.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#easy-hmc-map2stan-brm"><i class="fa fa-check"></i><b>8.3</b> Easy HMC: <del>map2stan</del> <code>brm()</code></a><ul>
<li class="chapter" data-level="8.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#preparation."><i class="fa fa-check"></i><b>8.3.1</b> Preparation.</a></li>
<li class="chapter" data-level="8.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#estimation."><i class="fa fa-check"></i><b>8.3.2</b> Estimation.</a></li>
<li class="chapter" data-level="8.3.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#sampling-again-in-parallel."><i class="fa fa-check"></i><b>8.3.3</b> Sampling again, in parallel.</a></li>
<li class="chapter" data-level="8.3.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#visualization."><i class="fa fa-check"></i><b>8.3.4</b> Visualization.</a></li>
<li class="chapter" data-level="8.3.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#using-the-samples."><i class="fa fa-check"></i><b>8.3.5</b> Using the samples.</a></li>
<li class="chapter" data-level="8.3.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#checking-the-chain."><i class="fa fa-check"></i><b>8.3.6</b> Checking the chain.</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#care-and-feeding-of-your-markov-chain."><i class="fa fa-check"></i><b>8.4</b> Care and feeding of your Markov chain.</a><ul>
<li class="chapter" data-level="8.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>8.4.1</b> How many samples do you need?</a></li>
<li class="chapter" data-level="8.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-chains-do-you-need"><i class="fa fa-check"></i><b>8.4.2</b> How many chains do you need?</a></li>
<li class="chapter" data-level="8.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#taming-a-wild-chain."><i class="fa fa-check"></i><b>8.4.3</b> Taming a wild chain.</a></li>
<li class="chapter" data-level="8.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#non-identifiable-parameters."><i class="fa fa-check"></i><b>8.4.4</b> Non-identifiable parameters.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#reference-7"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>9</b> Big Entropy and the Generalized Linear Model</a><ul>
<li class="chapter" data-level="9.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>9.1</b> Maximum entropy</a><ul>
<li class="chapter" data-level="9.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#gaussian."><i class="fa fa-check"></i><b>9.1.1</b> Gaussian.</a></li>
<li class="chapter" data-level="9.1.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#binomial."><i class="fa fa-check"></i><b>9.1.2</b> Binomial.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>9.2</b> Generalized linear models</a><ul>
<li class="chapter" data-level="9.2.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#meet-the-family."><i class="fa fa-check"></i><b>9.2.1</b> Meet the family.</a></li>
<li class="chapter" data-level="9.2.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions."><i class="fa fa-check"></i><b>9.2.2</b> Linking linear models to distributions.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#reference-8"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="counting-and-classification.html"><a href="counting-and-classification.html"><i class="fa fa-check"></i><b>10</b> Counting and Classification</a><ul>
<li class="chapter" data-level="10.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#binomial-regression"><i class="fa fa-check"></i><b>10.1</b> Binomial regression</a><ul>
<li class="chapter" data-level="10.1.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#logistic-regression-prosocial-chimpanzees."><i class="fa fa-check"></i><b>10.1.1</b> Logistic regression: Prosocial chimpanzees.</a></li>
<li class="chapter" data-level="10.1.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#aggregated-binomial-chimpanzees-again-condensed."><i class="fa fa-check"></i><b>10.1.2</b> Aggregated binomial: Chimpanzees again, condensed.</a></li>
<li class="chapter" data-level="10.1.3" data-path="counting-and-classification.html"><a href="counting-and-classification.html#aggregated-binomial-graduate-school-admissions."><i class="fa fa-check"></i><b>10.1.3</b> Aggregated binomial: Graduate school admissions.</a></li>
<li class="chapter" data-level="10.1.4" data-path="counting-and-classification.html"><a href="counting-and-classification.html#fitting-binomial-regressions-with-glm."><i class="fa fa-check"></i><b>10.1.4</b> Fitting binomial regressions with <code>glm()</code>.</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#poisson-regression"><i class="fa fa-check"></i><b>10.2</b> Poisson regression</a><ul>
<li class="chapter" data-level="10.2.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#example-oceanic-tool-complexity."><i class="fa fa-check"></i><b>10.2.1</b> Example: Oceanic tool complexity.</a></li>
<li class="chapter" data-level="10.2.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#mcmc-islands."><i class="fa fa-check"></i><b>10.2.2</b> MCMC islands.</a></li>
<li class="chapter" data-level="10.2.3" data-path="counting-and-classification.html"><a href="counting-and-classification.html#example-exposure-and-the-offset."><i class="fa fa-check"></i><b>10.2.3</b> Example: Exposure and the offset.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="counting-and-classification.html"><a href="counting-and-classification.html#other-count-regressions"><i class="fa fa-check"></i><b>10.3</b> Other count regressions</a><ul>
<li class="chapter" data-level="10.3.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#multinomial."><i class="fa fa-check"></i><b>10.3.1</b> Multinomial.</a></li>
<li class="chapter" data-level="10.3.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#geometric."><i class="fa fa-check"></i><b>10.3.2</b> Geometric.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="counting-and-classification.html"><a href="counting-and-classification.html#reference-9"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="counting-and-classification.html"><a href="counting-and-classification.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html"><i class="fa fa-check"></i><b>11</b> Monsters and Mixtures</a><ul>
<li class="chapter" data-level="11.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i><b>11.1</b> Ordered categorical outcomes</a><ul>
<li class="chapter" data-level="11.1.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-moral-intuition."><i class="fa fa-check"></i><b>11.1.1</b> Example: Moral intuition.</a></li>
<li class="chapter" data-level="11.1.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#describing-an-ordered-distribution-with-intercepts."><i class="fa fa-check"></i><b>11.1.2</b> Describing an ordered distribution with intercepts.</a></li>
<li class="chapter" data-level="11.1.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#adding-predictor-variables."><i class="fa fa-check"></i><b>11.1.3</b> Adding predictor variables.</a></li>
<li class="chapter" data-level="11.1.4" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#bonus-figure-11.3-alternative."><i class="fa fa-check"></i><b>11.1.4</b> Bonus: Figure 11.3 alternative.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i><b>11.2</b> Zero-inflated outcomes</a><ul>
<li class="chapter" data-level="11.2.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-zero-inflated-poisson."><i class="fa fa-check"></i><b>11.2.1</b> Example: Zero-inflated Poisson.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersed-outcomes"><i class="fa fa-check"></i><b>11.3</b> Over-dispersed outcomes</a><ul>
<li class="chapter" data-level="11.3.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#beta-binomial."><i class="fa fa-check"></i><b>11.3.1</b> Beta-binomial.</a></li>
<li class="chapter" data-level="11.3.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#negative-binomial-or-gamma-poisson."><i class="fa fa-check"></i><b>11.3.2</b> Negative-binomial or gamma-Poisson.</a></li>
<li class="chapter" data-level="11.3.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersion-entropy-and-information-criteria."><i class="fa fa-check"></i><b>11.3.3</b> Over-dispersion, entropy, and information criteria.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#reference-10"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>12</b> Multilevel Models</a><ul>
<li class="chapter" data-level="12.1" data-path="multilevel-models.html"><a href="multilevel-models.html#example-multilevel-tadpoles"><i class="fa fa-check"></i><b>12.1</b> Example: Multilevel tadpoles</a></li>
<li class="chapter" data-level="12.2" data-path="multilevel-models.html"><a href="multilevel-models.html#varying-effects-and-the-underfittingoverfitting-trade-off"><i class="fa fa-check"></i><b>12.2</b> Varying effects and the underfitting/overfitting trade-off</a><ul>
<li class="chapter" data-level="12.2.1" data-path="multilevel-models.html"><a href="multilevel-models.html#the-model.-1"><i class="fa fa-check"></i><b>12.2.1</b> The model.</a></li>
<li class="chapter" data-level="12.2.2" data-path="multilevel-models.html"><a href="multilevel-models.html#assign-values-to-the-parameters."><i class="fa fa-check"></i><b>12.2.2</b> Assign values to the parameters.</a></li>
<li class="chapter" data-level="12.2.3" data-path="multilevel-models.html"><a href="multilevel-models.html#sumulate-survivors."><i class="fa fa-check"></i><b>12.2.3</b> Sumulate survivors.</a></li>
<li class="chapter" data-level="12.2.4" data-path="multilevel-models.html"><a href="multilevel-models.html#compute-the-no-pooling-estimates."><i class="fa fa-check"></i><b>12.2.4</b> Compute the no-pooling estimates.</a></li>
<li class="chapter" data-level="12.2.5" data-path="multilevel-models.html"><a href="multilevel-models.html#compute-the-partial-pooling-estimates."><i class="fa fa-check"></i><b>12.2.5</b> Compute the partial-pooling estimates.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="multilevel-models.html"><a href="multilevel-models.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>12.3</b> More than one type of cluster</a><ul>
<li class="chapter" data-level="12.3.1" data-path="multilevel-models.html"><a href="multilevel-models.html#multilevel-chimpanzees."><i class="fa fa-check"></i><b>12.3.1</b> Multilevel chimpanzees.</a></li>
<li class="chapter" data-level="12.3.2" data-path="multilevel-models.html"><a href="multilevel-models.html#two-types-of-cluster."><i class="fa fa-check"></i><b>12.3.2</b> Two types of cluster.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="multilevel-models.html"><a href="multilevel-models.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>12.4</b> Multilevel posterior predictions</a><ul>
<li class="chapter" data-level="12.4.1" data-path="multilevel-models.html"><a href="multilevel-models.html#posterior-prediction-for-same-clusters."><i class="fa fa-check"></i><b>12.4.1</b> Posterior prediction for same clusters.</a></li>
<li class="chapter" data-level="12.4.2" data-path="multilevel-models.html"><a href="multilevel-models.html#posterior-prediction-for-new-clusters."><i class="fa fa-check"></i><b>12.4.2</b> Posterior prediction for new clusters.</a></li>
<li class="chapter" data-level="12.4.3" data-path="multilevel-models.html"><a href="multilevel-models.html#focus-and-multilevel-prediction."><i class="fa fa-check"></i><b>12.4.3</b> Focus and multilevel prediction.</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="multilevel-models.html"><a href="multilevel-models.html#summary-bonus-tidybayesspread_draws"><i class="fa fa-check"></i><b>12.5</b> <del>Summary</del> Bonus: <code>tidybayes::spread_draws()</code></a><ul>
<li class="chapter" data-level="12.5.1" data-path="multilevel-models.html"><a href="multilevel-models.html#intercepts-only-models-with-one-or-two-grouping-variables"><i class="fa fa-check"></i><b>12.5.1</b> Intercepts-only models with one or two grouping variables</a></li>
<li class="chapter" data-level="12.5.2" data-path="multilevel-models.html"><a href="multilevel-models.html#brmsposterior_samples"><i class="fa fa-check"></i><b>12.5.2</b> <code>brms::posterior_samples()</code></a></li>
<li class="chapter" data-level="12.5.3" data-path="multilevel-models.html"><a href="multilevel-models.html#brmscoef"><i class="fa fa-check"></i><b>12.5.3</b> <code>brms::coef()</code></a></li>
<li class="chapter" data-level="12.5.4" data-path="multilevel-models.html"><a href="multilevel-models.html#brmsfitted"><i class="fa fa-check"></i><b>12.5.4</b> <code>brms::fitted()</code></a></li>
<li class="chapter" data-level="12.5.5" data-path="multilevel-models.html"><a href="multilevel-models.html#tidybayesspread_draws"><i class="fa fa-check"></i><b>12.5.5</b> <code>tidybayes::spread_draws()</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multilevel-models.html"><a href="multilevel-models.html#reference-11"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="multilevel-models.html"><a href="multilevel-models.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html"><i class="fa fa-check"></i><b>13</b> Adventures in Covariance</a><ul>
<li class="chapter" data-level="13.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>13.1</b> Varying slopes by construction</a><ul>
<li class="chapter" data-level="13.1.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-the-population."><i class="fa fa-check"></i><b>13.1.1</b> Simulate the population.</a></li>
<li class="chapter" data-level="13.1.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-observations."><i class="fa fa-check"></i><b>13.1.2</b> Simulate observations.</a></li>
<li class="chapter" data-level="13.1.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#the-varying-slopes-model."><i class="fa fa-check"></i><b>13.1.3</b> The varying slopes model.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-admission-decisions-and-gender"><i class="fa fa-check"></i><b>13.2</b> Example: Admission decisions and gender</a><ul>
<li class="chapter" data-level="13.2.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-intercepts."><i class="fa fa-check"></i><b>13.2.1</b> Varying intercepts.</a></li>
<li class="chapter" data-level="13.2.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-effects-of-being-male."><i class="fa fa-check"></i><b>13.2.2</b> Varying effects of being <code>male</code>.</a></li>
<li class="chapter" data-level="13.2.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#shrinkage."><i class="fa fa-check"></i><b>13.2.3</b> Shrinkage.</a></li>
<li class="chapter" data-level="13.2.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#model-comparison.-1"><i class="fa fa-check"></i><b>13.2.4</b> Model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-cross-classified-chimpanzees-with-varying-slopes"><i class="fa fa-check"></i><b>13.3</b> Example: Cross-classified <code>chimpanzees</code> with varying slopes</a></li>
<li class="chapter" data-level="13.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>13.4</b> Continuous categories and the Gaussian process</a><ul>
<li class="chapter" data-level="13.4.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools."><i class="fa fa-check"></i><b>13.4.1</b> Example: Spatial autocorrelation in Oceanic tools.</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#summary-bonus-another-berkley-admissions-data-like-example."><i class="fa fa-check"></i><b>13.5</b> <del>Summary</del> Bonus: Another Berkley-admissions-data-like example.</a></li>
<li class="chapter" data-level="" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#reference-12"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html"><i class="fa fa-check"></i><b>14</b> Missing Data and Other Opportunities</a><ul>
<li class="chapter" data-level="14.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#measurement-error"><i class="fa fa-check"></i><b>14.1</b> Measurement error</a><ul>
<li class="chapter" data-level="14.1.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#error-on-the-outcome."><i class="fa fa-check"></i><b>14.1.1</b> Error on the outcome.</a></li>
<li class="chapter" data-level="14.1.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#error-on-both-outcome-and-predictor."><i class="fa fa-check"></i><b>14.1.2</b> Error on both outcome and predictor.</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#missing-data"><i class="fa fa-check"></i><b>14.2</b> Missing data</a><ul>
<li class="chapter" data-level="14.2.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#imputing-neocortex"><i class="fa fa-check"></i><b>14.2.1</b> Imputing <code>neocortex</code></a></li>
<li class="chapter" data-level="14.2.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#improving-the-imputation-model"><i class="fa fa-check"></i><b>14.2.2</b> Improving the imputation model</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#summary-bonus-meta-analysis"><i class="fa fa-check"></i><b>14.3</b> <del>Summary</del> Bonus: Meta-analysis</a></li>
<li class="chapter" data-level="" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#reference-13"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html"><i class="fa fa-check"></i><b>15</b> <del>Horoscopes</del> Insights</a><ul>
<li class="chapter" data-level="15.1" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#use-r-notebooks"><i class="fa fa-check"></i><b>15.1</b> Use R Notebooks</a></li>
<li class="chapter" data-level="15.2" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#save-your-model-fits"><i class="fa fa-check"></i><b>15.2</b> Save your model fits</a></li>
<li class="chapter" data-level="15.3" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#build-your-models-slowly"><i class="fa fa-check"></i><b>15.3</b> Build your models slowly</a></li>
<li class="chapter" data-level="15.4" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#look-at-your-data"><i class="fa fa-check"></i><b>15.4</b> Look at your data</a></li>
<li class="chapter" data-level="15.5" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#use-the-0-intercept-syntax"><i class="fa fa-check"></i><b>15.5</b> Use the <code>0 + intercept</code> syntax</a></li>
<li class="chapter" data-level="15.6" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#annotate-your-workflow"><i class="fa fa-check"></i><b>15.6</b> Annotate your workflow</a></li>
<li class="chapter" data-level="15.7" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#annotate-your-code"><i class="fa fa-check"></i><b>15.7</b> Annotate your code</a></li>
<li class="chapter" data-level="15.8" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#break-up-your-workflow"><i class="fa fa-check"></i><b>15.8</b> Break up your workflow</a></li>
<li class="chapter" data-level="15.9" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#read-gelmans-blog"><i class="fa fa-check"></i><b>15.9</b> Read Gelman’s blog</a></li>
<li class="chapter" data-level="15.10" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#check-out-other-social-media-too"><i class="fa fa-check"></i><b>15.10</b> Check out other social media, too</a></li>
<li class="chapter" data-level="15.11" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#parting-wisdom"><i class="fa fa-check"></i><b>15.11</b> Parting wisdom</a></li>
<li class="chapter" data-level="" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#reference-14"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Statistical Rethinking</em> with brms, ggplot2, and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="small-worlds-and-large-worlds" class="section level1">
<h1><span class="header-section-number">2</span> Small Worlds and Large Worlds</h1>
<p>A while back The Oatmeal put together an <a href="http://theoatmeal.com/comics/columbus_day">infographic on Christopher Columbus</a>. I’m no historian and cannot vouch for its accuracy, so make of it what you will.</p>
<p>McElreath described the thrust of this chapter this way:</p>
<blockquote>
<p>In this chapter, you will begin to build Bayesian models. The way that Bayesian models learn from evidence is arguably optimal in the small world. When their assumptions approximate reality, they also perform well in the large world. But large world performance has to be demonstrated rather than logically deduced. (p. 20)</p>
</blockquote>
<p>Indeed.</p>
<div id="the-garden-of-forking-data" class="section level2">
<h2><span class="header-section-number">2.1</span> The garden of forking data</h2>
<p>Gelman and Loken wrote a <a href="http://www.stat.columbia.edu/~gelman/research/unpublished/p_hacking.pdf">great paper by this name</a>.</p>
<div id="counting-possibilities." class="section level3">
<h3><span class="header-section-number">2.1.1</span> Counting possibilities.</h3>
<p>Throughout this project, we’ll use the <a href="https://www.tidyverse.org">tidyverse</a> for data wrangling.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<p>If you are new to tidyverse-style syntax, possibly the oddest component is the pipe (i.e., <code>%&gt;%</code>). I’m not going to explain the <code>%&gt;%</code> in this project, but you might learn more about in <a href="https://www.youtube.com/watch?v=9yjhxvu-pDg">this brief clip</a>, starting around <a href="https://www.youtube.com/watch?v=K-ss_ag2k9E&amp;t=1285s">minute 21:25 in this talk by Wickham</a>, or in <a href="http://r4ds.had.co.nz/transform.html#combining-multiple-operations-with-the-pipe">section 5.6.1 from Grolemund and Wickham’s <em>R for Data Science</em></a>. Really, all of Chapter 5 of <em>R4DS</em> is just great for new R and new tidyverse users. And <em>R4DS</em> Chapter 3 is a nice introduction to plotting with ggplot2.</p>
<p>Other than the pipe, the other big thing to be aware of is <a href="https://tibble.tidyverse.org">tibbles</a>. For our purposes, think of a tibble as a data object with two dimensions defined by rows and columns. And importantly, tibbles are just special types of <a href="https://bookdown.org/rdpeng/rprogdatascience/r-nuts-and-bolts.html#data-framesbookdown::preview_chapter(%2206.Rmd%22)">data frames</a>. So whenever we talk about data frames, we’re also talking about tibbles. For more on the topic, check out <a href="http://r4ds.had.co.nz/tibbles.html"><em>R4SD</em>, Chapter 10</a>.</p>
<p>So, if we’re willing to code the marbles as 0 = “white” 1 = “blue”, we can arrange the possibility data in a tibble as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-
<span class="st">  </span><span class="kw">tibble</span>(<span class="dt">p_1 =</span> <span class="dv">0</span>,
         <span class="dt">p_2 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),
         <span class="dt">p_3 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)),
         <span class="dt">p_4 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)),
         <span class="dt">p_5 =</span> <span class="dv">1</span>)

<span class="kw">head</span>(d)</code></pre></div>
<pre><code>## # A tibble: 4 x 5
##     p_1   p_2   p_3   p_4   p_5
##   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
## 1     0     1     1     1     1
## 2     0     0     1     1     1
## 3     0     0     0     1     1
## 4     0     0     0     0     1</code></pre>
<p>You might depict the possibility data in a plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">times =</span> <span class="dv">5</span>),
         <span class="dt">possibility =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">each =</span> <span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> possibility, 
             <span class="dt">fill =</span> value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>())) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;navy&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(.<span class="dv">75</span>, <span class="fl">4.25</span>),
                  <span class="dt">ylim =</span> <span class="kw">c</span>(.<span class="dv">75</span>, <span class="fl">5.25</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-3-1.png" width="120" /></p>
<p>As a quick aside, check out Suzan Baert’s blog post <a href="https://suzan.rbind.io/2018/02/dplyr-tutorial-2/"><em>Data Wrangling Part 2: Transforming your columns into the right shape</em></a> for an extensive discussion on <code>dplyr::mutate()</code> and <code>dplyr::gather()</code>.</p>
<p>Here’s the basic structure of the possibilities per marble draw.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tibble</span>(<span class="dt">draw            =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,
       <span class="dt">marbles         =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">possibilities =</span> marbles <span class="op">^</span><span class="st"> </span>draw) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">draw</th>
<th align="right">marbles</th>
<th align="right">possibilities</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">64</td>
</tr>
</tbody>
</table>
<p>If you walk that out a little, you can structure the data required to approach Figure 2.2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(
  d &lt;-
<span class="st">  </span><span class="kw">tibble</span>(<span class="dt">position =</span> <span class="kw">c</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">0</span>, 
                      (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, 
                      (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>),
         <span class="dt">draw     =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)),
         <span class="dt">fill     =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;w&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">           </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)))
  )</code></pre></div>
<pre><code>## # A tibble: 84 x 3
##    position  draw fill 
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;
##  1     1        1 b    
##  2     2        1 w    
##  3     3        1 w    
##  4     4        1 w    
##  5     0.25     2 b    
##  6     0.5      2 w    
##  7     0.75     2 w    
##  8     1        2 w    
##  9     1.25     2 b    
## 10     1.5      2 w    
## # … with 74 more rows</code></pre>
<p>See what I did there with the parentheses? If you assign a value to an object in R (e.g., <code>dog &lt;- 1</code>) and just hit return, nothing will immediately pop up in the <a href="http://r4ds.had.co.nz/introduction.html#rstudio">console</a>. You have to actually execute <code>dog</code> before R will return <code>1</code>. But if you wrap the code within parentheses (e.g., <code>(dog &lt;- 1)</code>), R will perform the assignment and return the value as if you had executed <code>dog</code>.</p>
<p>But we digress. Here’s the initial plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill),
             <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values  =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position  =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="768" /></p>
<p>To my mind, the easiest way to connect the dots in the appropriate way is to make two auxiliary tibbles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># these will connect the dots from the first and second draws</span>
(
  lines_<span class="dv">1</span> &lt;-
<span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">rep</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>),
         <span class="dt">xend =</span> ((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>),
         <span class="dt">y    =</span> <span class="dv">1</span>,
         <span class="dt">yend =</span> <span class="dv">2</span>)
  )</code></pre></div>
<pre><code>## # A tibble: 16 x 4
##        x  xend     y  yend
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1  0.25     1     2
##  2     1  0.5      1     2
##  3     1  0.75     1     2
##  4     1  1        1     2
##  5     2  1.25     1     2
##  6     2  1.5      1     2
##  7     2  1.75     1     2
##  8     2  2        1     2
##  9     3  2.25     1     2
## 10     3  2.5      1     2
## 11     3  2.75     1     2
## 12     3  3        1     2
## 13     4  3.25     1     2
## 14     4  3.5      1     2
## 15     4  3.75     1     2
## 16     4  4        1     2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># these will connect the dots from the second and third draws</span>
(
  lines_<span class="dv">2</span> &lt;-
<span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">rep</span>(((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>),
         <span class="dt">xend =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">4</span><span class="op">^</span><span class="dv">2</span>),
         <span class="dt">y    =</span> <span class="dv">2</span>,
         <span class="dt">yend =</span> <span class="dv">3</span>)
  )</code></pre></div>
<pre><code>## # A tibble: 64 x 4
##        x   xend     y  yend
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  0.25 0.0625     2     3
##  2  0.25 0.125      2     3
##  3  0.25 0.188      2     3
##  4  0.25 0.25       2     3
##  5  0.5  0.312      2     3
##  6  0.5  0.375      2     3
##  7  0.5  0.438      2     3
##  8  0.5  0.5        2     3
##  9  0.75 0.562      2     3
## 10  0.75 0.625      2     3
## # … with 54 more rows</code></pre>
<p>We can use the <code>lines_1</code> and <code>lines_2</code> data in the plot with two <code>geom_segment()</code> functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data  =</span> lines_<span class="dv">1</span>,
               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,
                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),
               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data  =</span> lines_<span class="dv">2</span>,
               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,
                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),
               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill),
             <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values  =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position  =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-1.png" width="768" /></p>
<p>We’ve generated the values for <code>position</code> (i.e., the x-axis), in such a way that they’re all justified to the right, so to speak. But we’d like to center them. For <code>draw == 1</code>, we’ll need to subtract 0.5 from each. For <code>draw == 2</code>, we need to reduce the scale by a factor of 4 and we’ll then need to reduce the scale by another factor of 4 for <code>draw == 3</code>. The <code>ifelse()</code> function will be of use for that.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-
<span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">denominator =</span> <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, .<span class="dv">5</span>,
                              <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, .<span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>,
                                     .<span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">position    =</span> position <span class="op">-</span><span class="st"> </span>denominator)

d</code></pre></div>
<pre><code>## # A tibble: 84 x 4
##    position  draw fill  denominator
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1    0.5       1 b           0.5  
##  2    1.5       1 w           0.5  
##  3    2.5       1 w           0.5  
##  4    3.5       1 w           0.5  
##  5    0.125     2 b           0.125
##  6    0.375     2 w           0.125
##  7    0.625     2 w           0.125
##  8    0.875     2 w           0.125
##  9    1.12      2 b           0.125
## 10    1.38      2 w           0.125
## # … with 74 more rows</code></pre>
<p>We’ll follow the same logic for the <code>lines_1</code> and <code>lines_2</code> data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(
  lines_<span class="dv">1</span> &lt;-
<span class="st">  </span>lines_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> x <span class="op">-</span><span class="st"> </span>.<span class="dv">5</span>,
         <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span>.<span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>)
)</code></pre></div>
<pre><code>## # A tibble: 16 x 4
##        x  xend     y  yend
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1   0.5 0.125     1     2
##  2   0.5 0.375     1     2
##  3   0.5 0.625     1     2
##  4   0.5 0.875     1     2
##  5   1.5 1.12      1     2
##  6   1.5 1.38      1     2
##  7   1.5 1.62      1     2
##  8   1.5 1.88      1     2
##  9   2.5 2.12      1     2
## 10   2.5 2.38      1     2
## 11   2.5 2.62      1     2
## 12   2.5 2.88      1     2
## 13   3.5 3.12      1     2
## 14   3.5 3.38      1     2
## 15   3.5 3.62      1     2
## 16   3.5 3.88      1     2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(
  lines_<span class="dv">2</span> &lt;-
<span class="st">  </span>lines_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> x <span class="op">-</span><span class="st"> </span>.<span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>,
         <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span>.<span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)
)</code></pre></div>
<pre><code>## # A tibble: 64 x 4
##        x   xend     y  yend
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 0.125 0.0312     2     3
##  2 0.125 0.0938     2     3
##  3 0.125 0.156      2     3
##  4 0.125 0.219      2     3
##  5 0.375 0.281      2     3
##  6 0.375 0.344      2     3
##  7 0.375 0.406      2     3
##  8 0.375 0.469      2     3
##  9 0.625 0.531      2     3
## 10 0.625 0.594      2     3
## # … with 54 more rows</code></pre>
<p>Now the plot’s looking closer.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data  =</span> lines_<span class="dv">1</span>,
               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,
                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),
               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data  =</span> lines_<span class="dv">2</span>,
               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,
                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),
               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill),
             <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values  =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position  =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="768" /></p>
<p>For the final step, we’ll use <code>coord_polar()</code> to change the <a href="http://sape.inf.usi.ch/quick-reference/ggplot2/coord">coordinate system</a>, giving the plot a mandala-like feel.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data  =</span> lines_<span class="dv">1</span>,
               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,
                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),
               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data  =</span> lines_<span class="dv">2</span>,
               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,
                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),
               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill),
             <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values  =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="dv">3</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid      =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_polar</span>()</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="384" /></p>
<p>To make our version of Figure 2.3, we’ll have to add an index to tell us which paths remain logically valid after each choice. We’ll call the index <code>remain</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lines_<span class="dv">1</span> &lt;-
<span class="st">  </span>lines_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)))

lines_<span class="dv">2</span> &lt;-
<span class="st">  </span>lines_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>),
                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">12</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>)))

d &lt;-
<span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),
                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>),
                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">12</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>))) 

<span class="co"># finally, the plot:</span>
d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data  =</span> lines_<span class="dv">1</span>,
               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,
                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend,
                   <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),
               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data  =</span> lines_<span class="dv">2</span>,
               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,
                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend,
                   <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),
               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill, <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),
             <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span>
<span class="st">  </span><span class="co"># it&#39;s the alpha parameter that makes elements semitransparent</span>
<span class="st">  </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">10</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values  =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="dv">3</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid      =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_polar</span>()</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-13-1.png" width="384" /></p>
<p>Letting “w” = a white dot and “b” = a blue dot, we might recreate the table in the middle of page 23 like so.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># If we make two custom functions, here, it will simplify the code within `mutate()`, below</span>
n_blue &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  <span class="kw">rowSums</span>(x <span class="op">==</span><span class="st"> &quot;b&quot;</span>)
}

n_white &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  <span class="kw">rowSums</span>(x <span class="op">==</span><span class="st"> &quot;w&quot;</span>)
}

t &lt;-
<span class="st">  </span><span class="co"># for the first four columns, `p_` indexes position</span>
<span class="st">  </span><span class="kw">tibble</span>(<span class="dt">p_1 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)),
         <span class="dt">p_2 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)),
         <span class="dt">p_3 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)),
         <span class="dt">p_4 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">draw 1: blue</span><span class="st">`</span>  =<span class="st"> </span><span class="kw">n_blue</span>(.),
         <span class="st">`</span><span class="dt">draw 2: white</span><span class="st">`</span> =<span class="st"> </span><span class="kw">n_white</span>(.),
         <span class="st">`</span><span class="dt">draw 3: blue</span><span class="st">`</span>  =<span class="st"> </span><span class="kw">n_blue</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">ways to produce</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">draw 1: blue</span><span class="st">`</span> <span class="op">*</span><span class="st"> `</span><span class="dt">draw 2: white</span><span class="st">`</span> <span class="op">*</span><span class="st"> `</span><span class="dt">draw 3: blue</span><span class="st">`</span>)

t <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">p_1</th>
<th align="left">p_2</th>
<th align="left">p_3</th>
<th align="left">p_4</th>
<th align="right">draw 1: blue</th>
<th align="right">draw 2: white</th>
<th align="right">draw 3: blue</th>
<th align="right">ways to produce</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>We’ll need new data for Figure 2.4. Here’s the initial primary data, <code>d</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-
<span class="st">  </span><span class="kw">tibble</span>(<span class="dt">position =</span> <span class="kw">c</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">0</span>, 
                      (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, 
                      (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>),
         <span class="dt">draw     =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)))

(
  d &lt;-
<span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">bind_rows</span>(
    d, d
  ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># here are the fill colors</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)),
                  <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">each  =</span> <span class="dv">2</span>)       <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)),
                  <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># now we need to shift the positions over in accordance with draw, like before</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">denominator =</span> <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, .<span class="dv">5</span>,
                              <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, .<span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>,
                                     .<span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">position =</span> position <span class="op">-</span><span class="st"> </span>denominator) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pie_index =</span> <span class="kw">rep</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">each =</span> <span class="kw">n</span>()<span class="op">/</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># to get the position axis correct for pie_index == &quot;b&quot; or &quot;c&quot;, we&#39;ll need to offset</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">position =</span> <span class="kw">ifelse</span>(pie_index <span class="op">==</span><span class="st"> &quot;a&quot;</span>, position,
                           <span class="kw">ifelse</span>(pie_index <span class="op">==</span><span class="st"> &quot;b&quot;</span>, position <span class="op">+</span><span class="st"> </span><span class="dv">4</span>,
                                  position <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)))
  )</code></pre></div>
<pre><code>## # A tibble: 252 x 5
##    position  draw fill  denominator pie_index
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    
##  1    0.5       1 w           0.5   a        
##  2    1.5       1 b           0.5   a        
##  3    2.5       1 b           0.5   a        
##  4    3.5       1 b           0.5   a        
##  5    0.125     2 w           0.125 a        
##  6    0.375     2 b           0.125 a        
##  7    0.625     2 b           0.125 a        
##  8    0.875     2 b           0.125 a        
##  9    1.12      2 w           0.125 a        
## 10    1.38      2 b           0.125 a        
## # … with 242 more rows</code></pre>
<p>Both <code>lines_1</code> and <code>lines_2</code> require adjustments for <code>x</code> and <code>xend</code>. Our current approach is a nested <code>ifelse()</code>. Rather than copy and paste that multi-line <code>ifelse()</code> code for all four, let’s wrap it in a compact function, which we’ll call <code>move_over()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">move_over &lt;-<span class="st"> </span><span class="cf">function</span>(position, index){
  <span class="kw">ifelse</span>(index <span class="op">==</span><span class="st"> &quot;a&quot;</span>, position,
         <span class="kw">ifelse</span>(index <span class="op">==</span><span class="st"> &quot;b&quot;</span>, position <span class="op">+</span><span class="st"> </span><span class="dv">4</span>,
                position <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)
         )
  }</code></pre></div>
<p>If you’re new to making your own R functions, check out <a href="http://r4ds.had.co.nz/functions.html">Chapter 19</a> of <em>R4DS</em> or <a href="https://bookdown.org/rdpeng/rprogdatascience/functions.html">Chapter 14</a> of <em>R Programming for Data Science</em>.</p>
<p>Anyway, now we’ll make our new <code>lines_1</code> and <code>lines_2</code> data, for which we’ll use <code>move_over()</code> to adjust their <code>x</code> and <code>xend</code> positions to the correct spots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(
  lines_<span class="dv">1</span> &lt;-
<span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">rep</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
         <span class="dt">xend =</span> ((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)        <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
         <span class="dt">y    =</span> <span class="dv">1</span>,
         <span class="dt">yend =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> x <span class="op">-</span><span class="st"> </span>.<span class="dv">5</span>,
         <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span>.<span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pie_index =</span> <span class="kw">rep</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">each =</span> <span class="kw">n</span>()<span class="op">/</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># to get the position axis correct for pie_index == &quot;b&quot; or &quot;c&quot;, we&#39;ll need to offset</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> x,    <span class="dt">index =</span> pie_index),
         <span class="dt">xend =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> xend, <span class="dt">index =</span> pie_index))
  )</code></pre></div>
<pre><code>## # A tibble: 48 x 5
##        x  xend     y  yend pie_index
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    
##  1   0.5 0.125     1     2 a        
##  2   0.5 0.375     1     2 a        
##  3   0.5 0.625     1     2 a        
##  4   0.5 0.875     1     2 a        
##  5   1.5 1.12      1     2 a        
##  6   1.5 1.38      1     2 a        
##  7   1.5 1.62      1     2 a        
##  8   1.5 1.88      1     2 a        
##  9   2.5 2.12      1     2 a        
## 10   2.5 2.38      1     2 a        
## # … with 38 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(
  lines_<span class="dv">2</span> &lt;-
<span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">rep</span>(((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>)  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
         <span class="dt">xend =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)                 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
         <span class="dt">y    =</span> <span class="dv">2</span>,
         <span class="dt">yend =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> x <span class="op">-</span><span class="st"> </span>.<span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>,
         <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span>.<span class="dv">5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pie_index =</span> <span class="kw">rep</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">each =</span> <span class="kw">n</span>()<span class="op">/</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># to get the position axis correct for pie_index == &quot;b&quot; or &quot;c&quot;, we&#39;ll need to offset</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> x,    <span class="dt">index =</span> pie_index),
         <span class="dt">xend =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> xend, <span class="dt">index =</span> pie_index))
  )</code></pre></div>
<pre><code>## # A tibble: 192 x 5
##        x   xend     y  yend pie_index
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    
##  1 0.125 0.0312     2     3 a        
##  2 0.125 0.0938     2     3 a        
##  3 0.125 0.156      2     3 a        
##  4 0.125 0.219      2     3 a        
##  5 0.375 0.281      2     3 a        
##  6 0.375 0.344      2     3 a        
##  7 0.375 0.406      2     3 a        
##  8 0.375 0.469      2     3 a        
##  9 0.625 0.531      2     3 a        
## 10 0.625 0.594      2     3 a        
## # … with 182 more rows</code></pre>
<p>For the last data wrangling step, we add the <code>remain</code> indices to help us determine which parts to make semitransparent. I’m not sure of a slick way to do this, so these are the result of brute force counting.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span>
<span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="co">#pie_index == &quot;a&quot;</span>
                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>),
                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>),
                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
                    <span class="co"># pie_index == &quot;b&quot;</span>
                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">each =</span> <span class="dv">2</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>),
                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">each =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>),
                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),
                    <span class="co"># pie_index == &quot;c&quot;,</span>
                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),
                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)), 
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>)
                    )
         )

lines_<span class="dv">1</span> &lt;-
<span class="st">  </span>lines_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>),
                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>),
                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">each  =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),
                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))
                    )
         )

lines_<span class="dv">2</span> &lt;-
<span class="st">  </span>lines_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>),
                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">8</span>),
                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                      </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>)
                    )
         )</code></pre></div>
<p>We’re finally ready to plot our Figure 2.4.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">8</span>), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data  =</span> lines_<span class="dv">1</span>,
               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,
                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend,
                   <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),
               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data  =</span> lines_<span class="dv">2</span>,
               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,
                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend,
                   <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),
               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill, <span class="dt">size =</span> draw, <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),
             <span class="dt">shape =</span> <span class="dv">21</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="fl">1.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">10</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values  =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">12</span>),     <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="fl">3.5</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid      =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_polar</span>()</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="using-prior-information." class="section level3">
<h3><span class="header-section-number">2.1.2</span> Using prior information.</h3>
<blockquote>
<p>We may have prior information about the relative plausibility of each conjecture. This prior information could arise from knowledge of how the contents of the bag were generated. It could also arise from previous data. Or we might want to act as if we had prior information, so we can build conservatism into the analysis. Whatever the source, it would help to have a way to use prior information. Luckily there is a natural solution: Just multiply the prior count by the new count. (p. 25)</p>
</blockquote>
<p>Here’s the table in the middle of page 25.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t &lt;-
<span class="st">  </span>t <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="st">`</span><span class="dt">previous counts</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">ways to produce</span><span class="st">`</span>,
         <span class="st">`</span><span class="dt">ways to produce</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">draw 1: blue</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(p_<span class="dv">1</span><span class="op">:</span>p_<span class="dv">4</span>, <span class="st">`</span><span class="dt">ways to produce</span><span class="st">`</span>, <span class="st">`</span><span class="dt">previous counts</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">new count</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">ways to produce</span><span class="st">`</span> <span class="op">*</span><span class="st"> `</span><span class="dt">previous counts</span><span class="st">`</span>)

t <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">p_1</th>
<th align="left">p_2</th>
<th align="left">p_3</th>
<th align="left">p_4</th>
<th align="right">ways to produce</th>
<th align="right">previous counts</th>
<th align="right">new count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="right">3</td>
<td align="right">9</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>We might update to reproduce the table a the top of page 26, like this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t &lt;-
<span class="st">  </span>t <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(p_<span class="dv">1</span><span class="op">:</span>p_<span class="dv">4</span>, <span class="st">`</span><span class="dt">new count</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">rename</span>(<span class="st">`</span><span class="dt">prior count</span><span class="st">`</span>   =<span class="st"> `</span><span class="dt">new count</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">factory count</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">new count</span><span class="st">`</span>     =<span class="st"> `</span><span class="dt">prior count</span><span class="st">`</span> <span class="op">*</span><span class="st"> `</span><span class="dt">factory count</span><span class="st">`</span>)

t <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">p_1</th>
<th align="left">p_2</th>
<th align="left">p_3</th>
<th align="left">p_4</th>
<th align="right">prior count</th>
<th align="right">factory count</th>
<th align="right">new count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">16</td>
<td align="right">2</td>
<td align="right">32</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="right">27</td>
<td align="right">1</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>To learn more about <code>dplyr::select()</code> and <code>dplyr::rename()</code>, check out Baert’s exhaustive blog post <a href="https://suzan.rbind.io/2018/01/dplyr-tutorial-1/"><em>Data Wrangling Part 1: Basic to Advanced Ways to Select Columns</em></a>.</p>
</div>
<div id="from-counts-to-probability." class="section level3">
<h3><span class="header-section-number">2.1.3</span> From counts to probability.</h3>
<p>The opening sentences in this subsection are important: “It is helpful to think of this strategy as adhering to a principle of honest ignorance: <em>When we don’t know what caused the data, potential causes that may produce the data in more ways are more plausible</em>” (p. 26, <em>emphasis</em> in the original).</p>
<p>We can define our updated plausibility as:</p>
<center>
<p>plausibility of <img src="Pictures/theta_02.png" /> after seeing <img src="Pictures/data_02.png" /></p>
<p><span class="math inline">\(\propto\)</span></p>
<p>ways <img src="Pictures/theta_02.png" /> can produce <img src="Pictures/data_02.png" /></p>
<p><span class="math inline">\(\times\)</span></p>
<p>prior plausibility of <img src="Pictures/theta_02.png" /></p>
</center>
<p>In other words:</p>
<center>
<p>plausibility of <span class="math inline">\(p\)</span> after <span class="math inline">\(D_{\text{new}}\)</span> <span class="math inline">\(\propto\)</span> ways <span class="math inline">\(p\)</span> can produce <span class="math inline">\(D_{\text{new}} \times\)</span> prior plausibility of <span class="math inline">\(p\)</span></p>
</center>
<p>But since we have to standardize the results to get them into a probability metric, the full equation is:</p>
<p><span class="math display">\[\text{plausibility of } p \text{ after } D_{\text{new}} = \frac{\text{ ways } p \text{ can produce } D_{\text{new}} \times \text{ prior plausibility of } p}{\text{sum of the products}}\]</span></p>
<p>You might make the table in the middle of page 27 like this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(p_<span class="dv">1</span><span class="op">:</span>p_<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p                      =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> .<span class="dv">25</span>),
         <span class="st">`</span><span class="dt">ways to produce data</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">plausibility           =</span> <span class="st">`</span><span class="dt">ways to produce data</span><span class="st">`</span> <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(<span class="st">`</span><span class="dt">ways to produce data</span><span class="st">`</span>))</code></pre></div>
<pre><code>## # A tibble: 5 x 7
##   p_1   p_2   p_3   p_4       p `ways to produce data` plausibility
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;                  &lt;dbl&gt;        &lt;dbl&gt;
## 1 w     w     w     w      0                         0         0   
## 2 b     w     w     w      0.25                      3         0.15
## 3 b     b     w     w      0.5                       8         0.4 
## 4 b     b     b     w      0.75                      9         0.45
## 5 b     b     b     b      1                         0         0</code></pre>
<p>We just computed the plausibilities, but here’s McElreath’s R code 2.1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ways &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">0</span>)

ways <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(ways)</code></pre></div>
<pre><code>## [1] 0.00 0.15 0.40 0.45 0.00</code></pre>
</div>
</div>
<div id="building-a-model" class="section level2">
<h2><span class="header-section-number">2.2</span> Building a model</h2>
<p>We might save our globe-tossing data in a tibble.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">toss =</span> <span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>)))</code></pre></div>
<pre><code>## # A tibble: 9 x 1
##   toss 
##   &lt;chr&gt;
## 1 w    
## 2 l    
## 3 w    
## 4 w    
## 5 w    
## 6 l    
## 7 w    
## 8 l    
## 9 w</code></pre>
<div id="a-data-story." class="section level3">
<h3><span class="header-section-number">2.2.1</span> A data story.</h3>
<blockquote>
<p>Bayesian data analysis usually means producing a story for how the data came to be. This story may be <em>descriptive</em>, specifying associations that can be used to predict outcomes, given observations. Or it may be <em>causal</em>, a theory of how come events produce other events. Typically, any story you intend to be causal may also be descriptive. But many descriptive stories are hard to interpret causally. But all data stories are complete, in the sense that they are sufficient for specifying an algorithm for simulating new data. (p. 28, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="bayesian-updating." class="section level3">
<h3><span class="header-section-number">2.2.2</span> Bayesian updating.</h3>
<p>Here we’ll add the cumulative number of trials, <code>n_trials</code>, and the cumulative number of successes, <code>n_successes</code> (i.e., <code>toss == &quot;w&quot;</code>), to the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(
  d &lt;-
<span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_trials  =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>,
         <span class="dt">n_success =</span> <span class="kw">cumsum</span>(toss <span class="op">==</span><span class="st"> &quot;w&quot;</span>))
  )</code></pre></div>
<pre><code>## # A tibble: 9 x 3
##   toss  n_trials n_success
##   &lt;chr&gt;    &lt;int&gt;     &lt;int&gt;
## 1 w            1         1
## 2 l            2         1
## 3 w            3         2
## 4 w            4         3
## 5 w            5         4
## 6 l            6         4
## 7 w            7         5
## 8 l            8         5
## 9 w            9         6</code></pre>
<p>Fair warning: We don’t learn the skills for making Figure 2.5 until later in the chapter. So consider the data wrangling steps in this section as something of a preview.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sequence_length &lt;-<span class="st"> </span><span class="dv">50</span>

d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(n_trials, toss, n_success), 
         <span class="dt">p_water =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> sequence_length)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(p_water) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="co"># you can learn more about lagging here: https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/lag or here: https://dplyr.tidyverse.org/reference/lead-lag.html</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lagged_n_trials  =</span> <span class="kw">lag</span>(n_trials,  <span class="dt">k =</span> <span class="dv">1</span>),
         <span class="dt">lagged_n_success =</span> <span class="kw">lag</span>(n_success, <span class="dt">k =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior      =</span> <span class="kw">ifelse</span>(n_trials <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, .<span class="dv">5</span>,
                             <span class="kw">dbinom</span>(<span class="dt">x    =</span> lagged_n_success, 
                                    <span class="dt">size =</span> lagged_n_trials, 
                                    <span class="dt">prob =</span> p_water)),
         <span class="dt">likelihood =</span> <span class="kw">dbinom</span>(<span class="dt">x    =</span> n_success, 
                             <span class="dt">size =</span> n_trials, 
                             <span class="dt">prob =</span> p_water),
         <span class="dt">strip      =</span> <span class="kw">str_c</span>(<span class="st">&quot;n = &quot;</span>, n_trials)
         ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="co"># the next three lines allow us to normalize the prior and the likelihood, </span>
<span class="st">  </span><span class="co"># putting them both in a probability metric </span>
<span class="st">  </span><span class="kw">group_by</span>(n_trials) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior      =</span> prior      <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(prior),
         <span class="dt">likelihood =</span> likelihood <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood)) <span class="op">%&gt;%</span><span class="st">   </span>
<span class="st">  </span>
<span class="st">  </span><span class="co"># plot!</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_water)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> prior), <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> likelihood)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;proportion water&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;plausibility&quot;</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>strip, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="576" /></p>
<p>If it wasn’t clear in the code, the dashed curves are normalized prior densities. The solid ones are normalized likelihoods. If you don’t normalize (i.e., divide the density by the sum of the density), their respective heights don’t match up with those in the text. Furthermore, it’s the normalization that makes them directly comparable.</p>
<p>To learn more about <code>dplyr::group_by()</code> and its opposite <code>dplyr::ungroup()</code>, check out <a href="http://r4ds.had.co.nz/transform.html"><em>R4DS</em>, Chapter 5</a>. To learn about <code>tidyr::expand()</code>, go <a href="https://tidyr.tidyverse.org/reference/expand.html">here</a>.</p>
</div>
<div id="evaluate." class="section level3">
<h3><span class="header-section-number">2.2.3</span> Evaluate.</h3>
<p>It’s worth repeating the <strong>Rethinking: Deflationary statistics</strong> box, here.</p>
<blockquote>
<p>It may be that Bayesian inference is the best general purpose method of inference known. However, Bayesian inference is much less powerful than we’d like it to be. There is no approach to inference that provides universal guarantees. No branch of applied mathematics has unfettered access to reality, because math is not discovered, like the proton. Instead it is invented, like the shovel. (p. 32)</p>
</blockquote>
</div>
</div>
<div id="components-of-the-model" class="section level2">
<h2><span class="header-section-number">2.3</span> Components of the model</h2>
<ol style="list-style-type: decimal">
<li>a likelihood function: “the number of ways each conjecture could produce an observation”</li>
<li>one or more parameters: “the accumulated number of ways each conjecture cold produce the entire data”</li>
<li>a prior: “the initial plausibility of each conjectured cause of the data”</li>
</ol>
<div id="likelihood." class="section level3">
<h3><span class="header-section-number">2.3.1</span> Likelihood.</h3>
<p>If you let the count of water be <span class="math inline">\(w\)</span> and the number of tosses be <span class="math inline">\(n\)</span>, then the binomial likelihood may be expressed as:</p>
<p><span class="math display">\[\text{Pr} (w|n, p) = \frac{n!}{w!(n - w)!} p^w (1 - p)^{n - w}\]</span></p>
<p>Given a probability of .5, the binomial likelihood of 6 out of 9 tosses coming out water is:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dbinom</span>(<span class="dt">x =</span> <span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> .<span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] 0.1640625</code></pre>
<p>McElreath suggested we change the values of <code>prob</code>. Let’s do so over the parameter space.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tibble</span>(<span class="dt">prob =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> .<span class="dv">01</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> prob,
             <span class="dt">y =</span> <span class="kw">dbinom</span>(<span class="dt">x =</span> <span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> prob))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;probability&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;binomial likelihood&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="288" /></p>
</div>
<div id="parameters." class="section level3">
<h3><span class="header-section-number">2.3.2</span> Parameters.</h3>
<p>McElreath started off his <strong>Rethinking: Datum or parameter?</strong> box with:</p>
<blockquote>
<p>It is typical to conceive of data and parameters as completely different kinds of entities. Data are measures and known; parameters are unknown and must be estimated from data. Usefully, in the Bayesian framework the distinction between a datum and a parameter is fuzzy. (p. 34)</p>
</blockquote>
<p>For more in this topic, check out his lecture <a href="https://www.youtube.com/watch?v=yakg94HyWdE&amp;frags=pl%2Cwn"><em>Understanding Bayesian Statistics without Frequentist Language</em></a>.</p>
</div>
<div id="prior." class="section level3">
<h3><span class="header-section-number">2.3.3</span> Prior.</h3>
<blockquote>
<p>So where do priors come from? They are engineering assumptions, chosen to help the machine learn. The flat prior in Figure 2.5 is very common, but it is hardly ever the best prior. You’ll see later in the book that priors that gently nudge the machine usually improve inference. Such priors are sometimes called regularizing or weakly informative priors. (p. 35)</p>
</blockquote>
<p>To learn more about “regularizing or weakly informative priors,” check out the <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations"><em>Prior Choice Recommendations</em> wiki from the Stan team</a>.</p>
<div id="overthinking-prior-as-a-probability-distribution" class="section level4">
<h4><span class="header-section-number">2.3.3.1</span> Overthinking: Prior as a probability distribution</h4>
<p>McElreath said that “for a uniform prior from <span class="math inline">\(a\)</span> to <span class="math inline">\(b\)</span>, the probability of any point in the interval is <span class="math inline">\(1 / (b - a)\)</span>” (p. 35). Let’s try that out. To keep things simple, we’ll hold <span class="math inline">\(a\)</span> constant while varying the values for <span class="math inline">\(b\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tibble</span>(<span class="dt">a =</span> <span class="dv">0</span>,
       <span class="dt">b =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prob =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(b <span class="op">-</span><span class="st"> </span>a))</code></pre></div>
<pre><code>## # A tibble: 5 x 3
##       a     b  prob
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0   1   1    
## 2     0   1.5 0.667
## 3     0   2   0.5  
## 4     0   3   0.333
## 5     0   9   0.111</code></pre>
<p>I like to verify things with plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tibble</span>(<span class="dt">a =</span> <span class="dv">0</span>,
       <span class="dt">b =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(a, b), <span class="dt">parameter_space =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">9</span>, <span class="dt">length.out =</span> <span class="dv">500</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prob =</span> <span class="kw">dunif</span>(parameter_space, a, b),
         <span class="dt">b =</span> <span class="kw">str_c</span>(<span class="st">&quot;b = &quot;</span>, b)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> parameter_space, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prob)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">9</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">9</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span>),
                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1/9&quot;</span>, <span class="st">&quot;1/3&quot;</span>, <span class="st">&quot;1/2&quot;</span>, <span class="st">&quot;2/3&quot;</span>, <span class="st">&quot;1&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor   =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>b, <span class="dt">ncol =</span> <span class="dv">5</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-30-1.png" width="768" /></p>
<p>And as we’ll learn much later in the project, the <span class="math inline">\(\text{Uniform} (0, 1)\)</span> distribution is special in that we can also express it as the beta distribution for which <span class="math inline">\(\alpha = 1 \text{ and } \beta = 1\)</span>. E.g.,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tibble</span>(<span class="dt">parameter_space =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">50</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prob =</span> <span class="kw">dbeta</span>(parameter_space, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> parameter_space, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prob)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="240" /></p>
</div>
</div>
<div id="posterior." class="section level3">
<h3><span class="header-section-number">2.3.4</span> Posterior.</h3>
<p>If we continue to focus on the globe tossing example, the posterior probability a toss will be water may be expressed as:</p>
<p><span class="math display">\[\text{Pr} (p|w) = \frac{\text{Pr} (w|p) \text{Pr} (p)}{\text{Pr} (w)}\]</span></p>
<p>More generically and in words, this is:</p>
<p><span class="math display">\[\text{Posterior} = \frac{\text{Likelihood} \times \text{Prior}}{\text{Average Likelihood}}\]</span></p>
</div>
</div>
<div id="making-the-model-go" class="section level2">
<h2><span class="header-section-number">2.4</span> Making the model go</h2>
<p>Here’s the data wrangling for Figure 2.6.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sequence_length &lt;-<span class="st"> </span><span class="fl">1e3</span>

d &lt;-
<span class="st">  </span><span class="kw">tibble</span>(<span class="dt">probability =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> sequence_length)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">expand</span>(probability, <span class="dt">row =</span> <span class="kw">c</span>(<span class="st">&quot;flat&quot;</span>, <span class="st">&quot;stepped&quot;</span>, <span class="st">&quot;Laplace&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">arrange</span>(row, probability) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior =</span> <span class="kw">ifelse</span>(row <span class="op">==</span><span class="st"> &quot;flat&quot;</span>, <span class="dv">1</span>,
                        <span class="kw">ifelse</span>(row <span class="op">==</span><span class="st"> &quot;stepped&quot;</span>, <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">each =</span> sequence_length <span class="op">/</span><span class="st"> </span><span class="dv">2</span>),
                               <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(probability <span class="op">-</span><span class="st"> </span>.<span class="dv">5</span>) <span class="op">/</span><span class="st"> </span>.<span class="dv">25</span>) <span class="op">/</span><span class="st"> </span>( <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>.<span class="dv">25</span>))),
         <span class="dt">likelihood =</span> <span class="kw">dbinom</span>(<span class="dt">x =</span> <span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> probability)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(row) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior =</span> prior <span class="op">*</span><span class="st"> </span>likelihood <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(prior <span class="op">*</span><span class="st"> </span>likelihood)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(key, value, <span class="op">-</span>probability, <span class="op">-</span>row) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;prior&quot;</span>, <span class="st">&quot;likelihood&quot;</span>, <span class="st">&quot;posterior&quot;</span>)),
         <span class="dt">row =</span> <span class="kw">factor</span>(row, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;flat&quot;</span>, <span class="st">&quot;stepped&quot;</span>, <span class="st">&quot;Laplace&quot;</span>))) </code></pre></div>
<p>To learn more about <code>dplyr::arrange()</code>, chech out <a href="http://r4ds.had.co.nz/transform.html#arrange-rows-with-arrange"><em>R4DS</em>, Chapter 5.3</a>.</p>
<p>In order to avoid unnecessary facet labels for the rows, it was easier to just make each column of the plot separately and then recombine them with <code>gridExtra::grid.arrange()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p1 &lt;-
<span class="st">  </span>d <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(key <span class="op">==</span><span class="st"> &quot;prior&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> probability, <span class="dt">y =</span> value)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;prior&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid       =</span> <span class="kw">element_blank</span>(),
        <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">strip.text       =</span> <span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(row <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)

p2 &lt;-
<span class="st">  </span>d <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(key <span class="op">==</span><span class="st"> &quot;likelihood&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> probability, <span class="dt">y =</span> value)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;likelihood&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid       =</span> <span class="kw">element_blank</span>(),
        <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">strip.text       =</span> <span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(row <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)

p3 &lt;-
<span class="st">  </span>d <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(key <span class="op">==</span><span class="st"> &quot;posterior&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> probability, <span class="dt">y =</span> value)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;posterior&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid       =</span> <span class="kw">element_blank</span>(),
        <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(),
        <span class="dt">strip.text       =</span> <span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(row <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)

<span class="kw">library</span>(gridExtra)

<span class="kw">grid.arrange</span>(p1, p2, p3, <span class="dt">ncol =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="576" /></p>
<p>I’m not sure if it’s the same McElreath used in the text, but the formula I used for the tirangle-shaped prior is the <a href="http://ugrad.stat.ubc.ca/R/library/rmutil/html/Laplace.html">Laplace distribution</a> with a location of .5 and a dispersion of .25.</p>
<p>Also, to learn all about <code>dplyr::filter()</code>, check out Baert’s <a href="https://suzan.rbind.io/2018/02/dplyr-tutorial-3/"><em>Data Wrangling Part 3: Basic and more advanced ways to filter rows</em></a>.</p>
<div id="grid-approximation." class="section level3">
<h3><span class="header-section-number">2.4.1</span> Grid approximation.</h3>
<p>We just employed grid approximation over the last figure. In order to get nice smooth lines, we computed the posterior over 1000 evenly-spaced points on the probability space. Here we’ll prepare for Figure 2.7 with 20.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(d &lt;-
<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">p_grid            =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">20</span>),  <span class="co"># define grid</span>
        <span class="dt">prior             =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">                                   </span><span class="co"># define prior</span>
<span class="st">   </span><span class="kw">mutate</span>(<span class="dt">likelihood      =</span> <span class="kw">dbinom</span>(<span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> p_grid)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># compute likelihood at each value in grid</span>
<span class="st">   </span><span class="kw">mutate</span>(<span class="dt">unstd_posterior =</span> likelihood <span class="op">*</span><span class="st"> </span>prior) <span class="op">%&gt;%</span><span class="st">                  </span><span class="co"># compute product of likelihood and prior</span>
<span class="st">   </span><span class="kw">mutate</span>(<span class="dt">posterior       =</span> unstd_posterior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(unstd_posterior))  <span class="co"># standardize the posterior, so it sums to 1</span>
)</code></pre></div>
<pre><code>## # A tibble: 20 x 5
##    p_grid prior likelihood unstd_posterior   posterior
##     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;       &lt;dbl&gt;
##  1 0          1 0               0          0          
##  2 0.0526     1 0.00000152      0.00000152 0.000000799
##  3 0.105      1 0.0000819       0.0000819  0.0000431  
##  4 0.158      1 0.000777        0.000777   0.000409   
##  5 0.211      1 0.00360         0.00360    0.00189    
##  6 0.263      1 0.0112          0.0112     0.00587    
##  7 0.316      1 0.0267          0.0267     0.0140     
##  8 0.368      1 0.0529          0.0529     0.0279     
##  9 0.421      1 0.0908          0.0908     0.0478     
## 10 0.474      1 0.138           0.138      0.0728     
## 11 0.526      1 0.190           0.190      0.0999     
## 12 0.579      1 0.236           0.236      0.124      
## 13 0.632      1 0.267           0.267      0.140      
## 14 0.684      1 0.271           0.271      0.143      
## 15 0.737      1 0.245           0.245      0.129      
## 16 0.789      1 0.190           0.190      0.0999     
## 17 0.842      1 0.118           0.118      0.0621     
## 18 0.895      1 0.0503          0.0503     0.0265     
## 19 0.947      1 0.00885         0.00885    0.00466    
## 20 1          1 0               0          0</code></pre>
<p>Here’s the right panel of Figure 2.7.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid, <span class="dt">y =</span> posterior)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;20 points&quot;</span>,
       <span class="dt">x =</span> <span class="st">&quot;probability of water&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;posterior probability&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="288" /></p>
<p>Here it is with just 5 points, the left hand panel of Figure 2.7.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tibble</span>(<span class="dt">p_grid            =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">5</span>),
       <span class="dt">prior             =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood      =</span> <span class="kw">dbinom</span>(<span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> p_grid)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">unstd_posterior =</span> likelihood <span class="op">*</span><span class="st"> </span>prior) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior       =</span> unstd_posterior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(unstd_posterior)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid, <span class="dt">y =</span> posterior)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;5 points&quot;</span>,
       <span class="dt">x =</span> <span class="st">&quot;probability of water&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;posterior probability&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="288" /></p>
</div>
<div id="quadratic-approximation." class="section level3">
<h3><span class="header-section-number">2.4.2</span> Quadratic approximation.</h3>
<p>Apply the quadratic approximation to the globe tossing data with <code>rethinking::map()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rethinking)

globe_qa &lt;-
<span class="st">  </span>rethinking<span class="op">::</span><span class="kw">map</span>(
    <span class="kw">alist</span>(
      w <span class="op">~</span><span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">9</span>, p),  <span class="co"># binomial likelihood</span>
      p <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)    <span class="co"># uniform prior</span>
    ), 
    <span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">w =</span> <span class="dv">6</span>))

<span class="co"># display summary of quadratic approximation</span>
<span class="kw">precis</span>(globe_qa)</code></pre></div>
<pre><code>##        mean        sd     5.5%     94.5%
## p 0.6666677 0.1571335 0.415538 0.9177975</code></pre>
<p>In preparation for Figure 2.8, here’s the model with <span class="math inline">\(n = 18\)</span> and <span class="math inline">\(n = 36\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">globe_qa_<span class="dv">18</span> &lt;-
<span class="st">  </span>rethinking<span class="op">::</span><span class="kw">map</span>(
    <span class="kw">alist</span>(
      w <span class="op">~</span><span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>, p),
      p <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)
    ), <span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">w =</span> <span class="dv">6</span>  <span class="op">*</span><span class="dv">2</span>))

globe_qa_<span class="dv">36</span> &lt;-
<span class="st">  </span>rethinking<span class="op">::</span><span class="kw">map</span>(
    <span class="kw">alist</span>(
      w <span class="op">~</span><span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>, p),
      p <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)
    ), <span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">w =</span> <span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>))

<span class="kw">precis</span>(globe_qa_<span class="dv">18</span>)</code></pre></div>
<pre><code>##        mean        sd      5.5%     94.5%
## p 0.6666662 0.1111104 0.4890902 0.8442421</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">precis</span>(globe_qa_<span class="dv">36</span>)</code></pre></div>
<pre><code>##        mean         sd      5.5%     94.5%
## p 0.6666668 0.07856688 0.5411017 0.7922318</code></pre>
<p>Here’s the legwork for Figure 2.8.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_grid &lt;-<span class="st"> </span><span class="dv">100</span>

<span class="kw">tibble</span>(<span class="dt">p_grid                  =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> n_grid) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),
       <span class="dt">prior                   =</span> <span class="dv">1</span>,
       <span class="dt">w                       =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">24</span>), <span class="dt">each =</span> n_grid),
       <span class="dt">n                       =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">18</span>, <span class="dv">36</span>), <span class="dt">each =</span> n_grid),
       <span class="dt">m                       =</span> .<span class="dv">67</span>,
       <span class="dt">s                       =</span> <span class="kw">rep</span>(<span class="kw">c</span>(.<span class="dv">16</span>, .<span class="dv">11</span>, .<span class="dv">08</span>), <span class="dt">each =</span> n_grid)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood            =</span> <span class="kw">dbinom</span>(w, <span class="dt">size =</span> n, <span class="dt">prob =</span> p_grid)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">unstd_grid_posterior  =</span> likelihood <span class="op">*</span><span class="st"> </span>prior,
         <span class="dt">unstd_quad_posterior  =</span> <span class="kw">dnorm</span>(p_grid, m, s)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(w) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">grid_posterior        =</span> unstd_grid_posterior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(unstd_grid_posterior),
         <span class="dt">quad_posterior        =</span> unstd_quad_posterior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(unstd_quad_posterior),
         <span class="dt">n =</span> <span class="kw">str_c</span>(<span class="st">&quot;n = &quot;</span>, n)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">factor</span>(n, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;n = 9&quot;</span>, <span class="st">&quot;n = 18&quot;</span>, <span class="st">&quot;n = 36&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> grid_posterior)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> quad_posterior),
            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;proportion water&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>n, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="768" /></p>
</div>
<div id="markov-chain-monte-carlo." class="section level3">
<h3><span class="header-section-number">2.4.3</span> Markov chain Monte Carlo.</h3>
<p>Since the main goal of this project is to highlight brms, we may as fit a model. This seems like an appropriately named subsection to do so. First we’ll have to load the package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(brms)</code></pre></div>
<p>Here we’ll re-fit the last model from above wherein <span class="math inline">\(w = 24\)</span> and <span class="math inline">\(n = 36\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">globe_qa_brms &lt;-
<span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">w =</span> <span class="dv">24</span>), 
      <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;identity&quot;</span>),
      w <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(<span class="dv">36</span>) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,
      <span class="kw">prior</span>(<span class="kw">beta</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">class =</span> Intercept),
      <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>,
      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> .<span class="dv">9</span>),
      <span class="dt">seed =</span> <span class="dv">4</span>)</code></pre></div>
<p>The model output looks like so.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(globe_qa_brms)</code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = identity 
## Formula: w | trials(36) ~ 1 
##    Data: list(w = 24) (Number of observations: 1) 
## Samples: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 12000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept     0.66      0.08     0.50     0.80       3579 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>There’s a lot going on in that output, which we’ll start to clarify in Chapter 4. For now, focus on the ‘Intercept’ line. As we’ll also learn in Chapter 4, the intercept of a regression model with no predictors is the same as its mean. In the special case of a model using the binomial likelihood, the mean is the probability of a 1 in a given trial, <span class="math inline">\(\theta\)</span>.</p>
<p>Let’s plot the results of our model and compare them with those from <code>rethinking::map()</code>, above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">posterior_samples</span>(globe_qa_brms) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="st">&quot;n = 36&quot;</span>) <span class="op">%&gt;%</span>

<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_Intercept)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;proportion water&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>n)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-42-1.png" width="288" /></p>
<p>If you’re still confused. Cool. This is just a preview. We’ll start walking through fitting models in brms in Chapter 4 and we’ll learn a lot about regression with the binomial likelihood in Chapter 10.</p>
</div>
</div>
<div id="reference-1" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://xcelab.net/rm/statistical-rethinking/">McElreath, R. (2016). <em>Statistical rethinking: A Bayesian course with examples in R and Stan.</em> Chapman &amp; Hall/CRC Press.</a></p>
</div>
<div id="session-info-1" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R version 3.5.1 (2018-07-02)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS: /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] viridis_0.5.1          viridisLite_0.3.0      ggbeeswarm_0.6.0       dutchmasters_0.1.0    
##  [5] ghibli_0.2.0           hrbrthemes_0.6.0       broom_0.5.1            rcartocolor_1.0.0     
##  [9] loo_2.1.0              ggthemes_4.0.1         wesanderson_0.3.6.9000 GGally_1.4.0          
## [13] tidybayes_1.0.4        bayesplot_1.6.0        fiftystater_1.0.1      bindrcpp_0.2.2        
## [17] ggrepel_0.8.0          brms_2.8.0             Rcpp_1.0.0             rethinking_1.80       
## [21] rstan_2.18.2           StanHeaders_2.18.0-1   gridExtra_2.3          forcats_0.3.0         
## [25] stringr_1.3.1          dplyr_0.8.0.1          purrr_0.2.5            readr_1.1.1           
## [29] tidyr_0.8.1            tibble_2.1.1           ggplot2_3.1.0          tidyverse_1.2.1       
## 
## loaded via a namespace (and not attached):
##   [1] readxl_1.1.0              backports_1.1.2           plyr_1.8.4               
##   [4] igraph_1.2.1              lazyeval_0.2.1            svUnit_0.7-12            
##   [7] crosstalk_1.0.0           rstantools_1.5.0          inline_0.3.15            
##  [10] digest_0.6.18             htmltools_0.3.6           rsconnect_0.8.8          
##  [13] fansi_0.4.0               magrittr_1.5              modelr_0.1.2             
##  [16] extrafont_0.17            matrixStats_0.54.0        xts_0.10-2               
##  [19] extrafontdb_1.0           prettyunits_1.0.2         colorspace_1.3-2         
##  [22] rvest_0.3.2               haven_1.1.2               xfun_0.3                 
##  [25] callr_3.1.0               crayon_1.3.4              jsonlite_1.5             
##  [28] bindr_0.1.1               zoo_1.8-2                 glue_1.3.0               
##  [31] gtable_0.2.0              pkgbuild_1.0.2            Rttf2pt1_1.3.7           
##  [34] abind_1.4-5               scales_1.0.0              mvtnorm_1.0-8            
##  [37] miniUI_0.1.1.1            xtable_1.8-2              ggstance_0.3             
##  [40] stats4_3.5.1              DT_0.4                    htmlwidgets_1.2          
##  [43] httr_1.3.1                threejs_0.3.1             arrayhelpers_1.0-20160527
##  [46] RColorBrewer_1.1-2        pkgconfig_2.0.2           reshape_0.8.7            
##  [49] utf8_1.1.4                tidyselect_0.2.5          labeling_0.3             
##  [52] rlang_0.3.1               reshape2_1.4.3            later_0.7.3              
##  [55] munsell_0.5.0             cellranger_1.1.0          tools_3.5.1              
##  [58] cli_1.0.1                 generics_0.0.2            pacman_0.4.6             
##  [61] ggridges_0.5.0            evaluate_0.10.1           yaml_2.1.19              
##  [64] processx_3.2.1            knitr_1.20                nlme_3.1-137             
##  [67] mime_0.5                  xml2_1.2.0                compiler_3.5.1           
##  [70] shinythemes_1.1.1         rstudioapi_0.7            beeswarm_0.2.3           
##  [73] stringi_1.2.3             highr_0.7                 ps_1.2.1                 
##  [76] Brobdingnag_1.2-5         gdtools_0.1.7             lattice_0.20-35          
##  [79] Matrix_1.2-14             markdown_0.8              shinyjs_1.0              
##  [82] pillar_1.3.1              bridgesampling_0.4-0      httpuv_1.4.4.2           
##  [85] R6_2.3.0                  bookdown_0.9              promises_1.0.1           
##  [88] vipor_0.4.5               codetools_0.2-15          colourpicker_1.0         
##  [91] MASS_7.3-50               gtools_3.8.1              assertthat_0.2.0         
##  [94] rprojroot_1.3-2           withr_2.1.2               shinystan_2.5.0          
##  [97] hms_0.4.2                 grid_3.5.1                coda_0.19-2              
## [100] rmarkdown_1.10            shiny_1.1.0               lubridate_1.7.4          
## [103] base64enc_0.1-3           dygraphs_1.1.1.5</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-golem-of-prague.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sampling-the-imaginary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
