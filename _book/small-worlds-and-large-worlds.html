<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Small Worlds and Large Worlds | Statistical rethinking with brms, ggplot2, and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in McElreath’s textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Small Worlds and Large Worlds | Statistical rethinking with brms, ggplot2, and the tidyverse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This project is an attempt to re-express the code in McElreath’s textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKURZ/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Small Worlds and Large Worlds | Statistical rethinking with brms, ggplot2, and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in McElreath’s textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2023-01-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-golem-of-prague.html"/>
<link rel="next" href="sampling-the-imaginary.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>This is a love letter</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this"><i class="fa fa-check"></i>Why this?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#my-assumptions-about-you"><i class="fa fa-check"></i>My assumptions about you</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-and-understand-this-project"><i class="fa fa-check"></i>How to use and understand this project</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#you-can-do-this-too"><i class="fa fa-check"></i>You can do this, too</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.9.0."><i class="fa fa-check"></i>Version 0.9.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.0.0."><i class="fa fa-check"></i>Version 1.0.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.0.1."><i class="fa fa-check"></i>Version 1.0.1.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.1.0."><i class="fa fa-check"></i>Version 1.1.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.2.0."><i class="fa fa-check"></i>Version 1.2.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.3.0."><i class="fa fa-check"></i>Version 1.3.0.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#is-this-material-obsolete"><i class="fa fa-check"></i>Is this material obsolete?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a>
<ul>
<li class="chapter" data-level="" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#the-garden-of-forking-data"><i class="fa fa-check"></i><b>2.1</b> The garden of forking data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#counting-possibilities."><i class="fa fa-check"></i><b>2.1.1</b> Counting possibilities.</a></li>
<li class="chapter" data-level="2.1.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#using-prior-information."><i class="fa fa-check"></i><b>2.1.2</b> Using prior information.</a></li>
<li class="chapter" data-level="2.1.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#from-counts-to-probability."><i class="fa fa-check"></i><b>2.1.3</b> From counts to probability.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#building-a-model"><i class="fa fa-check"></i><b>2.2</b> Building a model</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#a-data-story."><i class="fa fa-check"></i><b>2.2.1</b> A data story.</a></li>
<li class="chapter" data-level="2.2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#bayesian-updating."><i class="fa fa-check"></i><b>2.2.2</b> Bayesian updating.</a></li>
<li class="chapter" data-level="2.2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#evaluate."><i class="fa fa-check"></i><b>2.2.3</b> Evaluate.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#components-of-the-model"><i class="fa fa-check"></i><b>2.3</b> Components of the model</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#likelihood."><i class="fa fa-check"></i><b>2.3.1</b> Likelihood.</a></li>
<li class="chapter" data-level="2.3.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#parameters."><i class="fa fa-check"></i><b>2.3.2</b> Parameters.</a></li>
<li class="chapter" data-level="2.3.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#prior."><i class="fa fa-check"></i><b>2.3.3</b> Prior.</a></li>
<li class="chapter" data-level="2.3.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#posterior."><i class="fa fa-check"></i><b>2.3.4</b> Posterior.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#making-the-model-go"><i class="fa fa-check"></i><b>2.4</b> Making the model go</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#grid-approximation."><i class="fa fa-check"></i><b>2.4.1</b> Grid approximation.</a></li>
<li class="chapter" data-level="2.4.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#quadratic-approximation."><i class="fa fa-check"></i><b>2.4.2</b> Quadratic approximation.</a></li>
<li class="chapter" data-level="2.4.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#markov-chain-monte-carlo."><i class="fa fa-check"></i><b>2.4.3</b> Markov chain Monte Carlo.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-from-a-grid-like-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-like approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-boundaries."><i class="fa fa-check"></i><b>3.2.1</b> Intervals of defined boundaries.</a></li>
<li class="chapter" data-level="3.2.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-mass."><i class="fa fa-check"></i><b>3.2.2</b> Intervals of defined mass.</a></li>
<li class="chapter" data-level="3.2.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#point-estimates."><i class="fa fa-check"></i><b>3.2.3</b> Point estimates.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#dummy-data."><i class="fa fa-check"></i><b>3.3.1</b> Dummy data.</a></li>
<li class="chapter" data-level="3.3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#model-checking."><i class="fa fa-check"></i><b>3.3.2</b> Model checking.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#summary-lets-practice-with-brms"><i class="fa fa-check"></i><b>3.4</b> <del>Summary</del> Let’s practice with brms</a></li>
<li class="chapter" data-level="" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>4</b> Linear Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="linear-models.html"><a href="linear-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why normal distributions are normal</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="linear-models.html"><a href="linear-models.html#normal-by-addition."><i class="fa fa-check"></i><b>4.1.1</b> Normal by addition.</a></li>
<li class="chapter" data-level="4.1.2" data-path="linear-models.html"><a href="linear-models.html#normal-by-multiplication."><i class="fa fa-check"></i><b>4.1.2</b> Normal by multiplication.</a></li>
<li class="chapter" data-level="4.1.3" data-path="linear-models.html"><a href="linear-models.html#normal-by-log-multiplication."><i class="fa fa-check"></i><b>4.1.3</b> Normal by log-multiplication.</a></li>
<li class="chapter" data-level="4.1.4" data-path="linear-models.html"><a href="linear-models.html#using-gaussian-distributions."><i class="fa fa-check"></i><b>4.1.4</b> Using Gaussian distributions.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="linear-models.html"><a href="linear-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="linear-models.html"><a href="linear-models.html#re-describing-the-globe-tossing-model."><i class="fa fa-check"></i><b>4.2.1</b> Re-describing the globe tossing model.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="linear-models.html"><a href="linear-models.html#a-gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> A Gaussian model of height</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="linear-models.html"><a href="linear-models.html#the-data."><i class="fa fa-check"></i><b>4.3.1</b> The data.</a></li>
<li class="chapter" data-level="4.3.2" data-path="linear-models.html"><a href="linear-models.html#the-model."><i class="fa fa-check"></i><b>4.3.2</b> The model.</a></li>
<li class="chapter" data-level="4.3.3" data-path="linear-models.html"><a href="linear-models.html#grid-approximation-of-the-posterior-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Grid approximation of the posterior distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="linear-models.html"><a href="linear-models.html#sampling-from-the-posterior."><i class="fa fa-check"></i><b>4.3.4</b> Sampling from the posterior.</a></li>
<li class="chapter" data-level="4.3.5" data-path="linear-models.html"><a href="linear-models.html#fitting-the-model-with-map-brm."><i class="fa fa-check"></i><b>4.3.5</b> Fitting the model with <del><code>map</code></del> <code>brm()</code>.</a></li>
<li class="chapter" data-level="4.3.6" data-path="linear-models.html"><a href="linear-models.html#sampling-from-a-map-brm-fit."><i class="fa fa-check"></i><b>4.3.6</b> Sampling from a <del><code>map</code></del> <code>brm()</code> fit.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="linear-models.html"><a href="linear-models.html#adding-a-predictor"><i class="fa fa-check"></i><b>4.4</b> Adding a predictor</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="linear-models.html"><a href="linear-models.html#the-linear-model-strategy."><i class="fa fa-check"></i><b>4.4.1</b> The linear model strategy.</a></li>
<li class="chapter" data-level="4.4.2" data-path="linear-models.html"><a href="linear-models.html#fitting-the-model."><i class="fa fa-check"></i><b>4.4.2</b> Fitting the model.</a></li>
<li class="chapter" data-level="4.4.3" data-path="linear-models.html"><a href="linear-models.html#interpreting-the-model-fit."><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the model fit.</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="linear-models.html"><a href="linear-models.html#polynomial-regression"><i class="fa fa-check"></i><b>4.5</b> Polynomial regression</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html"><i class="fa fa-check"></i><b>5</b> Multivariate Linear Models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#spurious-associations"><i class="fa fa-check"></i><b>5.1</b> Spurious associations</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multivariate-notation."><i class="fa fa-check"></i><b>5.1.1</b> Multivariate notation.</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#fitting-the-model.-1"><i class="fa fa-check"></i><b>5.1.2</b> Fitting the model.</a></li>
<li class="chapter" data-level="5.1.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#plotting-multivariate-posteriors."><i class="fa fa-check"></i><b>5.1.3</b> Plotting multivariate posteriors.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#masked-relationship"><i class="fa fa-check"></i><b>5.2</b> Masked relationship</a></li>
<li class="chapter" data-level="5.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multicollinearity"><i class="fa fa-check"></i><b>5.3</b> Multicollinearity</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multicollinear-legs."><i class="fa fa-check"></i><b>5.3.1</b> Multicollinear legs.</a></li>
<li class="chapter" data-level="5.3.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multicollinear-milk."><i class="fa fa-check"></i><b>5.3.2</b> Multicollinear <code>milk</code>.</a></li>
<li class="chapter" data-level="5.3.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#post-treatment-bias."><i class="fa fa-check"></i><b>5.3.3</b> Post-treatment bias.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#categorical-variables"><i class="fa fa-check"></i><b>5.4</b> Categorical variables</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#binary-categories."><i class="fa fa-check"></i><b>5.4.1</b> Binary categories.</a></li>
<li class="chapter" data-level="5.4.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#many-categories."><i class="fa fa-check"></i><b>5.4.2</b> Many categories.</a></li>
<li class="chapter" data-level="5.4.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#adding-regular-predictor-variables."><i class="fa fa-check"></i><b>5.4.3</b> Adding regular predictor variables.</a></li>
<li class="chapter" data-level="5.4.4" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#another-approach-unique-intercepts."><i class="fa fa-check"></i><b>5.4.4</b> Another approach: Unique intercepts.</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#ordinary-least-squares-and-lm"><i class="fa fa-check"></i><b>5.5</b> <del>Ordinary least squares and <code>lm()</code></del></a></li>
<li class="chapter" data-level="" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html"><i class="fa fa-check"></i><b>6</b> Overfitting, Regularization, and Information Criteria</a>
<ul>
<li class="chapter" data-level="6.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>6.1</b> The problem with parameters</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#more-parameters-always-improve-fit."><i class="fa fa-check"></i><b>6.1.1</b> More parameters always improve fit.</a></li>
<li class="chapter" data-level="6.1.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#too-few-parameters-hurts-too."><i class="fa fa-check"></i><b>6.1.2</b> Too few parameters hurts, too.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#information-theory-and-model-performance"><i class="fa fa-check"></i><b>6.2</b> Information theory and model performance</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#firing-the-weatherperson."><i class="fa fa-check"></i><b>6.2.1</b> Firing the weatherperson.</a></li>
<li class="chapter" data-level="6.2.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#information-and-uncertainty."><i class="fa fa-check"></i><b>6.2.2</b> Information and uncertainty.</a></li>
<li class="chapter" data-level="6.2.3" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#from-entropy-to-accuracy."><i class="fa fa-check"></i><b>6.2.3</b> From entropy to accuracy.</a></li>
<li class="chapter" data-level="6.2.4" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#from-divergence-to-deviance."><i class="fa fa-check"></i><b>6.2.4</b> From divergence to deviance.</a></li>
<li class="chapter" data-level="6.2.5" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#from-deviance-to-out-of-sample."><i class="fa fa-check"></i><b>6.2.5</b> From deviance to out-of-sample.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#regularization"><i class="fa fa-check"></i><b>6.3</b> Regularization</a></li>
<li class="chapter" data-level="6.4" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#information-criteria"><i class="fa fa-check"></i><b>6.4</b> Information criteria</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#dic."><i class="fa fa-check"></i><b>6.4.1</b> DIC.</a></li>
<li class="chapter" data-level="6.4.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#waic."><i class="fa fa-check"></i><b>6.4.2</b> WAIC.</a></li>
<li class="chapter" data-level="6.4.3" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#dic-and-waic-as-estimates-of-deviance."><i class="fa fa-check"></i><b>6.4.3</b> DIC and WAIC as estimates of deviance.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#using-information-criteria"><i class="fa fa-check"></i><b>6.5</b> Using information criteria</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#model-comparison."><i class="fa fa-check"></i><b>6.5.1</b> Model comparison.</a></li>
<li class="chapter" data-level="6.5.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#model-averaging."><i class="fa fa-check"></i><b>6.5.2</b> Model averaging.</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#summary-bonus-r2-talk"><i class="fa fa-check"></i><b>6.6</b> <del>Summary</del> Bonus: <span class="math inline">\(R^2\)</span> talk</a></li>
<li class="chapter" data-level="" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>7</b> Interactions</a>
<ul>
<li class="chapter" data-level="7.1" data-path="interactions.html"><a href="interactions.html#building-an-interaction."><i class="fa fa-check"></i><b>7.1</b> Building an interaction.</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="interactions.html"><a href="interactions.html#adding-a-dummy-variable-doesnt-work."><i class="fa fa-check"></i><b>7.1.1</b> Adding a dummy variable doesn’t work.</a></li>
<li class="chapter" data-level="7.1.2" data-path="interactions.html"><a href="interactions.html#adding-a-linear-interaction-does-work."><i class="fa fa-check"></i><b>7.1.2</b> Adding a linear interaction does work.</a></li>
<li class="chapter" data-level="7.1.3" data-path="interactions.html"><a href="interactions.html#plotting-the-interaction."><i class="fa fa-check"></i><b>7.1.3</b> Plotting the interaction.</a></li>
<li class="chapter" data-level="7.1.4" data-path="interactions.html"><a href="interactions.html#interpreting-an-interaction-estimate."><i class="fa fa-check"></i><b>7.1.4</b> Interpreting an interaction estimate.</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="interactions.html"><a href="interactions.html#symmetry-of-the-linear-interaction."><i class="fa fa-check"></i><b>7.2</b> Symmetry of the linear interaction.</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="interactions.html"><a href="interactions.html#buridans-interaction."><i class="fa fa-check"></i><b>7.2.1</b> Buridan’s interaction.</a></li>
<li class="chapter" data-level="7.2.2" data-path="interactions.html"><a href="interactions.html#africa-depends-upon-ruggedness."><i class="fa fa-check"></i><b>7.2.2</b> Africa depends upon ruggedness.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="interactions.html"><a href="interactions.html#continuous-interactions"><i class="fa fa-check"></i><b>7.3</b> Continuous interactions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="interactions.html"><a href="interactions.html#the-data.-1"><i class="fa fa-check"></i><b>7.3.1</b> The data.</a></li>
<li class="chapter" data-level="7.3.2" data-path="interactions.html"><a href="interactions.html#the-un-centered-models."><i class="fa fa-check"></i><b>7.3.2</b> The un-centered models.</a></li>
<li class="chapter" data-level="7.3.3" data-path="interactions.html"><a href="interactions.html#center-and-re-estimate."><i class="fa fa-check"></i><b>7.3.3</b> Center and re-estimate.</a></li>
<li class="chapter" data-level="7.3.4" data-path="interactions.html"><a href="interactions.html#plotting-implied-predictions."><i class="fa fa-check"></i><b>7.3.4</b> Plotting implied predictions.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="interactions.html"><a href="interactions.html#interactions-in-design-formulas"><i class="fa fa-check"></i><b>7.4</b> Interactions in design formulas</a></li>
<li class="chapter" data-level="7.5" data-path="interactions.html"><a href="interactions.html#summary-bonus-marginal_effectsconditional_effects"><i class="fa fa-check"></i><b>7.5</b> <del>Summary</del> Bonus: <code>marginal_effects()</code>/<code>conditional_effects()</code></a></li>
<li class="chapter" data-level="" data-path="interactions.html"><a href="interactions.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>8</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="8.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#good-king-markov-and-his-island-kingdom"><i class="fa fa-check"></i><b>8.1</b> Good King Markov and His island kingdom</a></li>
<li class="chapter" data-level="8.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#markov-chain-monte-carlo-1"><i class="fa fa-check"></i><b>8.2</b> Markov chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-sampling."><i class="fa fa-check"></i><b>8.2.1</b> Gibbs sampling.</a></li>
<li class="chapter" data-level="8.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#hamiltonian-monte-carlo."><i class="fa fa-check"></i><b>8.2.2</b> Hamiltonian Monte Carlo.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#easy-hmc-map2stan-brm"><i class="fa fa-check"></i><b>8.3</b> Easy HMC: <del>map2stan</del> <code>brm()</code></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#preparation."><i class="fa fa-check"></i><b>8.3.1</b> Preparation.</a></li>
<li class="chapter" data-level="8.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#estimation."><i class="fa fa-check"></i><b>8.3.2</b> Estimation.</a></li>
<li class="chapter" data-level="8.3.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#sampling-again-in-parallel."><i class="fa fa-check"></i><b>8.3.3</b> Sampling again, in parallel.</a></li>
<li class="chapter" data-level="8.3.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#visualization."><i class="fa fa-check"></i><b>8.3.4</b> Visualization.</a></li>
<li class="chapter" data-level="8.3.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#using-the-samples."><i class="fa fa-check"></i><b>8.3.5</b> Using the samples.</a></li>
<li class="chapter" data-level="8.3.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#checking-the-chain."><i class="fa fa-check"></i><b>8.3.6</b> Checking the chain.</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#care-and-feeding-of-your-markov-chain."><i class="fa fa-check"></i><b>8.4</b> Care and feeding of your Markov chain.</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>8.4.1</b> How many samples do you need?</a></li>
<li class="chapter" data-level="8.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-chains-do-you-need"><i class="fa fa-check"></i><b>8.4.2</b> How many chains do you need?</a></li>
<li class="chapter" data-level="8.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#taming-a-wild-chain."><i class="fa fa-check"></i><b>8.4.3</b> Taming a wild chain.</a></li>
<li class="chapter" data-level="8.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#non-identifiable-parameters."><i class="fa fa-check"></i><b>8.4.4</b> Non-identifiable parameters.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>9</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="9.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>9.1</b> Maximum entropy</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#gaussian."><i class="fa fa-check"></i><b>9.1.1</b> Gaussian.</a></li>
<li class="chapter" data-level="9.1.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#binomial."><i class="fa fa-check"></i><b>9.1.2</b> Binomial.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>9.2</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#meet-the-family."><i class="fa fa-check"></i><b>9.2.1</b> Meet the family.</a></li>
<li class="chapter" data-level="9.2.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions."><i class="fa fa-check"></i><b>9.2.2</b> Linking linear models to distributions.</a></li>
<li class="chapter" data-level="9.2.3" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#absolute-and-relative-differences."><i class="fa fa-check"></i><b>9.2.3</b> Absolute and relative differences.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="counting-and-classification.html"><a href="counting-and-classification.html"><i class="fa fa-check"></i><b>10</b> Counting and Classification</a>
<ul>
<li class="chapter" data-level="10.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#binomial-regression"><i class="fa fa-check"></i><b>10.1</b> Binomial regression</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#logistic-regression-prosocial-chimpanzees."><i class="fa fa-check"></i><b>10.1.1</b> Logistic regression: Prosocial chimpanzees.</a></li>
<li class="chapter" data-level="10.1.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#aggregated-binomial-chimpanzees-again-condensed."><i class="fa fa-check"></i><b>10.1.2</b> Aggregated binomial: Chimpanzees again, condensed.</a></li>
<li class="chapter" data-level="10.1.3" data-path="counting-and-classification.html"><a href="counting-and-classification.html#aggregated-binomial-graduate-school-admissions."><i class="fa fa-check"></i><b>10.1.3</b> Aggregated binomial: Graduate school admissions.</a></li>
<li class="chapter" data-level="10.1.4" data-path="counting-and-classification.html"><a href="counting-and-classification.html#fitting-binomial-regressions-with-glm."><i class="fa fa-check"></i><b>10.1.4</b> Fitting binomial regressions with <code>glm()</code>.</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#poisson-regression"><i class="fa fa-check"></i><b>10.2</b> Poisson regression</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#example-oceanic-tool-complexity."><i class="fa fa-check"></i><b>10.2.1</b> Example: Oceanic tool complexity.</a></li>
<li class="chapter" data-level="10.2.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#mcmc-islands."><i class="fa fa-check"></i><b>10.2.2</b> MCMC islands.</a></li>
<li class="chapter" data-level="10.2.3" data-path="counting-and-classification.html"><a href="counting-and-classification.html#example-exposure-and-the-offset."><i class="fa fa-check"></i><b>10.2.3</b> Example: Exposure and the offset.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="counting-and-classification.html"><a href="counting-and-classification.html#other-count-regressions"><i class="fa fa-check"></i><b>10.3</b> Other count regressions</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#multinomial."><i class="fa fa-check"></i><b>10.3.1</b> Multinomial.</a></li>
<li class="chapter" data-level="10.3.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#geometric."><i class="fa fa-check"></i><b>10.3.2</b> Geometric.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="counting-and-classification.html"><a href="counting-and-classification.html#summary"><i class="fa fa-check"></i><b>10.4</b> Summary</a></li>
<li class="chapter" data-level="" data-path="counting-and-classification.html"><a href="counting-and-classification.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html"><i class="fa fa-check"></i><b>11</b> Monsters and Mixtures</a>
<ul>
<li class="chapter" data-level="11.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i><b>11.1</b> Ordered categorical outcomes</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-moral-intuition."><i class="fa fa-check"></i><b>11.1.1</b> Example: Moral intuition.</a></li>
<li class="chapter" data-level="11.1.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#describing-an-ordered-distribution-with-intercepts."><i class="fa fa-check"></i><b>11.1.2</b> Describing an ordered distribution with intercepts.</a></li>
<li class="chapter" data-level="11.1.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#adding-predictor-variables."><i class="fa fa-check"></i><b>11.1.3</b> Adding predictor variables.</a></li>
<li class="chapter" data-level="11.1.4" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#bonus-figure-11.3-alternative."><i class="fa fa-check"></i><b>11.1.4</b> Bonus: Figure 11.3 alternative.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i><b>11.2</b> Zero-inflated outcomes</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-zero-inflated-poisson."><i class="fa fa-check"></i><b>11.2.1</b> Example: Zero-inflated Poisson.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersed-outcomes"><i class="fa fa-check"></i><b>11.3</b> Over-dispersed outcomes</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#beta-binomial."><i class="fa fa-check"></i><b>11.3.1</b> Beta-binomial.</a></li>
<li class="chapter" data-level="11.3.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#negative-binomial-or-gamma-poisson."><i class="fa fa-check"></i><b>11.3.2</b> Negative-binomial or gamma-Poisson.</a></li>
<li class="chapter" data-level="11.3.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersion-entropy-and-information-criteria."><i class="fa fa-check"></i><b>11.3.3</b> Over-dispersion, entropy, and information criteria.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>12</b> Multilevel Models</a>
<ul>
<li class="chapter" data-level="12.1" data-path="multilevel-models.html"><a href="multilevel-models.html#example-multilevel-tadpoles"><i class="fa fa-check"></i><b>12.1</b> Example: Multilevel tadpoles</a></li>
<li class="chapter" data-level="12.2" data-path="multilevel-models.html"><a href="multilevel-models.html#varying-effects-and-the-underfittingoverfitting-trade-off"><i class="fa fa-check"></i><b>12.2</b> Varying effects and the underfitting/overfitting trade-off</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="multilevel-models.html"><a href="multilevel-models.html#the-model.-1"><i class="fa fa-check"></i><b>12.2.1</b> The model.</a></li>
<li class="chapter" data-level="12.2.2" data-path="multilevel-models.html"><a href="multilevel-models.html#assign-values-to-the-parameters."><i class="fa fa-check"></i><b>12.2.2</b> Assign values to the parameters.</a></li>
<li class="chapter" data-level="12.2.3" data-path="multilevel-models.html"><a href="multilevel-models.html#sumulate-survivors."><i class="fa fa-check"></i><b>12.2.3</b> Sumulate survivors.</a></li>
<li class="chapter" data-level="12.2.4" data-path="multilevel-models.html"><a href="multilevel-models.html#compute-the-no-pooling-estimates."><i class="fa fa-check"></i><b>12.2.4</b> Compute the no-pooling estimates.</a></li>
<li class="chapter" data-level="12.2.5" data-path="multilevel-models.html"><a href="multilevel-models.html#compute-the-partial-pooling-estimates."><i class="fa fa-check"></i><b>12.2.5</b> Compute the partial-pooling estimates.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="multilevel-models.html"><a href="multilevel-models.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>12.3</b> More than one type of cluster</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="multilevel-models.html"><a href="multilevel-models.html#multilevel-chimpanzees."><i class="fa fa-check"></i><b>12.3.1</b> Multilevel chimpanzees.</a></li>
<li class="chapter" data-level="12.3.2" data-path="multilevel-models.html"><a href="multilevel-models.html#two-types-of-cluster."><i class="fa fa-check"></i><b>12.3.2</b> Two types of cluster.</a></li>
<li class="chapter" data-level="12.3.3" data-path="multilevel-models.html"><a href="multilevel-models.html#even-more-clusters."><i class="fa fa-check"></i><b>12.3.3</b> Even more clusters.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="multilevel-models.html"><a href="multilevel-models.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>12.4</b> Multilevel posterior predictions</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="multilevel-models.html"><a href="multilevel-models.html#posterior-prediction-for-same-clusters."><i class="fa fa-check"></i><b>12.4.1</b> Posterior prediction for same clusters.</a></li>
<li class="chapter" data-level="12.4.2" data-path="multilevel-models.html"><a href="multilevel-models.html#posterior-prediction-for-new-clusters."><i class="fa fa-check"></i><b>12.4.2</b> Posterior prediction for new clusters.</a></li>
<li class="chapter" data-level="12.4.3" data-path="multilevel-models.html"><a href="multilevel-models.html#focus-and-multilevel-prediction."><i class="fa fa-check"></i><b>12.4.3</b> Focus and multilevel prediction.</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="multilevel-models.html"><a href="multilevel-models.html#summary-bonus-put-your-random-effects-to-work"><i class="fa fa-check"></i><b>12.5</b> <del>Summary</del> Bonus: Put your random effects to work</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="multilevel-models.html"><a href="multilevel-models.html#intercepts-only-models-with-one-or-two-grouping-variables."><i class="fa fa-check"></i><b>12.5.1</b> Intercepts-only models with one or two grouping variables.</a></li>
<li class="chapter" data-level="12.5.2" data-path="multilevel-models.html"><a href="multilevel-models.html#brmsas_draws_df."><i class="fa fa-check"></i><b>12.5.2</b> <code>brms::as_draws_df()</code>.</a></li>
<li class="chapter" data-level="12.5.3" data-path="multilevel-models.html"><a href="multilevel-models.html#brmscoef."><i class="fa fa-check"></i><b>12.5.3</b> <code>brms::coef()</code>.</a></li>
<li class="chapter" data-level="12.5.4" data-path="multilevel-models.html"><a href="multilevel-models.html#brmsfitted."><i class="fa fa-check"></i><b>12.5.4</b> <code>brms::fitted()</code>.</a></li>
<li class="chapter" data-level="12.5.5" data-path="multilevel-models.html"><a href="multilevel-models.html#tidybayesspread_draws."><i class="fa fa-check"></i><b>12.5.5</b> <code>tidybayes::spread_draws()</code>.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multilevel-models.html"><a href="multilevel-models.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html"><i class="fa fa-check"></i><b>13</b> Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="13.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>13.1</b> Varying slopes by construction</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-the-population."><i class="fa fa-check"></i><b>13.1.1</b> Simulate the population.</a></li>
<li class="chapter" data-level="13.1.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-observations."><i class="fa fa-check"></i><b>13.1.2</b> Simulate observations.</a></li>
<li class="chapter" data-level="13.1.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#the-varying-slopes-model."><i class="fa fa-check"></i><b>13.1.3</b> The varying slopes model.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-admission-decisions-and-gender"><i class="fa fa-check"></i><b>13.2</b> Example: Admission decisions and gender</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-intercepts."><i class="fa fa-check"></i><b>13.2.1</b> Varying intercepts.</a></li>
<li class="chapter" data-level="13.2.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-effects-of-being-male."><i class="fa fa-check"></i><b>13.2.2</b> Varying effects of being <code>male</code>.</a></li>
<li class="chapter" data-level="13.2.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#shrinkage."><i class="fa fa-check"></i><b>13.2.3</b> Shrinkage.</a></li>
<li class="chapter" data-level="13.2.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#model-comparison.-1"><i class="fa fa-check"></i><b>13.2.4</b> Model comparison.</a></li>
<li class="chapter" data-level="13.2.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#more-slopes."><i class="fa fa-check"></i><b>13.2.5</b> More slopes.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-cross-classified-chimpanzees-with-varying-slopes"><i class="fa fa-check"></i><b>13.3</b> Example: Cross-classified <code>chimpanzees</code> with varying slopes</a></li>
<li class="chapter" data-level="13.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>13.4</b> Continuous categories and the Gaussian process</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools."><i class="fa fa-check"></i><b>13.4.1</b> Example: Spatial autocorrelation in Oceanic tools.</a></li>
<li class="chapter" data-level="13.4.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#other-kinds-of-distance."><i class="fa fa-check"></i><b>13.4.2</b> Other kinds of “distance”.</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#summary-bonus-another-berkeley-admissions-data-like-example."><i class="fa fa-check"></i><b>13.5</b> <del>Summary</del> Bonus: Another Berkeley-admissions-data-like example.</a></li>
<li class="chapter" data-level="" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html"><i class="fa fa-check"></i><b>14</b> Missing Data and Other Opportunities</a>
<ul>
<li class="chapter" data-level="14.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#measurement-error"><i class="fa fa-check"></i><b>14.1</b> Measurement error</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#error-on-the-outcome."><i class="fa fa-check"></i><b>14.1.1</b> Error on the outcome.</a></li>
<li class="chapter" data-level="14.1.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#error-on-both-outcome-and-predictor."><i class="fa fa-check"></i><b>14.1.2</b> Error on both outcome and predictor.</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#missing-data"><i class="fa fa-check"></i><b>14.2</b> Missing data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#imputing-neocortex"><i class="fa fa-check"></i><b>14.2.1</b> Imputing <code>neocortex</code></a></li>
<li class="chapter" data-level="14.2.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#improving-the-imputation-model"><i class="fa fa-check"></i><b>14.2.2</b> Improving the imputation model</a></li>
<li class="chapter" data-level="14.2.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#bonus-mi-can-replace-me"><i class="fa fa-check"></i><b>14.2.3</b> Bonus: <code>mi()</code> can replace <code>me()</code></a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#summary-bonus-meta-analysis"><i class="fa fa-check"></i><b>14.3</b> <del>Summary</del> Bonus: Meta-analysis</a></li>
<li class="chapter" data-level="" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html"><i class="fa fa-check"></i><b>15</b> <del>Horoscopes</del> Insights</a>
<ul>
<li class="chapter" data-level="15.1" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#use-r-notebooks"><i class="fa fa-check"></i><b>15.1</b> Use R Notebooks</a></li>
<li class="chapter" data-level="15.2" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#save-your-model-fits"><i class="fa fa-check"></i><b>15.2</b> Save your model fits</a></li>
<li class="chapter" data-level="15.3" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#build-your-models-slowly"><i class="fa fa-check"></i><b>15.3</b> Build your models slowly</a></li>
<li class="chapter" data-level="15.4" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#look-at-your-data"><i class="fa fa-check"></i><b>15.4</b> Look at your data</a></li>
<li class="chapter" data-level="15.5" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#use-the-0-intercept-syntax"><i class="fa fa-check"></i><b>15.5</b> Use the <code>0 + Intercept</code> syntax</a></li>
<li class="chapter" data-level="15.6" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#annotate-your-workflow"><i class="fa fa-check"></i><b>15.6</b> Annotate your workflow</a></li>
<li class="chapter" data-level="15.7" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#annotate-your-code"><i class="fa fa-check"></i><b>15.7</b> Annotate your code</a></li>
<li class="chapter" data-level="15.8" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#break-up-your-workflow"><i class="fa fa-check"></i><b>15.8</b> Break up your workflow</a></li>
<li class="chapter" data-level="15.9" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#code-in-public"><i class="fa fa-check"></i><b>15.9</b> Code in public</a></li>
<li class="chapter" data-level="15.10" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#read-gelmans-blog"><i class="fa fa-check"></i><b>15.10</b> Read Gelman’s blog</a></li>
<li class="chapter" data-level="15.11" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#check-out-other-social-media-too"><i class="fa fa-check"></i><b>15.11</b> Check out other social media, too</a></li>
<li class="chapter" data-level="15.12" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#parting-wisdom"><i class="fa fa-check"></i><b>15.12</b> Parting wisdom</a></li>
<li class="chapter" data-level="" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Statistical rethinking</em> with brms, ggplot2, and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="small-worlds-and-large-worlds" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Small Worlds and Large Worlds<a href="small-worlds-and-large-worlds.html#small-worlds-and-large-worlds" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A while back The Oatmeal put together an <a href="https://theoatmeal.com/comics/columbus_day">infographic on Christopher Columbus</a>. I’m no historian and cannot vouch for its accuracy, so make of it what you will.</p>
<p>McElreath described the thrust of this chapter this way:</p>
<blockquote>
<p>In this chapter, you will begin to build Bayesian models. The way that Bayesian models learn from evidence is arguably optimal in the small world. When their assumptions approximate reality, they also perform well in the large world. But large world performance has to be demonstrated rather than logically deduced. <span class="citation">(<a href="#ref-mcelreathStatisticalRethinkingBayesian2015" role="doc-biblioref">McElreath, 2015, p. 20</a>)</span></p>
</blockquote>
<p>Indeed.</p>
<div id="the-garden-of-forking-data" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> The garden of forking data<a href="small-worlds-and-large-worlds.html#the-garden-of-forking-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Gelman and Loken <span class="citation">(<a href="#ref-gelmanGardenForkingPaths2013" role="doc-biblioref">2013</a>)</span> wrote a <a href="https://stat.columbia.edu/~gelman/research/unpublished/p_hacking.pdf">great paper of a similar name</a> and topic. The titles from this section and Gelman and Loken’s paper have their origins in the short story by <a href="https://en.wikipedia.org/wiki/Jorge_Luis_Borges">Jorge Luis Borges</a> <span class="citation">(<a href="#ref-borgesjlJardinSenderosQue1941" role="doc-biblioref">1941</a>)</span>, <em>The garden of forking paths</em>. You can find copies of the original short story <a href="https://archive.org/stream/TheGardenOfForkingPathsJorgeLuisBorges1941/The-Garden-of-Forking-Paths-Jorge-Luis-Borges-1941_djvu.txt">here</a> or <a href="https://genius.com/Jorge-luis-borges-the-garden-of-forking-paths-annotated">here</a>. Here’s a snip:</p>
<blockquote>
<p>In all fictional works, each time a man is confronted with several alternatives, he chooses one and eliminates the others; in the fiction of Ts’ui Pên, he chooses–simultaneously–all of them. He creates, in this way, diverse futures, diverse times which themselves also proliferate and fork.</p>
</blockquote>
<p>The choices we make in our data analyses proliferate and fork in this way, too.</p>
<div id="counting-possibilities." class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Counting possibilities.<a href="small-worlds-and-large-worlds.html#counting-possibilities." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Throughout this project, we’ll use the <a href="https://www.tidyverse.org">tidyverse</a> for data wrangling.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="small-worlds-and-large-worlds.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>If you are new to tidyverse-style syntax, possibly the oddest component is the pipe (i.e., <code>%&gt;%</code>). I’m not going to explain the <code>%&gt;%</code> in this project, but you might learn more about in <a href="https://youtu.be/9yjhxvu-pDg">this brief clip</a>, starting around <a href="https://youtu.be/K-ss_ag2k9E?t=1285">minute 21:25 in this talk by Wickham</a>, or in <a href="https://r4ds.had.co.nz/transform.html#combining-multiple-operations-with-the-pipe">Section 5.6.1 from Grolemund and Wickham’s <em>R for data science</em></a>. Really, all of Chapter 5 of <em>R4DS</em> is just great for new R and new tidyverse users. And <em>R4DS</em> Chapter 3 is a nice introduction to plotting with ggplot2.</p>
<p>Other than the pipe, the other big thing to be aware of is <a href="https://tibble.tidyverse.org">tibbles</a> <span class="citation">(<a href="#ref-R-tibble" role="doc-biblioref">Müller &amp; Wickham, 2022</a>)</span>. For our purposes, think of a tibble as a data object with two dimensions defined by rows and columns. And importantly, tibbles are just special types of <a href="https://bookdown.org/rdpeng/rprogdatascience/r-nuts-and-bolts.html#data-frames">data frames</a>. So whenever we talk about data frames, we’re also talking about tibbles. For more on the topic, check out <a href="https://r4ds.had.co.nz/tibbles.html"><em>R4SD</em>, Chapter 10</a>.</p>
<p>If we’re willing to code the marbles as 0 = “white” 1 = “blue”, we can arrange the possibility data in a tibble as follows.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="small-worlds-and-large-worlds.html#cb6-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb6-2"><a href="small-worlds-and-large-worlds.html#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">p1 =</span> <span class="dv">0</span>,</span>
<span id="cb6-3"><a href="small-worlds-and-large-worlds.html#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">p2 =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb6-4"><a href="small-worlds-and-large-worlds.html#cb6-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">p3 =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)),</span>
<span id="cb6-5"><a href="small-worlds-and-large-worlds.html#cb6-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">p4 =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)),</span>
<span id="cb6-6"><a href="small-worlds-and-large-worlds.html#cb6-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">p5 =</span> <span class="dv">1</span>)</span>
<span id="cb6-7"><a href="small-worlds-and-large-worlds.html#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="small-worlds-and-large-worlds.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 5
##      p1    p2    p3    p4    p5
##   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
## 1     0     1     1     1     1
## 2     0     0     1     1     1
## 3     0     0     0     1     1
## 4     0     0     0     0     1</code></pre>
<p>You might depict the possibility data in a plot.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="small-worlds-and-large-worlds.html#cb8-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="small-worlds-and-large-worlds.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="small-worlds-and-large-worlds.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">times =</span> <span class="dv">5</span>),</span>
<span id="cb8-4"><a href="small-worlds-and-large-worlds.html#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">possibility =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">each =</span> <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="small-worlds-and-large-worlds.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-6"><a href="small-worlds-and-large-worlds.html#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> possibility, </span>
<span id="cb8-7"><a href="small-worlds-and-large-worlds.html#cb8-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> value <span class="sc">%&gt;%</span> <span class="fu">as.character</span>())) <span class="sc">+</span></span>
<span id="cb8-8"><a href="small-worlds-and-large-worlds.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="small-worlds-and-large-worlds.html#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;navy&quot;</span>)) <span class="sc">+</span></span>
<span id="cb8-10"><a href="small-worlds-and-large-worlds.html#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="small-worlds-and-large-worlds.html#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(.<span class="dv">75</span>, <span class="fl">4.25</span>),</span>
<span id="cb8-12"><a href="small-worlds-and-large-worlds.html#cb8-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(.<span class="dv">75</span>, <span class="fl">5.25</span>)) <span class="sc">+</span></span>
<span id="cb8-13"><a href="small-worlds-and-large-worlds.html#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-4-1.png" width="120" /></p>
<p>As a quick aside, check out Suzan Baert’s blog post <a href="https://suzan.rbind.io/2018/02/dplyr-tutorial-2/"><em>Data wrangling part 2: Transforming your columns into the right shape</em></a> for an extensive discussion on <code>dplyr::mutate()</code> and <code>dplyr::gather()</code>.</p>
<p>Here’s the basic structure of the possibilities per marble draw.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="small-worlds-and-large-worlds.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">draw    =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb9-2"><a href="small-worlds-and-large-worlds.html#cb9-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">marbles =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="small-worlds-and-large-worlds.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">possibilities =</span> marbles <span class="sc">^</span> draw) <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="small-worlds-and-large-worlds.html#cb9-4" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">draw</th>
<th align="right">marbles</th>
<th align="right">possibilities</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">64</td>
</tr>
</tbody>
</table>
<p>If you walk that out a little, you can structure the data required to approach Figure 2.2.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="small-worlds-and-large-worlds.html#cb10-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb10-2"><a href="small-worlds-and-large-worlds.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span></span>
<span id="cb10-3"><a href="small-worlds-and-large-worlds.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">position =</span> <span class="fu">c</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">1</span>) <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">0</span>, </span>
<span id="cb10-4"><a href="small-worlds-and-large-worlds.html#cb10-4" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">1</span>, </span>
<span id="cb10-5"><a href="small-worlds-and-large-worlds.html#cb10-5" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">3</span>) <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb10-6"><a href="small-worlds-and-large-worlds.html#cb10-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">draw     =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>, <span class="dv">4</span><span class="sc">^</span><span class="dv">3</span>)),</span>
<span id="cb10-7"><a href="small-worlds-and-large-worlds.html#cb10-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill     =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;w&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-8"><a href="small-worlds-and-large-worlds.html#cb10-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rep</span>(., <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">^</span><span class="dv">0</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">1</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb10-9"><a href="small-worlds-and-large-worlds.html#cb10-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 84 × 3
##    position  draw fill 
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;
##  1     1        1 b    
##  2     2        1 w    
##  3     3        1 w    
##  4     4        1 w    
##  5     0.25     2 b    
##  6     0.5      2 w    
##  7     0.75     2 w    
##  8     1        2 w    
##  9     1.25     2 b    
## 10     1.5      2 w    
## # … with 74 more rows</code></pre>
<p>See what I did there with the parentheses? If you assign a value to an object in R (e.g., <code>dog &lt;- 1</code>) and just hit return, nothing will immediately pop up in the <a href="https://r4ds.had.co.nz/introduction.html#prerequisites">console</a>. You have to actually execute <code>dog</code> before R will return <code>1</code>. But if you wrap the code within parentheses (e.g., <code>(dog &lt;- 1)</code>), R will perform the assignment and return the value as if you had executed <code>dog</code>.</p>
<p>But we digress. Here’s the initial plot.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="small-worlds-and-large-worlds.html#cb12-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="small-worlds-and-large-worlds.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> draw)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="small-worlds-and-large-worlds.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> fill),</span>
<span id="cb12-4"><a href="small-worlds-and-large-worlds.html#cb12-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="small-worlds-and-large-worlds.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="small-worlds-and-large-worlds.html#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values  =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb12-7"><a href="small-worlds-and-large-worlds.html#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb12-8"><a href="small-worlds-and-large-worlds.html#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
<p>To my mind, the easiest way to connect the dots in the appropriate way is to make two auxiliary tibbles.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="small-worlds-and-large-worlds.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># these will connect the dots from the first and second draws</span></span>
<span id="cb13-2"><a href="small-worlds-and-large-worlds.html#cb13-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb13-3"><a href="small-worlds-and-large-worlds.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  lines_1 <span class="ot">&lt;-</span></span>
<span id="cb13-4"><a href="small-worlds-and-large-worlds.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">rep</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb13-5"><a href="small-worlds-and-large-worlds.html#cb13-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> ((<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">4</span>),</span>
<span id="cb13-6"><a href="small-worlds-and-large-worlds.html#cb13-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">1</span>,</span>
<span id="cb13-7"><a href="small-worlds-and-large-worlds.html#cb13-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="dv">2</span>)</span>
<span id="cb13-8"><a href="small-worlds-and-large-worlds.html#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 16 × 4
##        x  xend     y  yend
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1  0.25     1     2
##  2     1  0.5      1     2
##  3     1  0.75     1     2
##  4     1  1        1     2
##  5     2  1.25     1     2
##  6     2  1.5      1     2
##  7     2  1.75     1     2
##  8     2  2        1     2
##  9     3  2.25     1     2
## 10     3  2.5      1     2
## 11     3  2.75     1     2
## 12     3  3        1     2
## 13     4  3.25     1     2
## 14     4  3.5      1     2
## 15     4  3.75     1     2
## 16     4  4        1     2</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="small-worlds-and-large-worlds.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># these will connect the dots from the second and third draws</span></span>
<span id="cb15-2"><a href="small-worlds-and-large-worlds.html#cb15-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb15-3"><a href="small-worlds-and-large-worlds.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  lines_2 <span class="ot">&lt;-</span></span>
<span id="cb15-4"><a href="small-worlds-and-large-worlds.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">rep</span>(((<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">4</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb15-5"><a href="small-worlds-and-large-worlds.html#cb15-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">3</span>) <span class="sc">/</span> (<span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb15-6"><a href="small-worlds-and-large-worlds.html#cb15-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">2</span>,</span>
<span id="cb15-7"><a href="small-worlds-and-large-worlds.html#cb15-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="dv">3</span>)</span>
<span id="cb15-8"><a href="small-worlds-and-large-worlds.html#cb15-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 64 × 4
##        x   xend     y  yend
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  0.25 0.0625     2     3
##  2  0.25 0.125      2     3
##  3  0.25 0.188      2     3
##  4  0.25 0.25       2     3
##  5  0.5  0.312      2     3
##  6  0.5  0.375      2     3
##  7  0.5  0.438      2     3
##  8  0.5  0.5        2     3
##  9  0.75 0.562      2     3
## 10  0.75 0.625      2     3
## # … with 54 more rows</code></pre>
<p>We can use the <code>lines_1</code> and <code>lines_2</code> data in the plot with two <code>geom_segment()</code> functions.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="small-worlds-and-large-worlds.html#cb17-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="small-worlds-and-large-worlds.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> draw)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="small-worlds-and-large-worlds.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> lines_1,</span>
<span id="cb17-4"><a href="small-worlds-and-large-worlds.html#cb17-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb17-5"><a href="small-worlds-and-large-worlds.html#cb17-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y, <span class="at">yend =</span> yend),</span>
<span id="cb17-6"><a href="small-worlds-and-large-worlds.html#cb17-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="small-worlds-and-large-worlds.html#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> lines_2,</span>
<span id="cb17-8"><a href="small-worlds-and-large-worlds.html#cb17-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb17-9"><a href="small-worlds-and-large-worlds.html#cb17-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y, <span class="at">yend =</span> yend),</span>
<span id="cb17-10"><a href="small-worlds-and-large-worlds.html#cb17-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="small-worlds-and-large-worlds.html#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> fill),</span>
<span id="cb17-12"><a href="small-worlds-and-large-worlds.html#cb17-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-13"><a href="small-worlds-and-large-worlds.html#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="small-worlds-and-large-worlds.html#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb17-15"><a href="small-worlds-and-large-worlds.html#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb17-16"><a href="small-worlds-and-large-worlds.html#cb17-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
<p>We’ve generated the values for <code>position</code> (i.e., the <span class="math inline">\(x\)</span>-axis), in such a way that they’re all justified to the right, so to speak. But we’d like to center them. For <code>draw == 1</code>, we’ll need to subtract 0.5 from each. For <code>draw == 2</code>, we need to reduce the scale by a factor of 4 and we’ll then need to reduce the scale by another factor of 4 for <code>draw == 3</code>. The <code>ifelse()</code> function will be of use for that.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="small-worlds-and-large-worlds.html#cb18-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb18-2"><a href="small-worlds-and-large-worlds.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="small-worlds-and-large-worlds.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">denominator =</span> <span class="fu">ifelse</span>(draw <span class="sc">==</span> <span class="dv">1</span>, .<span class="dv">5</span>,</span>
<span id="cb18-4"><a href="small-worlds-and-large-worlds.html#cb18-4" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(draw <span class="sc">==</span> <span class="dv">2</span>, .<span class="dv">5</span> <span class="sc">/</span> <span class="dv">4</span>,</span>
<span id="cb18-5"><a href="small-worlds-and-large-worlds.html#cb18-5" aria-hidden="true" tabindex="-1"></a>                                     .<span class="dv">5</span> <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb18-6"><a href="small-worlds-and-large-worlds.html#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">position =</span> position <span class="sc">-</span> denominator)</span>
<span id="cb18-7"><a href="small-worlds-and-large-worlds.html#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="small-worlds-and-large-worlds.html#cb18-8" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 84 × 4
##    position  draw fill  denominator
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1    0.5       1 b           0.5  
##  2    1.5       1 w           0.5  
##  3    2.5       1 w           0.5  
##  4    3.5       1 w           0.5  
##  5    0.125     2 b           0.125
##  6    0.375     2 w           0.125
##  7    0.625     2 w           0.125
##  8    0.875     2 w           0.125
##  9    1.12      2 b           0.125
## 10    1.38      2 w           0.125
## # … with 74 more rows</code></pre>
<p>We’ll follow the same logic for the <code>lines_1</code> and <code>lines_2</code> data.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="small-worlds-and-large-worlds.html#cb20-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb20-2"><a href="small-worlds-and-large-worlds.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  lines_1 <span class="ot">&lt;-</span></span>
<span id="cb20-3"><a href="small-worlds-and-large-worlds.html#cb20-3" aria-hidden="true" tabindex="-1"></a>  lines_1 <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="small-worlds-and-large-worlds.html#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x    =</span> x <span class="sc">-</span> .<span class="dv">5</span>,</span>
<span id="cb20-5"><a href="small-worlds-and-large-worlds.html#cb20-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> xend <span class="sc">-</span> .<span class="dv">5</span> <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">1</span>)</span>
<span id="cb20-6"><a href="small-worlds-and-large-worlds.html#cb20-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 16 × 4
##        x  xend     y  yend
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1   0.5 0.125     1     2
##  2   0.5 0.375     1     2
##  3   0.5 0.625     1     2
##  4   0.5 0.875     1     2
##  5   1.5 1.12      1     2
##  6   1.5 1.38      1     2
##  7   1.5 1.62      1     2
##  8   1.5 1.88      1     2
##  9   2.5 2.12      1     2
## 10   2.5 2.38      1     2
## 11   2.5 2.62      1     2
## 12   2.5 2.88      1     2
## 13   3.5 3.12      1     2
## 14   3.5 3.38      1     2
## 15   3.5 3.62      1     2
## 16   3.5 3.88      1     2</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="small-worlds-and-large-worlds.html#cb22-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb22-2"><a href="small-worlds-and-large-worlds.html#cb22-2" aria-hidden="true" tabindex="-1"></a>  lines_2 <span class="ot">&lt;-</span></span>
<span id="cb22-3"><a href="small-worlds-and-large-worlds.html#cb22-3" aria-hidden="true" tabindex="-1"></a>  lines_2 <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="small-worlds-and-large-worlds.html#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x    =</span> x <span class="sc">-</span> .<span class="dv">5</span> <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">1</span>,</span>
<span id="cb22-5"><a href="small-worlds-and-large-worlds.html#cb22-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> xend <span class="sc">-</span> .<span class="dv">5</span> <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb22-6"><a href="small-worlds-and-large-worlds.html#cb22-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 64 × 4
##        x   xend     y  yend
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 0.125 0.0312     2     3
##  2 0.125 0.0938     2     3
##  3 0.125 0.156      2     3
##  4 0.125 0.219      2     3
##  5 0.375 0.281      2     3
##  6 0.375 0.344      2     3
##  7 0.375 0.406      2     3
##  8 0.375 0.469      2     3
##  9 0.625 0.531      2     3
## 10 0.625 0.594      2     3
## # … with 54 more rows</code></pre>
<p>Now the plot’s looking closer.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="small-worlds-and-large-worlds.html#cb24-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="small-worlds-and-large-worlds.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> draw)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="small-worlds-and-large-worlds.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> lines_1,</span>
<span id="cb24-4"><a href="small-worlds-and-large-worlds.html#cb24-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb24-5"><a href="small-worlds-and-large-worlds.html#cb24-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y, <span class="at">yend =</span> yend),</span>
<span id="cb24-6"><a href="small-worlds-and-large-worlds.html#cb24-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-7"><a href="small-worlds-and-large-worlds.html#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> lines_2,</span>
<span id="cb24-8"><a href="small-worlds-and-large-worlds.html#cb24-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb24-9"><a href="small-worlds-and-large-worlds.html#cb24-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y, <span class="at">yend =</span> yend),</span>
<span id="cb24-10"><a href="small-worlds-and-large-worlds.html#cb24-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-11"><a href="small-worlds-and-large-worlds.html#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> fill),</span>
<span id="cb24-12"><a href="small-worlds-and-large-worlds.html#cb24-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-13"><a href="small-worlds-and-large-worlds.html#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-14"><a href="small-worlds-and-large-worlds.html#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb24-15"><a href="small-worlds-and-large-worlds.html#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb24-16"><a href="small-worlds-and-large-worlds.html#cb24-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-12-1.png" width="768" /></p>
<p>For the final step, we’ll use <code>coord_polar()</code> to change the <a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coordinate system</a>, giving the plot a mandala-like feel.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="small-worlds-and-large-worlds.html#cb25-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="small-worlds-and-large-worlds.html#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> draw)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="small-worlds-and-large-worlds.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> lines_1,</span>
<span id="cb25-4"><a href="small-worlds-and-large-worlds.html#cb25-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb25-5"><a href="small-worlds-and-large-worlds.html#cb25-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y, <span class="at">yend =</span> yend),</span>
<span id="cb25-6"><a href="small-worlds-and-large-worlds.html#cb25-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb25-7"><a href="small-worlds-and-large-worlds.html#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> lines_2,</span>
<span id="cb25-8"><a href="small-worlds-and-large-worlds.html#cb25-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb25-9"><a href="small-worlds-and-large-worlds.html#cb25-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y, <span class="at">yend =</span> yend),</span>
<span id="cb25-10"><a href="small-worlds-and-large-worlds.html#cb25-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb25-11"><a href="small-worlds-and-large-worlds.html#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> fill),</span>
<span id="cb25-12"><a href="small-worlds-and-large-worlds.html#cb25-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="small-worlds-and-large-worlds.html#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb25-14"><a href="small-worlds-and-large-worlds.html#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb25-15"><a href="small-worlds-and-large-worlds.html#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="dv">3</span>), <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb25-16"><a href="small-worlds-and-large-worlds.html#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>() <span class="sc">+</span></span>
<span id="cb25-17"><a href="small-worlds-and-large-worlds.html#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb25-18"><a href="small-worlds-and-large-worlds.html#cb25-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-13-1.png" width="384" /></p>
<p>To make our version of Figure 2.3, we’ll have to add an index to tell us which paths remain logically valid after each choice. We’ll call the index <code>remain</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="small-worlds-and-large-worlds.html#cb26-1" aria-hidden="true" tabindex="-1"></a>lines_1 <span class="ot">&lt;-</span></span>
<span id="cb26-2"><a href="small-worlds-and-large-worlds.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  lines_1 <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="small-worlds-and-large-worlds.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">remain =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb26-4"><a href="small-worlds-and-large-worlds.html#cb26-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">3</span>)))</span>
<span id="cb26-5"><a href="small-worlds-and-large-worlds.html#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="small-worlds-and-large-worlds.html#cb26-6" aria-hidden="true" tabindex="-1"></a>lines_2 <span class="ot">&lt;-</span></span>
<span id="cb26-7"><a href="small-worlds-and-large-worlds.html#cb26-7" aria-hidden="true" tabindex="-1"></a>  lines_2 <span class="sc">%&gt;%</span> </span>
<span id="cb26-8"><a href="small-worlds-and-large-worlds.html#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">remain =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb26-9"><a href="small-worlds-and-large-worlds.html#cb26-9" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-10"><a href="small-worlds-and-large-worlds.html#cb26-10" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb26-11"><a href="small-worlds-and-large-worlds.html#cb26-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">12</span> <span class="sc">*</span> <span class="dv">4</span>)))</span>
<span id="cb26-12"><a href="small-worlds-and-large-worlds.html#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="small-worlds-and-large-worlds.html#cb26-13" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb26-14"><a href="small-worlds-and-large-worlds.html#cb26-14" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb26-15"><a href="small-worlds-and-large-worlds.html#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">remain =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb26-16"><a href="small-worlds-and-large-worlds.html#cb26-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb26-17"><a href="small-worlds-and-large-worlds.html#cb26-17" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">4</span>),</span>
<span id="cb26-18"><a href="small-worlds-and-large-worlds.html#cb26-18" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-19"><a href="small-worlds-and-large-worlds.html#cb26-19" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb26-20"><a href="small-worlds-and-large-worlds.html#cb26-20" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">12</span> <span class="sc">*</span> <span class="dv">4</span>))) </span>
<span id="cb26-21"><a href="small-worlds-and-large-worlds.html#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="small-worlds-and-large-worlds.html#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co"># finally, the plot:</span></span>
<span id="cb26-23"><a href="small-worlds-and-large-worlds.html#cb26-23" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb26-24"><a href="small-worlds-and-large-worlds.html#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> draw)) <span class="sc">+</span></span>
<span id="cb26-25"><a href="small-worlds-and-large-worlds.html#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> lines_1,</span>
<span id="cb26-26"><a href="small-worlds-and-large-worlds.html#cb26-26" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb26-27"><a href="small-worlds-and-large-worlds.html#cb26-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y, <span class="at">yend =</span> yend,</span>
<span id="cb26-28"><a href="small-worlds-and-large-worlds.html#cb26-28" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha =</span> remain <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()),</span>
<span id="cb26-29"><a href="small-worlds-and-large-worlds.html#cb26-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb26-30"><a href="small-worlds-and-large-worlds.html#cb26-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> lines_2,</span>
<span id="cb26-31"><a href="small-worlds-and-large-worlds.html#cb26-31" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb26-32"><a href="small-worlds-and-large-worlds.html#cb26-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y, <span class="at">yend =</span> yend,</span>
<span id="cb26-33"><a href="small-worlds-and-large-worlds.html#cb26-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha =</span> remain <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()),</span>
<span id="cb26-34"><a href="small-worlds-and-large-worlds.html#cb26-34" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb26-35"><a href="small-worlds-and-large-worlds.html#cb26-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> fill, <span class="at">alpha =</span> remain <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()),</span>
<span id="cb26-36"><a href="small-worlds-and-large-worlds.html#cb26-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb26-37"><a href="small-worlds-and-large-worlds.html#cb26-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># it&#39;s the alpha parameter that makes elements semitransparent</span></span>
<span id="cb26-38"><a href="small-worlds-and-large-worlds.html#cb26-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-39"><a href="small-worlds-and-large-worlds.html#cb26-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb26-40"><a href="small-worlds-and-large-worlds.html#cb26-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb26-41"><a href="small-worlds-and-large-worlds.html#cb26-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="dv">3</span>), <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb26-42"><a href="small-worlds-and-large-worlds.html#cb26-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>() <span class="sc">+</span></span>
<span id="cb26-43"><a href="small-worlds-and-large-worlds.html#cb26-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb26-44"><a href="small-worlds-and-large-worlds.html#cb26-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-14-1.png" width="384" /></p>
<p>Letting “w” = a white dot and “b” = a blue dot, we might recreate the table in the middle of page 23 like so.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="small-worlds-and-large-worlds.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if we make two custom functions, here, it will simplify the code within `mutate()`, below</span></span>
<span id="cb27-2"><a href="small-worlds-and-large-worlds.html#cb27-2" aria-hidden="true" tabindex="-1"></a>n_blue <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb27-3"><a href="small-worlds-and-large-worlds.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowSums</span>(x <span class="sc">==</span> <span class="st">&quot;b&quot;</span>)</span>
<span id="cb27-4"><a href="small-worlds-and-large-worlds.html#cb27-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-5"><a href="small-worlds-and-large-worlds.html#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="small-worlds-and-large-worlds.html#cb27-6" aria-hidden="true" tabindex="-1"></a>n_white <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb27-7"><a href="small-worlds-and-large-worlds.html#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowSums</span>(x <span class="sc">==</span> <span class="st">&quot;w&quot;</span>)</span>
<span id="cb27-8"><a href="small-worlds-and-large-worlds.html#cb27-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-9"><a href="small-worlds-and-large-worlds.html#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="small-worlds-and-large-worlds.html#cb27-10" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span></span>
<span id="cb27-11"><a href="small-worlds-and-large-worlds.html#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for the first four columns, `p_` indexes position</span></span>
<span id="cb27-12"><a href="small-worlds-and-large-worlds.html#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">p_1 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb27-13"><a href="small-worlds-and-large-worlds.html#cb27-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_2 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)),</span>
<span id="cb27-14"><a href="small-worlds-and-large-worlds.html#cb27-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_3 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)),</span>
<span id="cb27-15"><a href="small-worlds-and-large-worlds.html#cb27-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_4 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb27-16"><a href="small-worlds-and-large-worlds.html#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">draw 1: blue</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">n_blue</span>(.),</span>
<span id="cb27-17"><a href="small-worlds-and-large-worlds.html#cb27-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">draw 2: white</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n_white</span>(.),</span>
<span id="cb27-18"><a href="small-worlds-and-large-worlds.html#cb27-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">draw 3: blue</span><span class="st">`</span>  <span class="ot">=</span> <span class="fu">n_blue</span>(.)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-19"><a href="small-worlds-and-large-worlds.html#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">ways to produce</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">draw 1: blue</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">draw 2: white</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">draw 3: blue</span><span class="st">`</span>)</span>
<span id="cb27-20"><a href="small-worlds-and-large-worlds.html#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="small-worlds-and-large-worlds.html#cb27-21" aria-hidden="true" tabindex="-1"></a>t <span class="sc">%&gt;%</span> </span>
<span id="cb27-22"><a href="small-worlds-and-large-worlds.html#cb27-22" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<colgroup>
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="18%" />
<col width="19%" />
<col width="18%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">p_1</th>
<th align="left">p_2</th>
<th align="left">p_3</th>
<th align="left">p_4</th>
<th align="right">draw 1: blue</th>
<th align="right">draw 2: white</th>
<th align="right">draw 3: blue</th>
<th align="right">ways to produce</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>If you are new to making custom functions in R, you might check out <a href="https://r4ds.had.co.nz/functions.html">Chapter 19 in <em>R4DS</em></a> or <a href="https://bookdown.org/rdpeng/rprogdatascience/functions.html">Chapter 14 in <em>R programming for data science</em></a> <span class="citation">(<a href="#ref-pengProgrammingDataScience2022" role="doc-biblioref">Peng, 2022</a>)</span>.</p>
<p>We’ll need new data for Figure 2.4. Here’s the initial primary data, <code>d</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="small-worlds-and-large-worlds.html#cb28-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb28-2"><a href="small-worlds-and-large-worlds.html#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">position =</span> <span class="fu">c</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">1</span>) <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">0</span>, </span>
<span id="cb28-3"><a href="small-worlds-and-large-worlds.html#cb28-3" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">1</span>, </span>
<span id="cb28-4"><a href="small-worlds-and-large-worlds.html#cb28-4" aria-hidden="true" tabindex="-1"></a>                      (<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">3</span>) <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb28-5"><a href="small-worlds-and-large-worlds.html#cb28-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">draw     =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">^</span><span class="dv">1</span>, <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>, <span class="dv">4</span><span class="sc">^</span><span class="dv">3</span>)))</span>
<span id="cb28-6"><a href="small-worlds-and-large-worlds.html#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="small-worlds-and-large-worlds.html#cb28-7" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb28-8"><a href="small-worlds-and-large-worlds.html#cb28-8" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span></span>
<span id="cb28-9"><a href="small-worlds-and-large-worlds.html#cb28-9" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb28-10"><a href="small-worlds-and-large-worlds.html#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb28-11"><a href="small-worlds-and-large-worlds.html#cb28-11" aria-hidden="true" tabindex="-1"></a>    d, d</span>
<span id="cb28-12"><a href="small-worlds-and-large-worlds.html#cb28-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb28-13"><a href="small-worlds-and-large-worlds.html#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here are the fill colors</span></span>
<span id="cb28-14"><a href="small-worlds-and-large-worlds.html#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fill =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> <span class="fu">rep</span>(., <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">^</span><span class="dv">0</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">1</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb28-15"><a href="small-worlds-and-large-worlds.html#cb28-15" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">each  =</span> <span class="dv">2</span>)       <span class="sc">%&gt;%</span> <span class="fu">rep</span>(., <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">^</span><span class="dv">0</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">1</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb28-16"><a href="small-worlds-and-large-worlds.html#cb28-16" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> <span class="fu">rep</span>(., <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">^</span><span class="dv">0</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">1</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb28-17"><a href="small-worlds-and-large-worlds.html#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now we need to shift the positions over in accordance with draw, like before</span></span>
<span id="cb28-18"><a href="small-worlds-and-large-worlds.html#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">denominator =</span> <span class="fu">ifelse</span>(draw <span class="sc">==</span> <span class="dv">1</span>, .<span class="dv">5</span>,</span>
<span id="cb28-19"><a href="small-worlds-and-large-worlds.html#cb28-19" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(draw <span class="sc">==</span> <span class="dv">2</span>, .<span class="dv">5</span> <span class="sc">/</span> <span class="dv">4</span>,</span>
<span id="cb28-20"><a href="small-worlds-and-large-worlds.html#cb28-20" aria-hidden="true" tabindex="-1"></a>                                     .<span class="dv">5</span> <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb28-21"><a href="small-worlds-and-large-worlds.html#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">position =</span> position <span class="sc">-</span> denominator) <span class="sc">%&gt;%</span> </span>
<span id="cb28-22"><a href="small-worlds-and-large-worlds.html#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span></span>
<span id="cb28-23"><a href="small-worlds-and-large-worlds.html#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pie_index =</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">each =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-24"><a href="small-worlds-and-large-worlds.html#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># to get the position axis correct for pie_index == &quot;b&quot; or &quot;c&quot;, we&#39;ll need to offset</span></span>
<span id="cb28-25"><a href="small-worlds-and-large-worlds.html#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">position =</span> <span class="fu">ifelse</span>(pie_index <span class="sc">==</span> <span class="st">&quot;a&quot;</span>, position,</span>
<span id="cb28-26"><a href="small-worlds-and-large-worlds.html#cb28-26" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">ifelse</span>(pie_index <span class="sc">==</span> <span class="st">&quot;b&quot;</span>, position <span class="sc">+</span> <span class="dv">4</span>,</span>
<span id="cb28-27"><a href="small-worlds-and-large-worlds.html#cb28-27" aria-hidden="true" tabindex="-1"></a>                                  position <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>)))</span>
<span id="cb28-28"><a href="small-worlds-and-large-worlds.html#cb28-28" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 252 × 5
##    position  draw fill  denominator pie_index
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    
##  1    0.5       1 w           0.5   a        
##  2    1.5       1 b           0.5   a        
##  3    2.5       1 b           0.5   a        
##  4    3.5       1 b           0.5   a        
##  5    0.125     2 w           0.125 a        
##  6    0.375     2 b           0.125 a        
##  7    0.625     2 b           0.125 a        
##  8    0.875     2 b           0.125 a        
##  9    1.12      2 w           0.125 a        
## 10    1.38      2 b           0.125 a        
## # … with 242 more rows</code></pre>
<p>Both <code>lines_1</code> and <code>lines_2</code> require adjustments for <code>x</code> and <code>xend</code>. Our current approach is a nested <code>ifelse()</code>. Rather than copy and paste that multi-line <code>ifelse()</code> code for all four, let’s wrap it in a compact function, which we’ll call <code>move_over()</code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="small-worlds-and-large-worlds.html#cb30-1" aria-hidden="true" tabindex="-1"></a>move_over <span class="ot">&lt;-</span> <span class="cf">function</span>(position, index) {</span>
<span id="cb30-2"><a href="small-worlds-and-large-worlds.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(index <span class="sc">==</span> <span class="st">&quot;a&quot;</span>, position,</span>
<span id="cb30-3"><a href="small-worlds-and-large-worlds.html#cb30-3" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ifelse</span>(index <span class="sc">==</span> <span class="st">&quot;b&quot;</span>, position <span class="sc">+</span> <span class="dv">4</span>,</span>
<span id="cb30-4"><a href="small-worlds-and-large-worlds.html#cb30-4" aria-hidden="true" tabindex="-1"></a>                position <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb30-5"><a href="small-worlds-and-large-worlds.html#cb30-5" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb30-6"><a href="small-worlds-and-large-worlds.html#cb30-6" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<p>Now we’ll make our new <code>lines_1</code> and <code>lines_2</code> data, for which we’ll use <code>move_over()</code> to adjust their <code>x</code> and <code>xend</code> positions to the correct spots.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="small-worlds-and-large-worlds.html#cb31-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb31-2"><a href="small-worlds-and-large-worlds.html#cb31-2" aria-hidden="true" tabindex="-1"></a>  lines_1 <span class="ot">&lt;-</span></span>
<span id="cb31-3"><a href="small-worlds-and-large-worlds.html#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">rep</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">each =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb31-4"><a href="small-worlds-and-large-worlds.html#cb31-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> ((<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">4</span>)        <span class="sc">%&gt;%</span> <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb31-5"><a href="small-worlds-and-large-worlds.html#cb31-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">1</span>,</span>
<span id="cb31-6"><a href="small-worlds-and-large-worlds.html#cb31-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-7"><a href="small-worlds-and-large-worlds.html#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x    =</span> x <span class="sc">-</span> .<span class="dv">5</span>,</span>
<span id="cb31-8"><a href="small-worlds-and-large-worlds.html#cb31-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> xend <span class="sc">-</span> .<span class="dv">5</span> <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-9"><a href="small-worlds-and-large-worlds.html#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span></span>
<span id="cb31-10"><a href="small-worlds-and-large-worlds.html#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pie_index =</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">each =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-11"><a href="small-worlds-and-large-worlds.html#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># to get the position axis correct for `pie_index == &quot;b&quot;` or `&quot;c&quot;`, we&#39;ll need to offset</span></span>
<span id="cb31-12"><a href="small-worlds-and-large-worlds.html#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x    =</span> <span class="fu">move_over</span>(<span class="at">position =</span> x,    <span class="at">index =</span> pie_index),</span>
<span id="cb31-13"><a href="small-worlds-and-large-worlds.html#cb31-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">move_over</span>(<span class="at">position =</span> xend, <span class="at">index =</span> pie_index))</span>
<span id="cb31-14"><a href="small-worlds-and-large-worlds.html#cb31-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 48 × 5
##        x  xend     y  yend pie_index
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    
##  1   0.5 0.125     1     2 a        
##  2   0.5 0.375     1     2 a        
##  3   0.5 0.625     1     2 a        
##  4   0.5 0.875     1     2 a        
##  5   1.5 1.12      1     2 a        
##  6   1.5 1.38      1     2 a        
##  7   1.5 1.62      1     2 a        
##  8   1.5 1.88      1     2 a        
##  9   2.5 2.12      1     2 a        
## 10   2.5 2.38      1     2 a        
## # … with 38 more rows</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="small-worlds-and-large-worlds.html#cb33-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb33-2"><a href="small-worlds-and-large-worlds.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  lines_2 <span class="ot">&lt;-</span></span>
<span id="cb33-3"><a href="small-worlds-and-large-worlds.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x    =</span> <span class="fu">rep</span>(((<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">4</span>), <span class="at">each =</span> <span class="dv">4</span>)  <span class="sc">%&gt;%</span> <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb33-4"><a href="small-worlds-and-large-worlds.html#cb33-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">^</span><span class="dv">3</span> <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>)                 <span class="sc">%&gt;%</span> <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb33-5"><a href="small-worlds-and-large-worlds.html#cb33-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">2</span>,</span>
<span id="cb33-6"><a href="small-worlds-and-large-worlds.html#cb33-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">yend =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-7"><a href="small-worlds-and-large-worlds.html#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x    =</span> x <span class="sc">-</span> .<span class="dv">5</span> <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">1</span>,</span>
<span id="cb33-8"><a href="small-worlds-and-large-worlds.html#cb33-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> xend <span class="sc">-</span> .<span class="dv">5</span> <span class="sc">/</span> <span class="dv">4</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-9"><a href="small-worlds-and-large-worlds.html#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span></span>
<span id="cb33-10"><a href="small-worlds-and-large-worlds.html#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pie_index =</span> <span class="fu">rep</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">each =</span> <span class="fu">n</span>()<span class="sc">/</span><span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-11"><a href="small-worlds-and-large-worlds.html#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># to get the position axis correct for `pie_index == &quot;b&quot;` or `&quot;c&quot;`, we&#39;ll need to offset</span></span>
<span id="cb33-12"><a href="small-worlds-and-large-worlds.html#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x    =</span> <span class="fu">move_over</span>(<span class="at">position =</span> x,    <span class="at">index =</span> pie_index),</span>
<span id="cb33-13"><a href="small-worlds-and-large-worlds.html#cb33-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend =</span> <span class="fu">move_over</span>(<span class="at">position =</span> xend, <span class="at">index =</span> pie_index))</span>
<span id="cb33-14"><a href="small-worlds-and-large-worlds.html#cb33-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 192 × 5
##        x   xend     y  yend pie_index
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    
##  1 0.125 0.0312     2     3 a        
##  2 0.125 0.0938     2     3 a        
##  3 0.125 0.156      2     3 a        
##  4 0.125 0.219      2     3 a        
##  5 0.375 0.281      2     3 a        
##  6 0.375 0.344      2     3 a        
##  7 0.375 0.406      2     3 a        
##  8 0.375 0.469      2     3 a        
##  9 0.625 0.531      2     3 a        
## 10 0.625 0.594      2     3 a        
## # … with 182 more rows</code></pre>
<p>For the last data wrangling step, we add the <code>remain</code> indices to help us determine which parts to make semitransparent. I’m not sure of a slick way to do this, so these are the result of brute force counting.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="small-worlds-and-large-worlds.html#cb35-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> </span>
<span id="cb35-2"><a href="small-worlds-and-large-worlds.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="small-worlds-and-large-worlds.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">remain =</span> <span class="fu">c</span>(<span class="co"># `pie_index == &quot;a&quot;`</span></span>
<span id="cb35-4"><a href="small-worlds-and-large-worlds.html#cb35-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb35-5"><a href="small-worlds-and-large-worlds.html#cb35-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb35-6"><a href="small-worlds-and-large-worlds.html#cb35-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href="small-worlds-and-large-worlds.html#cb35-7" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb35-8"><a href="small-worlds-and-large-worlds.html#cb35-8" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">4</span>),</span>
<span id="cb35-9"><a href="small-worlds-and-large-worlds.html#cb35-9" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-10"><a href="small-worlds-and-large-worlds.html#cb35-10" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb35-11"><a href="small-worlds-and-large-worlds.html#cb35-11" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># `pie_index == &quot;b&quot;`</span></span>
<span id="cb35-12"><a href="small-worlds-and-large-worlds.html#cb35-12" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb35-13"><a href="small-worlds-and-large-worlds.html#cb35-13" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>),</span>
<span id="cb35-14"><a href="small-worlds-and-large-worlds.html#cb35-14" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">each =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-15"><a href="small-worlds-and-large-worlds.html#cb35-15" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb35-16"><a href="small-worlds-and-large-worlds.html#cb35-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>),</span>
<span id="cb35-17"><a href="small-worlds-and-large-worlds.html#cb35-17" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-18"><a href="small-worlds-and-large-worlds.html#cb35-18" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb35-19"><a href="small-worlds-and-large-worlds.html#cb35-19" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># `pie_index == &quot;c&quot;`</span></span>
<span id="cb35-20"><a href="small-worlds-and-large-worlds.html#cb35-20" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)),</span>
<span id="cb35-21"><a href="small-worlds-and-large-worlds.html#cb35-21" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">3</span>),</span>
<span id="cb35-22"><a href="small-worlds-and-large-worlds.html#cb35-22" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)), </span>
<span id="cb35-23"><a href="small-worlds-and-large-worlds.html#cb35-23" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">3</span>),</span>
<span id="cb35-24"><a href="small-worlds-and-large-worlds.html#cb35-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-25"><a href="small-worlds-and-large-worlds.html#cb35-25" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb35-26"><a href="small-worlds-and-large-worlds.html#cb35-26" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span>)</span>
<span id="cb35-27"><a href="small-worlds-and-large-worlds.html#cb35-27" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb35-28"><a href="small-worlds-and-large-worlds.html#cb35-28" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb35-29"><a href="small-worlds-and-large-worlds.html#cb35-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-30"><a href="small-worlds-and-large-worlds.html#cb35-30" aria-hidden="true" tabindex="-1"></a>lines_1 <span class="ot">&lt;-</span></span>
<span id="cb35-31"><a href="small-worlds-and-large-worlds.html#cb35-31" aria-hidden="true" tabindex="-1"></a>  lines_1 <span class="sc">%&gt;%</span> </span>
<span id="cb35-32"><a href="small-worlds-and-large-worlds.html#cb35-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">remain =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span>),</span>
<span id="cb35-33"><a href="small-worlds-and-large-worlds.html#cb35-33" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-34"><a href="small-worlds-and-large-worlds.html#cb35-34" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb35-35"><a href="small-worlds-and-large-worlds.html#cb35-35" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>),</span>
<span id="cb35-36"><a href="small-worlds-and-large-worlds.html#cb35-36" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">each  =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-37"><a href="small-worlds-and-large-worlds.html#cb35-37" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb35-38"><a href="small-worlds-and-large-worlds.html#cb35-38" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">3</span>),</span>
<span id="cb35-39"><a href="small-worlds-and-large-worlds.html#cb35-39" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">0</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb35-40"><a href="small-worlds-and-large-worlds.html#cb35-40" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb35-41"><a href="small-worlds-and-large-worlds.html#cb35-41" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb35-42"><a href="small-worlds-and-large-worlds.html#cb35-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-43"><a href="small-worlds-and-large-worlds.html#cb35-43" aria-hidden="true" tabindex="-1"></a>lines_2 <span class="ot">&lt;-</span></span>
<span id="cb35-44"><a href="small-worlds-and-large-worlds.html#cb35-44" aria-hidden="true" tabindex="-1"></a>  lines_2 <span class="sc">%&gt;%</span> </span>
<span id="cb35-45"><a href="small-worlds-and-large-worlds.html#cb35-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">remain =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">4</span>),</span>
<span id="cb35-46"><a href="small-worlds-and-large-worlds.html#cb35-46" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span> <span class="sc">*</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-47"><a href="small-worlds-and-large-worlds.html#cb35-47" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb35-48"><a href="small-worlds-and-large-worlds.html#cb35-48" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">8</span>),</span>
<span id="cb35-49"><a href="small-worlds-and-large-worlds.html#cb35-49" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-50"><a href="small-worlds-and-large-worlds.html#cb35-50" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb35-51"><a href="small-worlds-and-large-worlds.html#cb35-51" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">4</span> <span class="sc">*</span> <span class="dv">3</span>),</span>
<span id="cb35-52"><a href="small-worlds-and-large-worlds.html#cb35-52" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb35-53"><a href="small-worlds-and-large-worlds.html#cb35-53" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">rep</span>(., <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb35-54"><a href="small-worlds-and-large-worlds.html#cb35-54" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">rep</span>(<span class="dv">0</span>,   <span class="at">times =</span> <span class="dv">4</span>)</span>
<span id="cb35-55"><a href="small-worlds-and-large-worlds.html#cb35-55" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb35-56"><a href="small-worlds-and-large-worlds.html#cb35-56" aria-hidden="true" tabindex="-1"></a>         )</span></code></pre></div>
<p>We’re finally ready to plot our Figure 2.4!</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="small-worlds-and-large-worlds.html#cb36-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="small-worlds-and-large-worlds.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> draw)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="small-worlds-and-large-worlds.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">8</span>), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linewidth =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="small-worlds-and-large-worlds.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> lines_1,</span>
<span id="cb36-5"><a href="small-worlds-and-large-worlds.html#cb36-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb36-6"><a href="small-worlds-and-large-worlds.html#cb36-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y, <span class="at">yend =</span> yend,</span>
<span id="cb36-7"><a href="small-worlds-and-large-worlds.html#cb36-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha =</span> remain <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()),</span>
<span id="cb36-8"><a href="small-worlds-and-large-worlds.html#cb36-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb36-9"><a href="small-worlds-and-large-worlds.html#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> lines_2,</span>
<span id="cb36-10"><a href="small-worlds-and-large-worlds.html#cb36-10" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> xend,</span>
<span id="cb36-11"><a href="small-worlds-and-large-worlds.html#cb36-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> y, <span class="at">yend =</span> yend,</span>
<span id="cb36-12"><a href="small-worlds-and-large-worlds.html#cb36-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha =</span> remain <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()),</span>
<span id="cb36-13"><a href="small-worlds-and-large-worlds.html#cb36-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb36-14"><a href="small-worlds-and-large-worlds.html#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> fill, <span class="at">size =</span> draw, <span class="at">alpha =</span> remain <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()),</span>
<span id="cb36-15"><a href="small-worlds-and-large-worlds.html#cb36-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb36-16"><a href="small-worlds-and-large-worlds.html#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb36-17"><a href="small-worlds-and-large-worlds.html#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb36-18"><a href="small-worlds-and-large-worlds.html#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">1.5</span>)) <span class="sc">+</span></span>
<span id="cb36-19"><a href="small-worlds-and-large-worlds.html#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>),     <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb36-20"><a href="small-worlds-and-large-worlds.html#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">3.5</span>), <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb36-21"><a href="small-worlds-and-large-worlds.html#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>() <span class="sc">+</span></span>
<span id="cb36-22"><a href="small-worlds-and-large-worlds.html#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb36-23"><a href="small-worlds-and-large-worlds.html#cb36-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="using-prior-information." class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Using prior information.<a href="small-worlds-and-large-worlds.html#using-prior-information." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>We may have prior information about the relative plausibility of each conjecture. This prior information could arise from knowledge of how the contents of the bag were generated. It could also arise from previous data. Or we might want to act as if we had prior information, so we can build conservatism into the analysis. Whatever the source, it would help to have a way to use prior information. Luckily there is a natural solution: Just multiply the prior count by the new count. (p. 25)</p>
</blockquote>
<p>Here’s the table in the middle of page 25.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="small-worlds-and-large-worlds.html#cb37-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span></span>
<span id="cb37-2"><a href="small-worlds-and-large-worlds.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  t <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="small-worlds-and-large-worlds.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">previous counts</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">ways to produce</span><span class="st">`</span>,</span>
<span id="cb37-4"><a href="small-worlds-and-large-worlds.html#cb37-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">ways to produce</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">draw 1: blue</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-5"><a href="small-worlds-and-large-worlds.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_1<span class="sc">:</span>p_4, <span class="st">`</span><span class="at">ways to produce</span><span class="st">`</span>, <span class="st">`</span><span class="at">previous counts</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-6"><a href="small-worlds-and-large-worlds.html#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">new count</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">ways to produce</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">previous counts</span><span class="st">`</span>)</span>
<span id="cb37-7"><a href="small-worlds-and-large-worlds.html#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="small-worlds-and-large-worlds.html#cb37-8" aria-hidden="true" tabindex="-1"></a>t <span class="sc">%&gt;%</span> </span>
<span id="cb37-9"><a href="small-worlds-and-large-worlds.html#cb37-9" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">p_1</th>
<th align="left">p_2</th>
<th align="left">p_3</th>
<th align="left">p_4</th>
<th align="right">ways to produce</th>
<th align="right">previous counts</th>
<th align="right">new count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="right">3</td>
<td align="right">9</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>We might update to reproduce the table a the top of page 26, like this.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="small-worlds-and-large-worlds.html#cb38-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span></span>
<span id="cb38-2"><a href="small-worlds-and-large-worlds.html#cb38-2" aria-hidden="true" tabindex="-1"></a>  t <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="small-worlds-and-large-worlds.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_1<span class="sc">:</span>p_4, <span class="st">`</span><span class="at">new count</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="small-worlds-and-large-worlds.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">prior count</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">new count</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-5"><a href="small-worlds-and-large-worlds.html#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">factory count</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-6"><a href="small-worlds-and-large-worlds.html#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">new count</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">prior count</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">factory count</span><span class="st">`</span>)</span>
<span id="cb38-7"><a href="small-worlds-and-large-worlds.html#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="small-worlds-and-large-worlds.html#cb38-8" aria-hidden="true" tabindex="-1"></a>t <span class="sc">%&gt;%</span> </span>
<span id="cb38-9"><a href="small-worlds-and-large-worlds.html#cb38-9" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">p_1</th>
<th align="left">p_2</th>
<th align="left">p_3</th>
<th align="left">p_4</th>
<th align="right">prior count</th>
<th align="right">factory count</th>
<th align="right">new count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">16</td>
<td align="right">2</td>
<td align="right">32</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="right">27</td>
<td align="right">1</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>To learn more about <code>dplyr::select()</code> and <code>dplyr::rename()</code>, check out Baert’s exhaustive blog post <a href="https://suzan.rbind.io/2018/01/dplyr-tutorial-1/"><em>Data wrangling part 1: Basic to advanced ways to select columns</em></a>.</p>
</div>
<div id="from-counts-to-probability." class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> From counts to probability.<a href="small-worlds-and-large-worlds.html#from-counts-to-probability." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The opening sentences in this subsection are important: “It is helpful to think of this strategy as adhering to a principle of honest ignorance: <em>When we don’t know what caused the data, potential causes that may produce the data in more ways are more plausible</em>” (p. 26, <em>emphasis</em> in the original).</p>
<p>We can define our updated plausibility as:</p>
<center>
<p>plausibility of <img src="Pictures/theta_02.png" style="width:5.0%" /> after seeing <img src="Pictures/data_02.png" style="width:3.5%" /></p>
<p><span class="math inline">\(\propto\)</span></p>
<p>ways <img src="Pictures/theta_02.png" style="width:5.0%" /> can produce <img src="Pictures/data_02.png" style="width:3.5%" /></p>
<p><span class="math inline">\(\times\)</span></p>
<p>prior plausibility of <img src="Pictures/theta_02.png" style="width:5.0%" /></p>
</center>
<p>In other words:</p>
<p><span class="math display">\[
\text{plausibility of } p \text{ after } D_{\text{new}} \propto \text{ ways } p \text{ can produce } D_{\text{new}} \times \text{ prior plausibility of } p
\]</span></p>
<p>But since we have to standardize the results to get them into a probability metric, the full equation is:</p>
<p><span class="math display">\[
\text{plausibility of } p \text{ after } D_\text{new} = \frac{\text{ ways } p \text{ can produce } D_\text{new} \times \text{ prior plausibility of } p}{\text{sum of the products}}
\]</span></p>
<p>You might make the table in the middle of page 27 like this.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="small-worlds-and-large-worlds.html#cb39-1" aria-hidden="true" tabindex="-1"></a>t <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="small-worlds-and-large-worlds.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_1<span class="sc">:</span>p_4) <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="small-worlds-and-large-worlds.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p                      =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">25</span>),</span>
<span id="cb39-4"><a href="small-worlds-and-large-worlds.html#cb39-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">ways to produce data</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-5"><a href="small-worlds-and-large-worlds.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">plausibility =</span> <span class="st">`</span><span class="at">ways to produce data</span><span class="st">`</span> <span class="sc">/</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">ways to produce data</span><span class="st">`</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 7
##   p_1   p_2   p_3   p_4       p `ways to produce data` plausibility
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;                  &lt;dbl&gt;        &lt;dbl&gt;
## 1 w     w     w     w      0                         0         0   
## 2 b     w     w     w      0.25                      3         0.15
## 3 b     b     w     w      0.5                       8         0.4 
## 4 b     b     b     w      0.75                      9         0.45
## 5 b     b     b     b      1                         0         0</code></pre>
<p>We just computed the plausibilities, but here’s McElreath’s R code 2.1.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="small-worlds-and-large-worlds.html#cb41-1" aria-hidden="true" tabindex="-1"></a>ways <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">0</span>)</span>
<span id="cb41-2"><a href="small-worlds-and-large-worlds.html#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="small-worlds-and-large-worlds.html#cb41-3" aria-hidden="true" tabindex="-1"></a>ways <span class="sc">/</span> <span class="fu">sum</span>(ways)</span></code></pre></div>
<pre><code>## [1] 0.00 0.15 0.40 0.45 0.00</code></pre>
</div>
</div>
<div id="building-a-model" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Building a model<a href="small-worlds-and-large-worlds.html#building-a-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We might save our globe-tossing data in a tibble.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="small-worlds-and-large-worlds.html#cb43-1" aria-hidden="true" tabindex="-1"></a>(d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">toss =</span> <span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 9 × 1
##   toss 
##   &lt;chr&gt;
## 1 w    
## 2 l    
## 3 w    
## 4 w    
## 5 w    
## 6 l    
## 7 w    
## 8 l    
## 9 w</code></pre>
<div id="a-data-story." class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> A data story.<a href="small-worlds-and-large-worlds.html#a-data-story." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>Bayesian data analysis usually means producing a story for how the data came to be. This story may be <em>descriptive</em>, specifying associations that can be used to predict outcomes, given observations. Or it may be <em>causal</em>, a theory of how come events produce other events. Typically, any story you intend to be causal may also be descriptive. But many descriptive stories are hard to interpret causally. But all data stories are complete, in the sense that they are sufficient for specifying an algorithm for simulating new data. (p. 28, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="bayesian-updating." class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Bayesian updating.<a href="small-worlds-and-large-worlds.html#bayesian-updating." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we’ll add the cumulative number of trials, <code>n_trials</code>, and the cumulative number of successes, <code>n_successes</code> (i.e., <code>toss == "w"</code>), to the data.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="small-worlds-and-large-worlds.html#cb45-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb45-2"><a href="small-worlds-and-large-worlds.html#cb45-2" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span></span>
<span id="cb45-3"><a href="small-worlds-and-large-worlds.html#cb45-3" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="small-worlds-and-large-worlds.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_trials  =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb45-5"><a href="small-worlds-and-large-worlds.html#cb45-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">n_success =</span> <span class="fu">cumsum</span>(toss <span class="sc">==</span> <span class="st">&quot;w&quot;</span>))</span>
<span id="cb45-6"><a href="small-worlds-and-large-worlds.html#cb45-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 3
##   toss  n_trials n_success
##   &lt;chr&gt;    &lt;int&gt;     &lt;int&gt;
## 1 w            1         1
## 2 l            2         1
## 3 w            3         2
## 4 w            4         3
## 5 w            5         4
## 6 l            6         4
## 7 w            7         5
## 8 l            8         5
## 9 w            9         6</code></pre>
<p>Fair warning: We don’t learn the skills for making Figure 2.5 until later in the chapter. So consider the data wrangling steps in this section as something of a preview.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="small-worlds-and-large-worlds.html#cb47-1" aria-hidden="true" tabindex="-1"></a>sequence_length <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb47-2"><a href="small-worlds-and-large-worlds.html#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="small-worlds-and-large-worlds.html#cb47-3" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="small-worlds-and-large-worlds.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">p_water =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> sequence_length)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-5"><a href="small-worlds-and-large-worlds.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(p_water) <span class="sc">%&gt;%</span> </span>
<span id="cb47-6"><a href="small-worlds-and-large-worlds.html#cb47-6" aria-hidden="true" tabindex="-1"></a> <span class="co"># you can learn more about lagging here: https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/lag or here: https://dplyr.tidyverse.org/reference/lead-lag.html</span></span>
<span id="cb47-7"><a href="small-worlds-and-large-worlds.html#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lagged_n_trials  =</span> <span class="fu">lag</span>(n_trials,  <span class="at">k =</span> <span class="dv">1</span>),</span>
<span id="cb47-8"><a href="small-worlds-and-large-worlds.html#cb47-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">lagged_n_success =</span> <span class="fu">lag</span>(n_success, <span class="at">k =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-9"><a href="small-worlds-and-large-worlds.html#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb47-10"><a href="small-worlds-and-large-worlds.html#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior      =</span> <span class="fu">ifelse</span>(n_trials <span class="sc">==</span> <span class="dv">1</span>, .<span class="dv">5</span>,</span>
<span id="cb47-11"><a href="small-worlds-and-large-worlds.html#cb47-11" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">dbinom</span>(<span class="at">x    =</span> lagged_n_success, </span>
<span id="cb47-12"><a href="small-worlds-and-large-worlds.html#cb47-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> lagged_n_trials, </span>
<span id="cb47-13"><a href="small-worlds-and-large-worlds.html#cb47-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">prob =</span> p_water)),</span>
<span id="cb47-14"><a href="small-worlds-and-large-worlds.html#cb47-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">likelihood =</span> <span class="fu">dbinom</span>(<span class="at">x    =</span> n_success, </span>
<span id="cb47-15"><a href="small-worlds-and-large-worlds.html#cb47-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> n_trials, </span>
<span id="cb47-16"><a href="small-worlds-and-large-worlds.html#cb47-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">prob =</span> p_water),</span>
<span id="cb47-17"><a href="small-worlds-and-large-worlds.html#cb47-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">strip      =</span> <span class="fu">str_c</span>(<span class="st">&quot;n = &quot;</span>, n_trials)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-18"><a href="small-worlds-and-large-worlds.html#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the next three lines allow us to normalize the prior and the likelihood, </span></span>
<span id="cb47-19"><a href="small-worlds-and-large-worlds.html#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># putting them both in a probability metric </span></span>
<span id="cb47-20"><a href="small-worlds-and-large-worlds.html#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(n_trials) <span class="sc">%&gt;%</span> </span>
<span id="cb47-21"><a href="small-worlds-and-large-worlds.html#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior      =</span> prior      <span class="sc">/</span> <span class="fu">sum</span>(prior),</span>
<span id="cb47-22"><a href="small-worlds-and-large-worlds.html#cb47-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">likelihood =</span> likelihood <span class="sc">/</span> <span class="fu">sum</span>(likelihood)) <span class="sc">%&gt;%</span>   </span>
<span id="cb47-23"><a href="small-worlds-and-large-worlds.html#cb47-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-24"><a href="small-worlds-and-large-worlds.html#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb47-25"><a href="small-worlds-and-large-worlds.html#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_water)) <span class="sc">+</span></span>
<span id="cb47-26"><a href="small-worlds-and-large-worlds.html#cb47-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> prior), <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-27"><a href="small-worlds-and-large-worlds.html#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> likelihood)) <span class="sc">+</span></span>
<span id="cb47-28"><a href="small-worlds-and-large-worlds.html#cb47-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;proportion water&quot;</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb47-29"><a href="small-worlds-and-large-worlds.html#cb47-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;plausibility&quot;</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb47-30"><a href="small-worlds-and-large-worlds.html#cb47-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb47-31"><a href="small-worlds-and-large-worlds.html#cb47-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>strip, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-27-1.png" width="576" /></p>
<p>If it wasn’t clear in the code, the dashed curves are normalized prior densities. The solid ones are normalized likelihoods. If you don’t normalize (i.e., divide the density by the sum of the density), their respective heights don’t match up with those in the text. Furthermore, it’s the normalization that makes them directly comparable.</p>
<p>To learn more about <code>dplyr::group_by()</code> and its opposite <code>dplyr::ungroup()</code>, check out <a href="https://r4ds.had.co.nz/transform.html"><em>R4DS</em>, Chapter 5</a>. To learn about <code>tidyr::expand_grid()</code>, go <a href="https://tidyr.tidyverse.org/reference/expand_grid.html">here</a>.</p>
</div>
<div id="evaluate." class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Evaluate.<a href="small-worlds-and-large-worlds.html#evaluate." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>The Bayesian model learns in a way that is demonstrably optimal, provided that the real, large world is accurately described by the model. This is to say that your Bayesian machine guarantees perfect inference, within the small world. No other way of using the available information, and beginning with the same state of information, could do better.</p>
<p>Don’t get too excited about this logical virtue, however. The calculations may malfunction, so results always have to be checked. And if there are important differences between the model and reality, then there is no logical guarantee of large world performance. (p. 31)</p>
</blockquote>
<div id="rethinking-deflationary-statistics." class="section level4 hasAnchor" number="2.2.3.1">
<h4><span class="header-section-number">2.2.3.1</span> Rethinking: Deflationary statistics.<a href="small-worlds-and-large-worlds.html#rethinking-deflationary-statistics." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>It may be that Bayesian inference is the best general purpose method of inference known. However, Bayesian inference is much less powerful than we’d like it to be. There is no approach to inference that provides universal guarantees. No branch of applied mathematics has unfettered access to reality, because math is not discovered, like the proton. Instead it is invented, like the shovel. (p. 32)</p>
</blockquote>
</div>
</div>
</div>
<div id="components-of-the-model" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Components of the model<a href="small-worlds-and-large-worlds.html#components-of-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>a likelihood function: “the number of ways each conjecture could produce an observation”</li>
<li>one or more parameters: “the accumulated number of ways each conjecture cold produce the entire data”</li>
<li>a prior: “the initial plausibility of each conjectured cause of the data”</li>
</ol>
<div id="likelihood." class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Likelihood.<a href="small-worlds-and-large-worlds.html#likelihood." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you let the count of water be <span class="math inline">\(w\)</span> and the number of tosses be <span class="math inline">\(n\)</span>, then the binomial likelihood may be expressed as:</p>
<p><span class="math display">\[\Pr(w|n, p) = \frac{n!}{w!(n - w)!} p^w (1 - p)^{n - w}\]</span></p>
<p>Given a probability of .5, we can use the <code>dbinom()</code> function to determine the likelihood of 6 out of 9 tosses coming out water.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="small-worlds-and-large-worlds.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> .<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.1640625</code></pre>
<p>McElreath suggested we change the values of <code>prob</code>. Let’s do so over the parameter space, <span class="math inline">\([0, 1]\)</span>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="small-worlds-and-large-worlds.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">prob =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">01</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="small-worlds-and-large-worlds.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> prob,</span>
<span id="cb50-3"><a href="small-worlds-and-large-worlds.html#cb50-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> prob))) <span class="sc">+</span></span>
<span id="cb50-4"><a href="small-worlds-and-large-worlds.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb50-5"><a href="small-worlds-and-large-worlds.html#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;probability&quot;</span>,</span>
<span id="cb50-6"><a href="small-worlds-and-large-worlds.html#cb50-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;binomial likelihood&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="small-worlds-and-large-worlds.html#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-29-1.png" width="288" /></p>
</div>
<div id="parameters." class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Parameters.<a href="small-worlds-and-large-worlds.html#parameters." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>“For most likelihood functions, there are adjustable inputs” (p. 34). These are the <strong>parameters</strong>.</p>
<div id="rethinking-datum-or-parameter" class="section level4 hasAnchor" number="2.3.2.1">
<h4><span class="header-section-number">2.3.2.1</span> Rethinking: Datum or parameter?<a href="small-worlds-and-large-worlds.html#rethinking-datum-or-parameter" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>It is typical to conceive of data and parameters as completely different kinds of entities. Data are measures and known; parameters are unknown and must be estimated from data. Usefully, in the Bayesian framework the distinction between a datum and a parameter is fuzzy. (p. 34)</p>
</blockquote>
<p>For more in this topic, check out his lecture, <a href="https://youtu.be/yakg94HyWdE"><em>Understanding Bayesian statistics without frequentist language</em></a>.</p>
</div>
</div>
<div id="prior." class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Prior.<a href="small-worlds-and-large-worlds.html#prior." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>So where do priors come from? They are engineering assumptions, chosen to help the machine learn. The flat prior in Figure 2.5 is very common, but it is hardly ever the best prior. You’ll see later in the book that priors that gently nudge the machine usually improve inference. Such priors are sometimes called regularizing or weakly informative priors. (p. 35)</p>
</blockquote>
<p>To learn more about “regularizing or weakly informative priors,” check out the <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations"><em>Prior choice recommendations</em> wiki from the Stan team</a>.</p>
<div id="overthinking-prior-as-a-probability-distribution" class="section level4 hasAnchor" number="2.3.3.1">
<h4><span class="header-section-number">2.3.3.1</span> Overthinking: Prior as a probability distribution<a href="small-worlds-and-large-worlds.html#overthinking-prior-as-a-probability-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>McElreath said that “for a uniform prior from <span class="math inline">\(a\)</span> to <span class="math inline">\(b\)</span>, the probability of any point in the interval is <span class="math inline">\(1 / (b - a)\)</span>” (p. 35). Let’s try that out. To keep things simple, we’ll hold <span class="math inline">\(a\)</span> constant while varying the values for <span class="math inline">\(b\)</span>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="small-worlds-and-large-worlds.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">a =</span> <span class="dv">0</span>,</span>
<span id="cb51-2"><a href="small-worlds-and-large-worlds.html#cb51-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="small-worlds-and-large-worlds.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="dv">1</span> <span class="sc">/</span> (b <span class="sc">-</span> a))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##       a     b  prob
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0   1   1    
## 2     0   1.5 0.667
## 3     0   2   0.5  
## 4     0   3   0.333
## 5     0   9   0.111</code></pre>
<p>I like to verify things with plots.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="small-worlds-and-large-worlds.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">a =</span> <span class="dv">0</span>,</span>
<span id="cb53-2"><a href="small-worlds-and-large-worlds.html#cb53-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="small-worlds-and-large-worlds.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">parameter_space =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">9</span>, <span class="at">length.out =</span> <span class="dv">500</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="small-worlds-and-large-worlds.html#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">dunif</span>(parameter_space, a, b),</span>
<span id="cb53-5"><a href="small-worlds-and-large-worlds.html#cb53-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">b =</span> <span class="fu">str_c</span>(<span class="st">&quot;b = &quot;</span>, b)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-6"><a href="small-worlds-and-large-worlds.html#cb53-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-7"><a href="small-worlds-and-large-worlds.html#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> parameter_space, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> prob)) <span class="sc">+</span></span>
<span id="cb53-8"><a href="small-worlds-and-large-worlds.html#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>() <span class="sc">+</span></span>
<span id="cb53-9"><a href="small-worlds-and-large-worlds.html#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb53-10"><a href="small-worlds-and-large-worlds.html#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">9</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb53-11"><a href="small-worlds-and-large-worlds.html#cb53-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1/9&quot;</span>, <span class="st">&quot;1/3&quot;</span>, <span class="st">&quot;1/2&quot;</span>, <span class="st">&quot;2/3&quot;</span>, <span class="st">&quot;1&quot;</span>)) <span class="sc">+</span></span>
<span id="cb53-12"><a href="small-worlds-and-large-worlds.html#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-13"><a href="small-worlds-and-large-worlds.html#cb53-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-14"><a href="small-worlds-and-large-worlds.html#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>b, <span class="at">ncol =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-31-1.png" width="768" /></p>
<p>And as we’ll learn much later in the project, the <span class="math inline">\(\operatorname{Uniform}(0, 1)\)</span> distribution is special in that we can also express it as the beta distribution for which <span class="math inline">\(\alpha = 1\)</span> and <span class="math inline">\(\beta = 1\)</span>. E.g.,</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="small-worlds-and-large-worlds.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">parameter_space =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="small-worlds-and-large-worlds.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note our use of the `dbeta()` function</span></span>
<span id="cb54-3"><a href="small-worlds-and-large-worlds.html#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> <span class="fu">dbeta</span>(parameter_space, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="small-worlds-and-large-worlds.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-5"><a href="small-worlds-and-large-worlds.html#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> parameter_space, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> prob)) <span class="sc">+</span></span>
<span id="cb54-6"><a href="small-worlds-and-large-worlds.html#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>() <span class="sc">+</span></span>
<span id="cb54-7"><a href="small-worlds-and-large-worlds.html#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb54-8"><a href="small-worlds-and-large-worlds.html#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-32-1.png" width="240" /></p>
</div>
</div>
<div id="posterior." class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Posterior.<a href="small-worlds-and-large-worlds.html#posterior." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we continue to focus on the globe tossing example, the posterior probability a toss will be water may be expressed as</p>
<p><span class="math display">\[\Pr(p|w) = \frac{\Pr(w|p) \; \Pr(p)}{\Pr(w)}.\]</span></p>
<p>More generically and in words, this is</p>
<p><span class="math display">\[\text{Posterior} = \frac{\text{Likelihood} \times \text{Prior}}{\text{Average Likelihood}}.\]</span></p>
</div>
</div>
<div id="making-the-model-go" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Making the model go<a href="small-worlds-and-large-worlds.html#making-the-model-go" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here’s the data wrangling for Figure 2.6.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="small-worlds-and-large-worlds.html#cb55-1" aria-hidden="true" tabindex="-1"></a>sequence_length <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb55-2"><a href="small-worlds-and-large-worlds.html#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="small-worlds-and-large-worlds.html#cb55-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb55-4"><a href="small-worlds-and-large-worlds.html#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">probability =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> sequence_length)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-5"><a href="small-worlds-and-large-worlds.html#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">row =</span> <span class="fu">c</span>(<span class="st">&quot;flat&quot;</span>, <span class="st">&quot;stepped&quot;</span>, <span class="st">&quot;Laplace&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-6"><a href="small-worlds-and-large-worlds.html#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(row, probability) <span class="sc">%&gt;%</span> </span>
<span id="cb55-7"><a href="small-worlds-and-large-worlds.html#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior =</span> <span class="fu">ifelse</span>(row <span class="sc">==</span> <span class="st">&quot;flat&quot;</span>, <span class="dv">1</span>,</span>
<span id="cb55-8"><a href="small-worlds-and-large-worlds.html#cb55-8" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(row <span class="sc">==</span> <span class="st">&quot;stepped&quot;</span>, <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> sequence_length <span class="sc">/</span> <span class="dv">2</span>),</span>
<span id="cb55-9"><a href="small-worlds-and-large-worlds.html#cb55-9" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(probability <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">/</span> <span class="fl">0.25</span>) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fl">0.25</span>))),</span>
<span id="cb55-10"><a href="small-worlds-and-large-worlds.html#cb55-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">likelihood =</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> probability)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-11"><a href="small-worlds-and-large-worlds.html#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(row) <span class="sc">%&gt;%</span> </span>
<span id="cb55-12"><a href="small-worlds-and-large-worlds.html#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">posterior =</span> prior <span class="sc">*</span> likelihood <span class="sc">/</span> <span class="fu">sum</span>(prior <span class="sc">*</span> likelihood)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-13"><a href="small-worlds-and-large-worlds.html#cb55-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(key, value, <span class="sc">-</span>probability, <span class="sc">-</span>row) <span class="sc">%&gt;%</span> </span>
<span id="cb55-14"><a href="small-worlds-and-large-worlds.html#cb55-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb55-15"><a href="small-worlds-and-large-worlds.html#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">key =</span> <span class="fu">factor</span>(key, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;prior&quot;</span>, <span class="st">&quot;likelihood&quot;</span>, <span class="st">&quot;posterior&quot;</span>)),</span>
<span id="cb55-16"><a href="small-worlds-and-large-worlds.html#cb55-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">row =</span> <span class="fu">factor</span>(row, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;flat&quot;</span>, <span class="st">&quot;stepped&quot;</span>, <span class="st">&quot;Laplace&quot;</span>))) </span></code></pre></div>
<p>To learn more about <code>dplyr::arrange()</code>, check out <a href="https://r4ds.had.co.nz/transform.html#arrange-rows-with-arrange"><em>R4DS</em>, Chapter 5.3</a>.</p>
<p>In order to avoid unnecessary facet labels for the rows, it was easier to just make each column of the plot separately. We can then use the elegant and powerful syntax from <a href="https://twitter.com/thomasp85">Thomas Lin Pedersen</a>’s <span class="citation">(<a href="#ref-R-patchwork" role="doc-biblioref">2022</a>)</span> <a href="https://patchwork.data-imaginist.com/"><strong>patchwork</strong> package</a> to combine them.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="small-worlds-and-large-worlds.html#cb56-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb56-2"><a href="small-worlds-and-large-worlds.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="small-worlds-and-large-worlds.html#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(row <span class="sc">==</span> <span class="st">&quot;flat&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="small-worlds-and-large-worlds.html#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> probability, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb56-5"><a href="small-worlds-and-large-worlds.html#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb56-6"><a href="small-worlds-and-large-worlds.html#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="small-worlds-and-large-worlds.html#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="small-worlds-and-large-worlds.html#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb56-9"><a href="small-worlds-and-large-worlds.html#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb56-10"><a href="small-worlds-and-large-worlds.html#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="small-worlds-and-large-worlds.html#cb56-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb56-12"><a href="small-worlds-and-large-worlds.html#cb56-12" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb56-13"><a href="small-worlds-and-large-worlds.html#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(row <span class="sc">==</span> <span class="st">&quot;stepped&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-14"><a href="small-worlds-and-large-worlds.html#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> probability, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb56-15"><a href="small-worlds-and-large-worlds.html#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb56-16"><a href="small-worlds-and-large-worlds.html#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb56-17"><a href="small-worlds-and-large-worlds.html#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb56-18"><a href="small-worlds-and-large-worlds.html#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-19"><a href="small-worlds-and-large-worlds.html#cb56-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-20"><a href="small-worlds-and-large-worlds.html#cb56-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb56-21"><a href="small-worlds-and-large-worlds.html#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb56-22"><a href="small-worlds-and-large-worlds.html#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="small-worlds-and-large-worlds.html#cb56-23" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb56-24"><a href="small-worlds-and-large-worlds.html#cb56-24" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb56-25"><a href="small-worlds-and-large-worlds.html#cb56-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(row <span class="sc">==</span> <span class="st">&quot;Laplace&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-26"><a href="small-worlds-and-large-worlds.html#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> probability, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb56-27"><a href="small-worlds-and-large-worlds.html#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb56-28"><a href="small-worlds-and-large-worlds.html#cb56-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb56-29"><a href="small-worlds-and-large-worlds.html#cb56-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb56-30"><a href="small-worlds-and-large-worlds.html#cb56-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-31"><a href="small-worlds-and-large-worlds.html#cb56-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-32"><a href="small-worlds-and-large-worlds.html#cb56-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb56-33"><a href="small-worlds-and-large-worlds.html#cb56-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb56-34"><a href="small-worlds-and-large-worlds.html#cb56-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-35"><a href="small-worlds-and-large-worlds.html#cb56-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb56-36"><a href="small-worlds-and-large-worlds.html#cb56-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-37"><a href="small-worlds-and-large-worlds.html#cb56-37" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2 <span class="sc">/</span> p3</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-34-1.png" width="576" /></p>
<p>I’m not sure if it’s the same McElreath used in the text, but the formula I used for the triangle-shaped prior is the <a href="https://rdrr.io/cran/rmutil/man/Laplace.html">Laplace distribution</a> with a location of 0.5 and a dispersion of 0.25.</p>
<p>Also, to learn all about <code>dplyr::filter()</code>, check out Baert’s <a href="https://suzan.rbind.io/2018/02/dplyr-tutorial-3/"><em>Data wrangling part 3: Basic and more advanced ways to filter rows</em></a>.</p>
<div id="grid-approximation." class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Grid approximation.<a href="small-worlds-and-large-worlds.html#grid-approximation." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We just employed grid approximation over the last figure. In order to get nice smooth lines, we computed the posterior over 1,000 evenly-spaced points on the probability space. Here we’ll prepare for Figure 2.7 with 20.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="small-worlds-and-large-worlds.html#cb57-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb57-2"><a href="small-worlds-and-large-worlds.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span></span>
<span id="cb57-3"><a href="small-worlds-and-large-worlds.html#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">p_grid =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">20</span>),      <span class="co"># define grid</span></span>
<span id="cb57-4"><a href="small-worlds-and-large-worlds.html#cb57-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">prior  =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span>                                       <span class="co"># define prior</span></span>
<span id="cb57-5"><a href="small-worlds-and-large-worlds.html#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid)) <span class="sc">%&gt;%</span>  <span class="co"># compute likelihood at each value in grid</span></span>
<span id="cb57-6"><a href="small-worlds-and-large-worlds.html#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">unstd_posterior =</span> likelihood <span class="sc">*</span> prior) <span class="sc">%&gt;%</span>             <span class="co"># compute product of likelihood and prior</span></span>
<span id="cb57-7"><a href="small-worlds-and-large-worlds.html#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">posterior =</span> unstd_posterior <span class="sc">/</span> <span class="fu">sum</span>(unstd_posterior))   <span class="co"># standardize the posterior, so it sums to 1</span></span>
<span id="cb57-8"><a href="small-worlds-and-large-worlds.html#cb57-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 20 × 5
##    p_grid prior likelihood unstd_posterior   posterior
##     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;       &lt;dbl&gt;
##  1 0          1 0               0          0          
##  2 0.0526     1 0.00000152      0.00000152 0.000000799
##  3 0.105      1 0.0000819       0.0000819  0.0000431  
##  4 0.158      1 0.000777        0.000777   0.000409   
##  5 0.211      1 0.00360         0.00360    0.00189    
##  6 0.263      1 0.0112          0.0112     0.00587    
##  7 0.316      1 0.0267          0.0267     0.0140     
##  8 0.368      1 0.0529          0.0529     0.0279     
##  9 0.421      1 0.0908          0.0908     0.0478     
## 10 0.474      1 0.138           0.138      0.0728     
## 11 0.526      1 0.190           0.190      0.0999     
## 12 0.579      1 0.236           0.236      0.124      
## 13 0.632      1 0.267           0.267      0.140      
## 14 0.684      1 0.271           0.271      0.143      
## 15 0.737      1 0.245           0.245      0.129      
## 16 0.789      1 0.190           0.190      0.0999     
## 17 0.842      1 0.118           0.118      0.0621     
## 18 0.895      1 0.0503          0.0503     0.0265     
## 19 0.947      1 0.00885         0.00885    0.00466    
## 20 1          1 0               0          0</code></pre>
<p>Here’s the code for the right panel of Figure 2.7.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="small-worlds-and-large-worlds.html#cb59-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb59-2"><a href="small-worlds-and-large-worlds.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="small-worlds-and-large-worlds.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span></span>
<span id="cb59-4"><a href="small-worlds-and-large-worlds.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-5"><a href="small-worlds-and-large-worlds.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-6"><a href="small-worlds-and-large-worlds.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;20 points&quot;</span>,</span>
<span id="cb59-7"><a href="small-worlds-and-large-worlds.html#cb59-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;probability of water&quot;</span>,</span>
<span id="cb59-8"><a href="small-worlds-and-large-worlds.html#cb59-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;posterior probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb59-9"><a href="small-worlds-and-large-worlds.html#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p>Now here’s the code for the left hand panel of Figure 2.7.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="small-worlds-and-large-worlds.html#cb60-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb60-2"><a href="small-worlds-and-large-worlds.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">p_grid =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">5</span>),</span>
<span id="cb60-3"><a href="small-worlds-and-large-worlds.html#cb60-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior  =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="small-worlds-and-large-worlds.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> p_grid)) <span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="small-worlds-and-large-worlds.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unstd_posterior =</span> likelihood <span class="sc">*</span> prior) <span class="sc">%&gt;%</span></span>
<span id="cb60-6"><a href="small-worlds-and-large-worlds.html#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">posterior =</span> unstd_posterior <span class="sc">/</span> <span class="fu">sum</span>(unstd_posterior)) <span class="sc">%&gt;%</span> </span>
<span id="cb60-7"><a href="small-worlds-and-large-worlds.html#cb60-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-8"><a href="small-worlds-and-large-worlds.html#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span></span>
<span id="cb60-9"><a href="small-worlds-and-large-worlds.html#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb60-10"><a href="small-worlds-and-large-worlds.html#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb60-11"><a href="small-worlds-and-large-worlds.html#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;5 points&quot;</span>,</span>
<span id="cb60-12"><a href="small-worlds-and-large-worlds.html#cb60-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;probability of water&quot;</span>,</span>
<span id="cb60-13"><a href="small-worlds-and-large-worlds.html#cb60-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;posterior probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-14"><a href="small-worlds-and-large-worlds.html#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p>Here we combine them and plot!</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="small-worlds-and-large-worlds.html#cb61-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;More grid points make for smoother approximations&quot;</span>)</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-38-1.png" width="576" /></p>
</div>
<div id="quadratic-approximation." class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Quadratic approximation.<a href="small-worlds-and-large-worlds.html#quadratic-approximation." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Apply the quadratic approximation to the globe tossing data with <code>rethinking::map()</code>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="small-worlds-and-large-worlds.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb62-2"><a href="small-worlds-and-large-worlds.html#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="small-worlds-and-large-worlds.html#cb62-3" aria-hidden="true" tabindex="-1"></a>globe_qa <span class="ot">&lt;-</span></span>
<span id="cb62-4"><a href="small-worlds-and-large-worlds.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  rethinking<span class="sc">::</span><span class="fu">map</span>(</span>
<span id="cb62-5"><a href="small-worlds-and-large-worlds.html#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb62-6"><a href="small-worlds-and-large-worlds.html#cb62-6" aria-hidden="true" tabindex="-1"></a>      w <span class="sc">~</span> <span class="fu">dbinom</span>(<span class="dv">9</span>, p),  <span class="co"># binomial likelihood</span></span>
<span id="cb62-7"><a href="small-worlds-and-large-worlds.html#cb62-7" aria-hidden="true" tabindex="-1"></a>      p <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)    <span class="co"># uniform prior</span></span>
<span id="cb62-8"><a href="small-worlds-and-large-worlds.html#cb62-8" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb62-9"><a href="small-worlds-and-large-worlds.html#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">list</span>(<span class="at">w =</span> <span class="dv">6</span>))</span>
<span id="cb62-10"><a href="small-worlds-and-large-worlds.html#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="small-worlds-and-large-worlds.html#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># display summary of quadratic approximation</span></span>
<span id="cb62-12"><a href="small-worlds-and-large-worlds.html#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(globe_qa)</span></code></pre></div>
<pre><code>##        mean        sd      5.5%     94.5%
## p 0.6666666 0.1571338 0.4155364 0.9177967</code></pre>
<p>In preparation for Figure 2.8, here’s the model with <span class="math inline">\(n = 18\)</span> and <span class="math inline">\(n = 36\)</span>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="small-worlds-and-large-worlds.html#cb64-1" aria-hidden="true" tabindex="-1"></a>globe_qa_18 <span class="ot">&lt;-</span></span>
<span id="cb64-2"><a href="small-worlds-and-large-worlds.html#cb64-2" aria-hidden="true" tabindex="-1"></a>  rethinking<span class="sc">::</span><span class="fu">map</span>(</span>
<span id="cb64-3"><a href="small-worlds-and-large-worlds.html#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb64-4"><a href="small-worlds-and-large-worlds.html#cb64-4" aria-hidden="true" tabindex="-1"></a>      w <span class="sc">~</span> <span class="fu">dbinom</span>(<span class="dv">9</span> <span class="sc">*</span> <span class="dv">2</span>, p),</span>
<span id="cb64-5"><a href="small-worlds-and-large-worlds.html#cb64-5" aria-hidden="true" tabindex="-1"></a>      p <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb64-6"><a href="small-worlds-and-large-worlds.html#cb64-6" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">data =</span> <span class="fu">list</span>(<span class="at">w =</span> <span class="dv">6</span>  <span class="sc">*</span><span class="dv">2</span>))</span>
<span id="cb64-7"><a href="small-worlds-and-large-worlds.html#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="small-worlds-and-large-worlds.html#cb64-8" aria-hidden="true" tabindex="-1"></a>globe_qa_36 <span class="ot">&lt;-</span></span>
<span id="cb64-9"><a href="small-worlds-and-large-worlds.html#cb64-9" aria-hidden="true" tabindex="-1"></a>  rethinking<span class="sc">::</span><span class="fu">map</span>(</span>
<span id="cb64-10"><a href="small-worlds-and-large-worlds.html#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb64-11"><a href="small-worlds-and-large-worlds.html#cb64-11" aria-hidden="true" tabindex="-1"></a>      w <span class="sc">~</span> <span class="fu">dbinom</span>(<span class="dv">9</span> <span class="sc">*</span> <span class="dv">4</span>, p),</span>
<span id="cb64-12"><a href="small-worlds-and-large-worlds.html#cb64-12" aria-hidden="true" tabindex="-1"></a>      p <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb64-13"><a href="small-worlds-and-large-worlds.html#cb64-13" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">data =</span> <span class="fu">list</span>(<span class="at">w =</span> <span class="dv">6</span> <span class="sc">*</span> <span class="dv">4</span>))</span>
<span id="cb64-14"><a href="small-worlds-and-large-worlds.html#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="small-worlds-and-large-worlds.html#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(globe_qa_18)</span></code></pre></div>
<pre><code>##        mean        sd      5.5%     94.5%
## p 0.6666662 0.1111104 0.4890902 0.8442421</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="small-worlds-and-large-worlds.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(globe_qa_36)</span></code></pre></div>
<pre><code>##        mean        sd      5.5%     94.5%
## p 0.6666666 0.0785669 0.5411015 0.7922317</code></pre>
<p>Now make Figure 2.8.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="small-worlds-and-large-worlds.html#cb68-1" aria-hidden="true" tabindex="-1"></a>n_grid <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb68-2"><a href="small-worlds-and-large-worlds.html#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="small-worlds-and-large-worlds.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb68-4"><a href="small-worlds-and-large-worlds.html#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">w =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">24</span>),</span>
<span id="cb68-5"><a href="small-worlds-and-large-worlds.html#cb68-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">18</span>, <span class="dv">36</span>),</span>
<span id="cb68-6"><a href="small-worlds-and-large-worlds.html#cb68-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">s =</span> <span class="fu">c</span>(.<span class="dv">16</span>, .<span class="dv">11</span>, .<span class="dv">08</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-7"><a href="small-worlds-and-large-worlds.html#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">p_grid =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> n_grid)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-8"><a href="small-worlds-and-large-worlds.html#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prior =</span> <span class="dv">1</span>,</span>
<span id="cb68-9"><a href="small-worlds-and-large-worlds.html#cb68-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">m     =</span> .<span class="dv">67</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="small-worlds-and-large-worlds.html#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(w, <span class="at">size =</span> n, <span class="at">prob =</span> p_grid)) <span class="sc">%&gt;%</span></span>
<span id="cb68-11"><a href="small-worlds-and-large-worlds.html#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unstd_grid_posterior =</span> likelihood <span class="sc">*</span> prior,</span>
<span id="cb68-12"><a href="small-worlds-and-large-worlds.html#cb68-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">unstd_quad_posterior =</span> <span class="fu">dnorm</span>(p_grid, m, s)) <span class="sc">%&gt;%</span></span>
<span id="cb68-13"><a href="small-worlds-and-large-worlds.html#cb68-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(w) <span class="sc">%&gt;%</span> </span>
<span id="cb68-14"><a href="small-worlds-and-large-worlds.html#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grid_posterior =</span> unstd_grid_posterior <span class="sc">/</span> <span class="fu">sum</span>(unstd_grid_posterior),</span>
<span id="cb68-15"><a href="small-worlds-and-large-worlds.html#cb68-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">quad_posterior =</span> unstd_quad_posterior <span class="sc">/</span> <span class="fu">sum</span>(unstd_quad_posterior),</span>
<span id="cb68-16"><a href="small-worlds-and-large-worlds.html#cb68-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">n =</span> <span class="fu">str_c</span>(<span class="st">&quot;n = &quot;</span>, n)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-17"><a href="small-worlds-and-large-worlds.html#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">factor</span>(n, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;n = 9&quot;</span>, <span class="st">&quot;n = 18&quot;</span>, <span class="st">&quot;n = 36&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb68-18"><a href="small-worlds-and-large-worlds.html#cb68-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-19"><a href="small-worlds-and-large-worlds.html#cb68-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb68-20"><a href="small-worlds-and-large-worlds.html#cb68-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid)) <span class="sc">+</span></span>
<span id="cb68-21"><a href="small-worlds-and-large-worlds.html#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> grid_posterior)) <span class="sc">+</span></span>
<span id="cb68-22"><a href="small-worlds-and-large-worlds.html#cb68-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> quad_posterior),</span>
<span id="cb68-23"><a href="small-worlds-and-large-worlds.html#cb68-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="sc">+</span></span>
<span id="cb68-24"><a href="small-worlds-and-large-worlds.html#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion water&quot;</span>,</span>
<span id="cb68-25"><a href="small-worlds-and-large-worlds.html#cb68-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb68-26"><a href="small-worlds-and-large-worlds.html#cb68-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb68-27"><a href="small-worlds-and-large-worlds.html#cb68-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>n, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-41-1.png" width="768" /></p>
</div>
<div id="markov-chain-monte-carlo." class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Markov chain Monte Carlo.<a href="small-worlds-and-large-worlds.html#markov-chain-monte-carlo." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since the main goal of this project is to highlight brms, we may as fit a model. This seems like an appropriately named subsection to do so. First we’ll have to load the package.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="small-worlds-and-large-worlds.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span></code></pre></div>
<p>Here re-fit the last model from above, the one for which <span class="math inline">\(w = 24\)</span> and <span class="math inline">\(n = 36\)</span>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="small-worlds-and-large-worlds.html#cb70-1" aria-hidden="true" tabindex="-1"></a>b2<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb70-2"><a href="small-worlds-and-large-worlds.html#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> <span class="fu">list</span>(<span class="at">w =</span> <span class="dv">24</span>), </span>
<span id="cb70-3"><a href="small-worlds-and-large-worlds.html#cb70-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb70-4"><a href="small-worlds-and-large-worlds.html#cb70-4" aria-hidden="true" tabindex="-1"></a>      w <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">36</span>) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb70-5"><a href="small-worlds-and-large-worlds.html#cb70-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">beta</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept, <span class="at">lb =</span> <span class="dv">0</span>, <span class="at">ub =</span> <span class="dv">1</span>),</span>
<span id="cb70-6"><a href="small-worlds-and-large-worlds.html#cb70-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">2</span>,</span>
<span id="cb70-7"><a href="small-worlds-and-large-worlds.html#cb70-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b02.01&quot;</span>)</span></code></pre></div>
<p>The model output from brms looks like so.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="small-worlds-and-large-worlds.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b2<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = identity 
## Formula: w | trials(36) ~ 1 
##    Data: list(w = 24) (Number of observations: 1) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.66      0.08     0.50     0.80 1.00     1483     1350
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>There’s a lot going on in that output, which we’ll start to clarify in Chapter 4. For now, focus on the ‘Intercept’ line. As we’ll also learn in Chapter 4, the intercept of a regression model with no predictors is the same as its mean. In the special case of a model using the binomial likelihood, the mean is the probability of a 1 in a given trial, <span class="math inline">\(\theta\)</span>.</p>
<p>Let’s plot the results of our model and compare them with those from <code>rethinking::map()</code>, above.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="small-worlds-and-large-worlds.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(b2<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="small-worlds-and-large-worlds.html#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="st">&quot;n = 36&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="small-worlds-and-large-worlds.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="small-worlds-and-large-worlds.html#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> b_Intercept)) <span class="sc">+</span></span>
<span id="cb73-5"><a href="small-worlds-and-large-worlds.html#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb73-6"><a href="small-worlds-and-large-worlds.html#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;proportion water&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb73-7"><a href="small-worlds-and-large-worlds.html#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb73-8"><a href="small-worlds-and-large-worlds.html#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>n)</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-44-1.png" width="288" /></p>
<p>If you’re still confused. Cool. This is just a preview. We’ll start walking through fitting models in brms in <a href="linear-models.html#a-gaussian-model-of-height">Chapter 4</a> and we’ll learn a lot about regression with the binomial likelihood in <a href="counting-and-classification.html#counting-and-classification">Chapter 10</a>.</p>
</div>
</div>
<div id="session-info-1" class="section level2 unnumbered hasAnchor">
<h2>Session info<a href="small-worlds-and-large-worlds.html#session-info-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="small-worlds-and-large-worlds.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.2.2 (2022-10-31)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur ... 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] brms_2.18.0          Rcpp_1.0.9           rethinking_2.21      cmdstanr_0.5.3      
##  [5] rstan_2.21.8         StanHeaders_2.21.0-7 patchwork_1.1.2      forcats_0.5.1       
##  [9] stringr_1.4.1        dplyr_1.0.10         purrr_1.0.1          readr_2.1.2         
## [13] tidyr_1.2.1          tibble_3.1.8         ggplot2_3.4.0        tidyverse_1.3.2     
## 
## loaded via a namespace (and not attached):
##   [1] readxl_1.4.1         backports_1.4.1      plyr_1.8.7           igraph_1.3.4        
##   [5] splines_4.2.2        crosstalk_1.2.0      TH.data_1.1-1        rstantools_2.2.0    
##   [9] inline_0.3.19        digest_0.6.31        htmltools_0.5.3      fansi_1.0.3         
##  [13] magrittr_2.0.3       checkmate_2.1.0      googlesheets4_1.0.1  tzdb_0.3.0          
##  [17] modelr_0.1.8         RcppParallel_5.1.5   matrixStats_0.63.0   xts_0.12.1          
##  [21] sandwich_3.0-2       prettyunits_1.1.1    colorspace_2.0-3     rvest_1.0.2         
##  [25] haven_2.5.1          xfun_0.35            callr_3.7.3          crayon_1.5.2        
##  [29] jsonlite_1.8.4       lme4_1.1-31          survival_3.4-0       zoo_1.8-10          
##  [33] glue_1.6.2           gtable_0.3.1         gargle_1.2.0         emmeans_1.8.0       
##  [37] distributional_0.3.1 pkgbuild_1.3.1       shape_1.4.6          abind_1.4-5         
##  [41] scales_1.2.1         mvtnorm_1.1-3        DBI_1.1.3            miniUI_0.1.1.1      
##  [45] xtable_1.8-4         stats4_4.2.2         DT_0.24              htmlwidgets_1.5.4   
##  [49] httr_1.4.4           threejs_0.3.3        posterior_1.3.1      ellipsis_0.3.2      
##  [53] pkgconfig_2.0.3      loo_2.5.1            farver_2.1.1         sass_0.4.2          
##  [57] dbplyr_2.2.1         utf8_1.2.2           tidyselect_1.2.0     labeling_0.4.2      
##  [61] rlang_1.0.6          reshape2_1.4.4       later_1.3.0          munsell_0.5.0       
##  [65] cellranger_1.1.0     tools_4.2.2          cachem_1.0.6         cli_3.6.0           
##  [69] generics_0.1.3       broom_1.0.2          evaluate_0.18        fastmap_1.1.0       
##  [73] processx_3.8.0       knitr_1.40           fs_1.5.2             nlme_3.1-160        
##  [77] mime_0.12            projpred_2.2.1       xml2_1.3.3           compiler_4.2.2      
##  [81] bayesplot_1.10.0     shinythemes_1.2.0    rstudioapi_0.13      gamm4_0.2-6         
##  [85] reprex_2.0.2         bslib_0.4.0          stringi_1.7.8        highr_0.9           
##  [89] ps_1.7.2             Brobdingnag_1.2-8    lattice_0.20-45      Matrix_1.5-1        
##  [93] nloptr_2.0.3         markdown_1.1         shinyjs_2.1.0        tensorA_0.36.2      
##  [97] vctrs_0.5.1          pillar_1.8.1         lifecycle_1.0.3      jquerylib_0.1.4     
## [101] bridgesampling_1.1-2 estimability_1.4.1   httpuv_1.6.5         R6_2.5.1            
## [105] bookdown_0.28        promises_1.2.0.1     gridExtra_2.3        codetools_0.2-18    
## [109] boot_1.3-28          colourpicker_1.1.1   MASS_7.3-58.1        gtools_3.9.4        
## [113] assertthat_0.2.1     withr_2.5.0          shinystan_2.6.0      multcomp_1.4-20     
## [117] mgcv_1.8-41          hms_1.1.1            grid_4.2.2           minqa_1.2.5         
## [121] coda_0.19-4          rmarkdown_2.16       googledrive_2.0.0    shiny_1.7.2         
## [125] lubridate_1.8.0      base64enc_0.1-3      dygraphs_1.1.1.6</code></pre>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-borgesjlJardinSenderosQue1941" class="csl-entry">
Borges, JL. (1941). El jardin de senderos que se bifurcan. <span>Buenos Aires</span>: <span>Sur</span>. <span>Translated</span> by <span>D</span>. <span>A</span>. <span>Yates</span> (1964). In <em>Labyrinths: <span>Selected Stories</span> &amp; <span>Other Writings</span></em> (pp. 19–29). <span>New Directions</span>.
</div>
<div id="ref-gelmanGardenForkingPaths2013" class="csl-entry">
Gelman, A., &amp; Loken, E. (2013). <em>The garden of forking paths: <span>Why</span> multiple comparisons can be a problem, even when there is no <span>“fishing expedition”</span> or <span>“p-hacking”</span> and the research hypothesis was posited ahead of time</em>. 17. <a href="https://stat.columbia.edu/~gelman/research/unpublished/p_hacking.pdf">https://stat.columbia.edu/~gelman/research/unpublished/p_hacking.pdf</a>
</div>
<div id="ref-mcelreathStatisticalRethinkingBayesian2015" class="csl-entry">
McElreath, R. (2015). <em>Statistical rethinking: <span>A Bayesian</span> course with examples in <span>R</span> and <span>Stan</span></em>. <span>CRC press</span>. <a href="https://xcelab.net/rm/statistical-rethinking/">https://xcelab.net/rm/statistical-rethinking/</a>
</div>
<div id="ref-R-tibble" class="csl-entry">
Müller, K., &amp; Wickham, H. (2022). <em><span class="nocase">tibble</span>: <span>Simple</span> data frames</em>. <a href="https://CRAN.R-project.org/package=tibble">https://CRAN.R-project.org/package=tibble</a>
</div>
<div id="ref-R-patchwork" class="csl-entry">
Pedersen, T. L. (2022). <em><span class="nocase">patchwork</span>: <span>The</span> composer of plots</em>. <a href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a>
</div>
<div id="ref-pengProgrammingDataScience2022" class="csl-entry">
Peng, R. D. (2022). <em>R programming for data science</em>. <a href="https://bookdown.org/rdpeng/rprogdatascience/">https://bookdown.org/rdpeng/rprogdatascience/</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-golem-of-prague.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sampling-the-imaginary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
