<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Sampling the Imaginary | Statistical Rethinking with brms, ggplot2, and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in McElreath’s textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Sampling the Imaginary | Statistical Rethinking with brms, ggplot2, and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in McElreath’s textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKURZ/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Sampling the Imaginary | Statistical Rethinking with brms, ggplot2, and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in McElreath’s textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2020-02-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="small-worlds-and-large-worlds.html"/>
<link rel="next" href="linear-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>This is a love letter</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-this"><i class="fa fa-check"></i>Why this?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#my-assumptions-about-you"><i class="fa fa-check"></i>My assumptions about you</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-and-understand-this-project"><i class="fa fa-check"></i>How to use and understand this project</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#you-can-do-this-too"><i class="fa fa-check"></i>You can do this, too</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.9.0."><i class="fa fa-check"></i>Version 0.9.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.0.0."><i class="fa fa-check"></i>Version 1.0.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.0.1."><i class="fa fa-check"></i>Version 1.0.1.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-1.1.0."><i class="fa fa-check"></i>Version 1.1.0.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a><ul>
<li class="chapter" data-level="" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a><ul>
<li class="chapter" data-level="2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#the-garden-of-forking-data"><i class="fa fa-check"></i><b>2.1</b> The garden of forking data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#counting-possibilities."><i class="fa fa-check"></i><b>2.1.1</b> Counting possibilities.</a></li>
<li class="chapter" data-level="2.1.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#using-prior-information."><i class="fa fa-check"></i><b>2.1.2</b> Using prior information.</a></li>
<li class="chapter" data-level="2.1.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#from-counts-to-probability."><i class="fa fa-check"></i><b>2.1.3</b> From counts to probability.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#building-a-model"><i class="fa fa-check"></i><b>2.2</b> Building a model</a><ul>
<li class="chapter" data-level="2.2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#a-data-story."><i class="fa fa-check"></i><b>2.2.1</b> A data story.</a></li>
<li class="chapter" data-level="2.2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#bayesian-updating."><i class="fa fa-check"></i><b>2.2.2</b> Bayesian updating.</a></li>
<li class="chapter" data-level="2.2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#evaluate."><i class="fa fa-check"></i><b>2.2.3</b> Evaluate.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#components-of-the-model"><i class="fa fa-check"></i><b>2.3</b> Components of the model</a><ul>
<li class="chapter" data-level="2.3.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#likelihood."><i class="fa fa-check"></i><b>2.3.1</b> Likelihood.</a></li>
<li class="chapter" data-level="2.3.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#parameters."><i class="fa fa-check"></i><b>2.3.2</b> Parameters.</a></li>
<li class="chapter" data-level="2.3.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#prior."><i class="fa fa-check"></i><b>2.3.3</b> Prior.</a></li>
<li class="chapter" data-level="2.3.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#posterior."><i class="fa fa-check"></i><b>2.3.4</b> Posterior.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#making-the-model-go"><i class="fa fa-check"></i><b>2.4</b> Making the model go</a><ul>
<li class="chapter" data-level="2.4.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#grid-approximation."><i class="fa fa-check"></i><b>2.4.1</b> Grid approximation.</a></li>
<li class="chapter" data-level="2.4.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#quadratic-approximation."><i class="fa fa-check"></i><b>2.4.2</b> Quadratic approximation.</a></li>
<li class="chapter" data-level="2.4.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#markov-chain-monte-carlo."><i class="fa fa-check"></i><b>2.4.3</b> Markov chain Monte Carlo.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a><ul>
<li class="chapter" data-level="3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-from-a-grid-like-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-like approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a><ul>
<li class="chapter" data-level="3.2.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-boundaries."><i class="fa fa-check"></i><b>3.2.1</b> Intervals of defined boundaries.</a></li>
<li class="chapter" data-level="3.2.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-mass."><i class="fa fa-check"></i><b>3.2.2</b> Intervals of defined mass.</a></li>
<li class="chapter" data-level="3.2.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#point-estimates."><i class="fa fa-check"></i><b>3.2.3</b> Point estimates.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a><ul>
<li class="chapter" data-level="3.3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#dummy-data."><i class="fa fa-check"></i><b>3.3.1</b> Dummy data.</a></li>
<li class="chapter" data-level="3.3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#model-checking."><i class="fa fa-check"></i><b>3.3.2</b> Model checking.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#summary-lets-practice-in-brms"><i class="fa fa-check"></i><b>3.4</b> <del>Summary</del> Let’s practice in brms</a></li>
<li class="chapter" data-level="" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>4</b> Linear Models</a><ul>
<li class="chapter" data-level="4.1" data-path="linear-models.html"><a href="linear-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why normal distributions are normal</a><ul>
<li class="chapter" data-level="4.1.1" data-path="linear-models.html"><a href="linear-models.html#normal-by-addition."><i class="fa fa-check"></i><b>4.1.1</b> Normal by addition.</a></li>
<li class="chapter" data-level="4.1.2" data-path="linear-models.html"><a href="linear-models.html#normal-by-multiplication."><i class="fa fa-check"></i><b>4.1.2</b> Normal by multiplication.</a></li>
<li class="chapter" data-level="4.1.3" data-path="linear-models.html"><a href="linear-models.html#normal-by-log-multiplication."><i class="fa fa-check"></i><b>4.1.3</b> Normal by log-multiplication.</a></li>
<li class="chapter" data-level="4.1.4" data-path="linear-models.html"><a href="linear-models.html#using-gaussian-distributions."><i class="fa fa-check"></i><b>4.1.4</b> Using Gaussian distributions.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="linear-models.html"><a href="linear-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a><ul>
<li class="chapter" data-level="4.2.1" data-path="linear-models.html"><a href="linear-models.html#re-describing-the-globe-tossing-model."><i class="fa fa-check"></i><b>4.2.1</b> Re-describing the globe tossing model.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="linear-models.html"><a href="linear-models.html#a-gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> A Gaussian model of height</a><ul>
<li class="chapter" data-level="4.3.1" data-path="linear-models.html"><a href="linear-models.html#the-data."><i class="fa fa-check"></i><b>4.3.1</b> The data.</a></li>
<li class="chapter" data-level="4.3.2" data-path="linear-models.html"><a href="linear-models.html#the-model."><i class="fa fa-check"></i><b>4.3.2</b> The model.</a></li>
<li class="chapter" data-level="4.3.3" data-path="linear-models.html"><a href="linear-models.html#grid-approximation-of-the-posterior-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Grid approximation of the posterior distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="linear-models.html"><a href="linear-models.html#sampling-from-the-posterior."><i class="fa fa-check"></i><b>4.3.4</b> Sampling from the posterior.</a></li>
<li class="chapter" data-level="4.3.5" data-path="linear-models.html"><a href="linear-models.html#fitting-the-model-with-map-brm."><i class="fa fa-check"></i><b>4.3.5</b> Fitting the model with <del><code>map</code></del> <code>brm()</code>.</a></li>
<li class="chapter" data-level="4.3.6" data-path="linear-models.html"><a href="linear-models.html#sampling-from-a-map-brm-fit."><i class="fa fa-check"></i><b>4.3.6</b> Sampling from a <del><code>map</code></del> <code>brm()</code> fit.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="linear-models.html"><a href="linear-models.html#adding-a-predictor"><i class="fa fa-check"></i><b>4.4</b> Adding a predictor</a><ul>
<li class="chapter" data-level="4.4.1" data-path="linear-models.html"><a href="linear-models.html#the-linear-model-strategy."><i class="fa fa-check"></i><b>4.4.1</b> The linear model strategy.</a></li>
<li class="chapter" data-level="4.4.2" data-path="linear-models.html"><a href="linear-models.html#fitting-the-model."><i class="fa fa-check"></i><b>4.4.2</b> Fitting the model.</a></li>
<li class="chapter" data-level="4.4.3" data-path="linear-models.html"><a href="linear-models.html#interpreting-the-model-fit."><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the model fit.</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="linear-models.html"><a href="linear-models.html#polynomial-regression"><i class="fa fa-check"></i><b>4.5</b> Polynomial regression</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html"><i class="fa fa-check"></i><b>5</b> Multivariate Linear Models</a><ul>
<li class="chapter" data-level="5.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#spurious-associations"><i class="fa fa-check"></i><b>5.1</b> Spurious associations</a><ul>
<li class="chapter" data-level="5.1.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multivariate-notation."><i class="fa fa-check"></i><b>5.1.1</b> Multivariate notation.</a></li>
<li class="chapter" data-level="5.1.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#fitting-the-model.-1"><i class="fa fa-check"></i><b>5.1.2</b> Fitting the model.</a></li>
<li class="chapter" data-level="5.1.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#plotting-multivariate-posteriors."><i class="fa fa-check"></i><b>5.1.3</b> Plotting multivariate posteriors.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#masked-relationship"><i class="fa fa-check"></i><b>5.2</b> Masked relationship</a></li>
<li class="chapter" data-level="5.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multicollinearity"><i class="fa fa-check"></i><b>5.3</b> Multicollinearity</a><ul>
<li class="chapter" data-level="5.3.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multicollinear-legs."><i class="fa fa-check"></i><b>5.3.1</b> Multicollinear legs.</a></li>
<li class="chapter" data-level="5.3.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#multicollinear-milk."><i class="fa fa-check"></i><b>5.3.2</b> Multicollinear <code>milk</code>.</a></li>
<li class="chapter" data-level="5.3.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#post-treatment-bias."><i class="fa fa-check"></i><b>5.3.3</b> Post-treatment bias.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#categorical-variables"><i class="fa fa-check"></i><b>5.4</b> Categorical variables</a><ul>
<li class="chapter" data-level="5.4.1" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#binary-categories."><i class="fa fa-check"></i><b>5.4.1</b> Binary categories.</a></li>
<li class="chapter" data-level="5.4.2" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#many-categories."><i class="fa fa-check"></i><b>5.4.2</b> Many categories.</a></li>
<li class="chapter" data-level="5.4.3" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#adding-regular-predictor-variables."><i class="fa fa-check"></i><b>5.4.3</b> Adding regular predictor variables.</a></li>
<li class="chapter" data-level="5.4.4" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#another-approach-unique-intercepts."><i class="fa fa-check"></i><b>5.4.4</b> Another approach: Unique intercepts.</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#ordinary-least-squares-and-lm"><i class="fa fa-check"></i><b>5.5</b> <del>Ordinary least squares and <code>lm()</code></del></a></li>
<li class="chapter" data-level="" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="multivariate-linear-models.html"><a href="multivariate-linear-models.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html"><i class="fa fa-check"></i><b>6</b> Overfitting, Regularization, and Information Criteria</a><ul>
<li class="chapter" data-level="6.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>6.1</b> The problem with parameters</a><ul>
<li class="chapter" data-level="6.1.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#more-parameters-always-improve-fit."><i class="fa fa-check"></i><b>6.1.1</b> More parameters always improve fit.</a></li>
<li class="chapter" data-level="6.1.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#too-few-parameters-hurts-too."><i class="fa fa-check"></i><b>6.1.2</b> Too few parameters hurts, too.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#information-theory-and-model-performance"><i class="fa fa-check"></i><b>6.2</b> Information theory and model performance</a><ul>
<li class="chapter" data-level="6.2.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#firing-the-weatherperson."><i class="fa fa-check"></i><b>6.2.1</b> Firing the weatherperson.</a></li>
<li class="chapter" data-level="6.2.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#information-and-uncertainty."><i class="fa fa-check"></i><b>6.2.2</b> Information and uncertainty.</a></li>
<li class="chapter" data-level="6.2.3" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#from-entropy-to-accuracy."><i class="fa fa-check"></i><b>6.2.3</b> From entropy to accuracy.</a></li>
<li class="chapter" data-level="6.2.4" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#from-divergence-to-deviance."><i class="fa fa-check"></i><b>6.2.4</b> From divergence to deviance.</a></li>
<li class="chapter" data-level="6.2.5" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#from-deviance-to-out-of-sample."><i class="fa fa-check"></i><b>6.2.5</b> From deviance to out-of-sample.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#regularization"><i class="fa fa-check"></i><b>6.3</b> Regularization</a></li>
<li class="chapter" data-level="6.4" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#information-criteria"><i class="fa fa-check"></i><b>6.4</b> Information criteria</a><ul>
<li class="chapter" data-level="6.4.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#dic."><i class="fa fa-check"></i><b>6.4.1</b> DIC.</a></li>
<li class="chapter" data-level="6.4.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#waic."><i class="fa fa-check"></i><b>6.4.2</b> WAIC.</a></li>
<li class="chapter" data-level="6.4.3" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#dic-and-waic-as-estimates-of-deviance."><i class="fa fa-check"></i><b>6.4.3</b> DIC and WAIC as estimates of deviance.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#using-information-criteria"><i class="fa fa-check"></i><b>6.5</b> Using information criteria</a><ul>
<li class="chapter" data-level="6.5.1" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#model-comparison."><i class="fa fa-check"></i><b>6.5.1</b> Model comparison.</a></li>
<li class="chapter" data-level="6.5.2" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#model-averaging."><i class="fa fa-check"></i><b>6.5.2</b> Model averaging.</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#summary-bonus-r2-talk"><i class="fa fa-check"></i><b>6.6</b> <del>Summary</del> Bonus: <span class="math inline">\(R^2\)</span> talk</a></li>
<li class="chapter" data-level="" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#reference-5"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="overfitting-regularization-and-information-criteria.html"><a href="overfitting-regularization-and-information-criteria.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>7</b> Interactions</a><ul>
<li class="chapter" data-level="7.1" data-path="interactions.html"><a href="interactions.html#building-an-interaction."><i class="fa fa-check"></i><b>7.1</b> Building an interaction.</a><ul>
<li class="chapter" data-level="7.1.1" data-path="interactions.html"><a href="interactions.html#adding-a-dummy-variable-doesnt-work."><i class="fa fa-check"></i><b>7.1.1</b> Adding a dummy variable doesn’t work.</a></li>
<li class="chapter" data-level="7.1.2" data-path="interactions.html"><a href="interactions.html#adding-a-linear-interaction-does-work."><i class="fa fa-check"></i><b>7.1.2</b> Adding a linear interaction does work.</a></li>
<li class="chapter" data-level="7.1.3" data-path="interactions.html"><a href="interactions.html#plotting-the-interaction."><i class="fa fa-check"></i><b>7.1.3</b> Plotting the interaction.</a></li>
<li class="chapter" data-level="7.1.4" data-path="interactions.html"><a href="interactions.html#interpreting-an-interaction-estimate."><i class="fa fa-check"></i><b>7.1.4</b> Interpreting an interaction estimate.</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="interactions.html"><a href="interactions.html#symmetry-of-the-linear-interaction."><i class="fa fa-check"></i><b>7.2</b> Symmetry of the linear interaction.</a><ul>
<li class="chapter" data-level="7.2.1" data-path="interactions.html"><a href="interactions.html#buridans-interaction."><i class="fa fa-check"></i><b>7.2.1</b> Buridan’s interaction.</a></li>
<li class="chapter" data-level="7.2.2" data-path="interactions.html"><a href="interactions.html#africa-depends-upon-ruggedness."><i class="fa fa-check"></i><b>7.2.2</b> Africa depends upon ruggedness.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="interactions.html"><a href="interactions.html#continuous-interactions"><i class="fa fa-check"></i><b>7.3</b> Continuous interactions</a><ul>
<li class="chapter" data-level="7.3.1" data-path="interactions.html"><a href="interactions.html#the-data.-1"><i class="fa fa-check"></i><b>7.3.1</b> The data.</a></li>
<li class="chapter" data-level="7.3.2" data-path="interactions.html"><a href="interactions.html#the-un-centered-models."><i class="fa fa-check"></i><b>7.3.2</b> The un-centered models.</a></li>
<li class="chapter" data-level="7.3.3" data-path="interactions.html"><a href="interactions.html#center-and-re-estimate."><i class="fa fa-check"></i><b>7.3.3</b> Center and re-estimate.</a></li>
<li class="chapter" data-level="7.3.4" data-path="interactions.html"><a href="interactions.html#plotting-implied-predictions."><i class="fa fa-check"></i><b>7.3.4</b> Plotting implied predictions.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="interactions.html"><a href="interactions.html#interactions-in-design-formulas"><i class="fa fa-check"></i><b>7.4</b> Interactions in design formulas</a></li>
<li class="chapter" data-level="7.5" data-path="interactions.html"><a href="interactions.html#summary-bonus-marginal_effectsconditional_effects"><i class="fa fa-check"></i><b>7.5</b> <del>Summary</del> Bonus: <code>marginal_effects()</code>/<code>conditional_effects()</code></a></li>
<li class="chapter" data-level="" data-path="interactions.html"><a href="interactions.html#reference-6"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="interactions.html"><a href="interactions.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>8</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="8.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#good-king-markov-and-his-island-kingdom"><i class="fa fa-check"></i><b>8.1</b> Good King Markov and His island kingdom</a></li>
<li class="chapter" data-level="8.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#markov-chain-monte-carlo-1"><i class="fa fa-check"></i><b>8.2</b> Markov chain Monte Carlo</a><ul>
<li class="chapter" data-level="8.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-sampling."><i class="fa fa-check"></i><b>8.2.1</b> Gibbs sampling.</a></li>
<li class="chapter" data-level="8.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#hamiltonian-monte-carlo."><i class="fa fa-check"></i><b>8.2.2</b> Hamiltonian Monte Carlo.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#easy-hmc-map2stan-brm"><i class="fa fa-check"></i><b>8.3</b> Easy HMC: <del>map2stan</del> <code>brm()</code></a><ul>
<li class="chapter" data-level="8.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#preparation."><i class="fa fa-check"></i><b>8.3.1</b> Preparation.</a></li>
<li class="chapter" data-level="8.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#estimation."><i class="fa fa-check"></i><b>8.3.2</b> Estimation.</a></li>
<li class="chapter" data-level="8.3.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#sampling-again-in-parallel."><i class="fa fa-check"></i><b>8.3.3</b> Sampling again, in parallel.</a></li>
<li class="chapter" data-level="8.3.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#visualization."><i class="fa fa-check"></i><b>8.3.4</b> Visualization.</a></li>
<li class="chapter" data-level="8.3.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#using-the-samples."><i class="fa fa-check"></i><b>8.3.5</b> Using the samples.</a></li>
<li class="chapter" data-level="8.3.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#checking-the-chain."><i class="fa fa-check"></i><b>8.3.6</b> Checking the chain.</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#care-and-feeding-of-your-markov-chain."><i class="fa fa-check"></i><b>8.4</b> Care and feeding of your Markov chain.</a><ul>
<li class="chapter" data-level="8.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>8.4.1</b> How many samples do you need?</a></li>
<li class="chapter" data-level="8.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-chains-do-you-need"><i class="fa fa-check"></i><b>8.4.2</b> How many chains do you need?</a></li>
<li class="chapter" data-level="8.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#taming-a-wild-chain."><i class="fa fa-check"></i><b>8.4.3</b> Taming a wild chain.</a></li>
<li class="chapter" data-level="8.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#non-identifiable-parameters."><i class="fa fa-check"></i><b>8.4.4</b> Non-identifiable parameters.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#reference-7"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>9</b> Big Entropy and the Generalized Linear Model</a><ul>
<li class="chapter" data-level="9.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>9.1</b> Maximum entropy</a><ul>
<li class="chapter" data-level="9.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#gaussian."><i class="fa fa-check"></i><b>9.1.1</b> Gaussian.</a></li>
<li class="chapter" data-level="9.1.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#binomial."><i class="fa fa-check"></i><b>9.1.2</b> Binomial.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>9.2</b> Generalized linear models</a><ul>
<li class="chapter" data-level="9.2.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#meet-the-family."><i class="fa fa-check"></i><b>9.2.1</b> Meet the family.</a></li>
<li class="chapter" data-level="9.2.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions."><i class="fa fa-check"></i><b>9.2.2</b> Linking linear models to distributions.</a></li>
<li class="chapter" data-level="9.2.3" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#absolute-and-relative-differences."><i class="fa fa-check"></i><b>9.2.3</b> Absolute and relative differences.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#reference-8"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="counting-and-classification.html"><a href="counting-and-classification.html"><i class="fa fa-check"></i><b>10</b> Counting and Classification</a><ul>
<li class="chapter" data-level="10.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#binomial-regression"><i class="fa fa-check"></i><b>10.1</b> Binomial regression</a><ul>
<li class="chapter" data-level="10.1.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#logistic-regression-prosocial-chimpanzees."><i class="fa fa-check"></i><b>10.1.1</b> Logistic regression: Prosocial chimpanzees.</a></li>
<li class="chapter" data-level="10.1.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#aggregated-binomial-chimpanzees-again-condensed."><i class="fa fa-check"></i><b>10.1.2</b> Aggregated binomial: Chimpanzees again, condensed.</a></li>
<li class="chapter" data-level="10.1.3" data-path="counting-and-classification.html"><a href="counting-and-classification.html#aggregated-binomial-graduate-school-admissions."><i class="fa fa-check"></i><b>10.1.3</b> Aggregated binomial: Graduate school admissions.</a></li>
<li class="chapter" data-level="10.1.4" data-path="counting-and-classification.html"><a href="counting-and-classification.html#fitting-binomial-regressions-with-glm."><i class="fa fa-check"></i><b>10.1.4</b> Fitting binomial regressions with <code>glm()</code>.</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#poisson-regression"><i class="fa fa-check"></i><b>10.2</b> Poisson regression</a><ul>
<li class="chapter" data-level="10.2.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#example-oceanic-tool-complexity."><i class="fa fa-check"></i><b>10.2.1</b> Example: Oceanic tool complexity.</a></li>
<li class="chapter" data-level="10.2.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#mcmc-islands."><i class="fa fa-check"></i><b>10.2.2</b> MCMC islands.</a></li>
<li class="chapter" data-level="10.2.3" data-path="counting-and-classification.html"><a href="counting-and-classification.html#example-exposure-and-the-offset."><i class="fa fa-check"></i><b>10.2.3</b> Example: Exposure and the offset.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="counting-and-classification.html"><a href="counting-and-classification.html#other-count-regressions"><i class="fa fa-check"></i><b>10.3</b> Other count regressions</a><ul>
<li class="chapter" data-level="10.3.1" data-path="counting-and-classification.html"><a href="counting-and-classification.html#multinomial."><i class="fa fa-check"></i><b>10.3.1</b> Multinomial.</a></li>
<li class="chapter" data-level="10.3.2" data-path="counting-and-classification.html"><a href="counting-and-classification.html#geometric."><i class="fa fa-check"></i><b>10.3.2</b> Geometric.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="counting-and-classification.html"><a href="counting-and-classification.html#summary"><i class="fa fa-check"></i><b>10.4</b> Summary</a></li>
<li class="chapter" data-level="" data-path="counting-and-classification.html"><a href="counting-and-classification.html#reference-9"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="counting-and-classification.html"><a href="counting-and-classification.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html"><i class="fa fa-check"></i><b>11</b> Monsters and Mixtures</a><ul>
<li class="chapter" data-level="11.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i><b>11.1</b> Ordered categorical outcomes</a><ul>
<li class="chapter" data-level="11.1.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-moral-intuition."><i class="fa fa-check"></i><b>11.1.1</b> Example: Moral intuition.</a></li>
<li class="chapter" data-level="11.1.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#describing-an-ordered-distribution-with-intercepts."><i class="fa fa-check"></i><b>11.1.2</b> Describing an ordered distribution with intercepts.</a></li>
<li class="chapter" data-level="11.1.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#adding-predictor-variables."><i class="fa fa-check"></i><b>11.1.3</b> Adding predictor variables.</a></li>
<li class="chapter" data-level="11.1.4" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#bonus-figure-11.3-alternative."><i class="fa fa-check"></i><b>11.1.4</b> Bonus: Figure 11.3 alternative.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i><b>11.2</b> Zero-inflated outcomes</a><ul>
<li class="chapter" data-level="11.2.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-zero-inflated-poisson."><i class="fa fa-check"></i><b>11.2.1</b> Example: Zero-inflated Poisson.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersed-outcomes"><i class="fa fa-check"></i><b>11.3</b> Over-dispersed outcomes</a><ul>
<li class="chapter" data-level="11.3.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#beta-binomial."><i class="fa fa-check"></i><b>11.3.1</b> Beta-binomial.</a></li>
<li class="chapter" data-level="11.3.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#negative-binomial-or-gamma-poisson."><i class="fa fa-check"></i><b>11.3.2</b> Negative-binomial or gamma-Poisson.</a></li>
<li class="chapter" data-level="11.3.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersion-entropy-and-information-criteria."><i class="fa fa-check"></i><b>11.3.3</b> Over-dispersion, entropy, and information criteria.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#reference-10"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multilevel-models.html"><a href="multilevel-models.html"><i class="fa fa-check"></i><b>12</b> Multilevel Models</a><ul>
<li class="chapter" data-level="12.1" data-path="multilevel-models.html"><a href="multilevel-models.html#example-multilevel-tadpoles"><i class="fa fa-check"></i><b>12.1</b> Example: Multilevel tadpoles</a></li>
<li class="chapter" data-level="12.2" data-path="multilevel-models.html"><a href="multilevel-models.html#varying-effects-and-the-underfittingoverfitting-trade-off"><i class="fa fa-check"></i><b>12.2</b> Varying effects and the underfitting/overfitting trade-off</a><ul>
<li class="chapter" data-level="12.2.1" data-path="multilevel-models.html"><a href="multilevel-models.html#the-model.-1"><i class="fa fa-check"></i><b>12.2.1</b> The model.</a></li>
<li class="chapter" data-level="12.2.2" data-path="multilevel-models.html"><a href="multilevel-models.html#assign-values-to-the-parameters."><i class="fa fa-check"></i><b>12.2.2</b> Assign values to the parameters.</a></li>
<li class="chapter" data-level="12.2.3" data-path="multilevel-models.html"><a href="multilevel-models.html#sumulate-survivors."><i class="fa fa-check"></i><b>12.2.3</b> Sumulate survivors.</a></li>
<li class="chapter" data-level="12.2.4" data-path="multilevel-models.html"><a href="multilevel-models.html#compute-the-no-pooling-estimates."><i class="fa fa-check"></i><b>12.2.4</b> Compute the no-pooling estimates.</a></li>
<li class="chapter" data-level="12.2.5" data-path="multilevel-models.html"><a href="multilevel-models.html#compute-the-partial-pooling-estimates."><i class="fa fa-check"></i><b>12.2.5</b> Compute the partial-pooling estimates.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="multilevel-models.html"><a href="multilevel-models.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>12.3</b> More than one type of cluster</a><ul>
<li class="chapter" data-level="12.3.1" data-path="multilevel-models.html"><a href="multilevel-models.html#multilevel-chimpanzees."><i class="fa fa-check"></i><b>12.3.1</b> Multilevel chimpanzees.</a></li>
<li class="chapter" data-level="12.3.2" data-path="multilevel-models.html"><a href="multilevel-models.html#two-types-of-cluster."><i class="fa fa-check"></i><b>12.3.2</b> Two types of cluster.</a></li>
<li class="chapter" data-level="12.3.3" data-path="multilevel-models.html"><a href="multilevel-models.html#even-more-clusters."><i class="fa fa-check"></i><b>12.3.3</b> Even more clusters.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="multilevel-models.html"><a href="multilevel-models.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>12.4</b> Multilevel posterior predictions</a><ul>
<li class="chapter" data-level="12.4.1" data-path="multilevel-models.html"><a href="multilevel-models.html#posterior-prediction-for-same-clusters."><i class="fa fa-check"></i><b>12.4.1</b> Posterior prediction for same clusters.</a></li>
<li class="chapter" data-level="12.4.2" data-path="multilevel-models.html"><a href="multilevel-models.html#posterior-prediction-for-new-clusters."><i class="fa fa-check"></i><b>12.4.2</b> Posterior prediction for new clusters.</a></li>
<li class="chapter" data-level="12.4.3" data-path="multilevel-models.html"><a href="multilevel-models.html#focus-and-multilevel-prediction."><i class="fa fa-check"></i><b>12.4.3</b> Focus and multilevel prediction.</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="multilevel-models.html"><a href="multilevel-models.html#summary-bonus-put-your-random-effects-to-work"><i class="fa fa-check"></i><b>12.5</b> <del>Summary</del> Bonus: Put your random effects to work</a><ul>
<li class="chapter" data-level="12.5.1" data-path="multilevel-models.html"><a href="multilevel-models.html#intercepts-only-models-with-one-or-two-grouping-variables"><i class="fa fa-check"></i><b>12.5.1</b> Intercepts-only models with one or two grouping variables</a></li>
<li class="chapter" data-level="12.5.2" data-path="multilevel-models.html"><a href="multilevel-models.html#brmsposterior_samples"><i class="fa fa-check"></i><b>12.5.2</b> <code>brms::posterior_samples()</code></a></li>
<li class="chapter" data-level="12.5.3" data-path="multilevel-models.html"><a href="multilevel-models.html#brmscoef"><i class="fa fa-check"></i><b>12.5.3</b> <code>brms::coef()</code></a></li>
<li class="chapter" data-level="12.5.4" data-path="multilevel-models.html"><a href="multilevel-models.html#brmsfitted"><i class="fa fa-check"></i><b>12.5.4</b> <code>brms::fitted()</code></a></li>
<li class="chapter" data-level="12.5.5" data-path="multilevel-models.html"><a href="multilevel-models.html#tidybayesspread_draws"><i class="fa fa-check"></i><b>12.5.5</b> <code>tidybayes::spread_draws()</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multilevel-models.html"><a href="multilevel-models.html#reference-11"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="multilevel-models.html"><a href="multilevel-models.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html"><i class="fa fa-check"></i><b>13</b> Adventures in Covariance</a><ul>
<li class="chapter" data-level="13.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>13.1</b> Varying slopes by construction</a><ul>
<li class="chapter" data-level="13.1.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-the-population."><i class="fa fa-check"></i><b>13.1.1</b> Simulate the population.</a></li>
<li class="chapter" data-level="13.1.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-observations."><i class="fa fa-check"></i><b>13.1.2</b> Simulate observations.</a></li>
<li class="chapter" data-level="13.1.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#the-varying-slopes-model."><i class="fa fa-check"></i><b>13.1.3</b> The varying slopes model.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-admission-decisions-and-gender"><i class="fa fa-check"></i><b>13.2</b> Example: Admission decisions and gender</a><ul>
<li class="chapter" data-level="13.2.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-intercepts."><i class="fa fa-check"></i><b>13.2.1</b> Varying intercepts.</a></li>
<li class="chapter" data-level="13.2.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-effects-of-being-male."><i class="fa fa-check"></i><b>13.2.2</b> Varying effects of being <code>male</code>.</a></li>
<li class="chapter" data-level="13.2.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#shrinkage."><i class="fa fa-check"></i><b>13.2.3</b> Shrinkage.</a></li>
<li class="chapter" data-level="13.2.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#model-comparison.-1"><i class="fa fa-check"></i><b>13.2.4</b> Model comparison.</a></li>
<li class="chapter" data-level="13.2.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#more-slopes."><i class="fa fa-check"></i><b>13.2.5</b> More slopes.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-cross-classified-chimpanzees-with-varying-slopes"><i class="fa fa-check"></i><b>13.3</b> Example: Cross-classified <code>chimpanzees</code> with varying slopes</a></li>
<li class="chapter" data-level="13.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>13.4</b> Continuous categories and the Gaussian process</a><ul>
<li class="chapter" data-level="13.4.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools."><i class="fa fa-check"></i><b>13.4.1</b> Example: Spatial autocorrelation in Oceanic tools.</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#summary-bonus-another-berkley-admissions-data-like-example."><i class="fa fa-check"></i><b>13.5</b> <del>Summary</del> Bonus: Another Berkley-admissions-data-like example.</a></li>
<li class="chapter" data-level="" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#reference-12"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html"><i class="fa fa-check"></i><b>14</b> Missing Data and Other Opportunities</a><ul>
<li class="chapter" data-level="14.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#measurement-error"><i class="fa fa-check"></i><b>14.1</b> Measurement error</a><ul>
<li class="chapter" data-level="14.1.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#error-on-the-outcome."><i class="fa fa-check"></i><b>14.1.1</b> Error on the outcome.</a></li>
<li class="chapter" data-level="14.1.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#error-on-both-outcome-and-predictor."><i class="fa fa-check"></i><b>14.1.2</b> Error on both outcome and predictor.</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#missing-data"><i class="fa fa-check"></i><b>14.2</b> Missing data</a><ul>
<li class="chapter" data-level="14.2.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#imputing-neocortex"><i class="fa fa-check"></i><b>14.2.1</b> Imputing <code>neocortex</code></a></li>
<li class="chapter" data-level="14.2.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#improving-the-imputation-model"><i class="fa fa-check"></i><b>14.2.2</b> Improving the imputation model</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#summary-bonus-meta-analysis"><i class="fa fa-check"></i><b>14.3</b> <del>Summary</del> Bonus: Meta-analysis</a></li>
<li class="chapter" data-level="" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#reference-13"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html"><i class="fa fa-check"></i><b>15</b> <del>Horoscopes</del> Insights</a><ul>
<li class="chapter" data-level="15.1" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#use-r-notebooks"><i class="fa fa-check"></i><b>15.1</b> Use R Notebooks</a></li>
<li class="chapter" data-level="15.2" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#save-your-model-fits"><i class="fa fa-check"></i><b>15.2</b> Save your model fits</a></li>
<li class="chapter" data-level="15.3" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#build-your-models-slowly"><i class="fa fa-check"></i><b>15.3</b> Build your models slowly</a></li>
<li class="chapter" data-level="15.4" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#look-at-your-data"><i class="fa fa-check"></i><b>15.4</b> Look at your data</a></li>
<li class="chapter" data-level="15.5" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#use-the-0-intercept-syntax"><i class="fa fa-check"></i><b>15.5</b> Use the <code>0 + Intercept</code> syntax</a></li>
<li class="chapter" data-level="15.6" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#annotate-your-workflow"><i class="fa fa-check"></i><b>15.6</b> Annotate your workflow</a></li>
<li class="chapter" data-level="15.7" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#annotate-your-code"><i class="fa fa-check"></i><b>15.7</b> Annotate your code</a></li>
<li class="chapter" data-level="15.8" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#break-up-your-workflow"><i class="fa fa-check"></i><b>15.8</b> Break up your workflow</a></li>
<li class="chapter" data-level="15.9" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#code-in-public"><i class="fa fa-check"></i><b>15.9</b> Code in public</a></li>
<li class="chapter" data-level="15.10" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#read-gelmans-blog"><i class="fa fa-check"></i><b>15.10</b> Read Gelman’s blog</a></li>
<li class="chapter" data-level="15.11" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#check-out-other-social-media-too"><i class="fa fa-check"></i><b>15.11</b> Check out other social media, too</a></li>
<li class="chapter" data-level="15.12" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#parting-wisdom"><i class="fa fa-check"></i><b>15.12</b> Parting wisdom</a></li>
<li class="chapter" data-level="" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#reference-14"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Statistical Rethinking</em> with brms, ggplot2, and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sampling-the-imaginary" class="section level1">
<h1><span class="header-section-number">3</span> Sampling the Imaginary</h1>
<p>If you would like to know the probability someone is a vampire given they test positive to the blood-based vampire test, you compute</p>
<p><span class="math display">\[\text{Pr(vampire|positive)} = \frac{\text{Pr(positive|vampire) Pr(vampire)}}{\text{Pr(positive)}}.\]</span></p>
<p>We’ll do so within a tibble.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb76-2" data-line-number="2"></a>
<a class="sourceLine" id="cb76-3" data-line-number="3"><span class="kw">tibble</span>(<span class="dt">pr_positive_vampire =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb76-4" data-line-number="4">       <span class="dt">pr_positive_mortal  =</span> <span class="fl">.01</span>,</a>
<a class="sourceLine" id="cb76-5" data-line-number="5">       <span class="dt">pr_vampire          =</span> <span class="fl">.001</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pr_positive =</span> pr_positive_vampire <span class="op">*</span><span class="st"> </span>pr_vampire <span class="op">+</span><span class="st"> </span>pr_positive_mortal <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pr_vampire)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pr_vampire_positive =</span> pr_positive_vampire <span class="op">*</span><span class="st"> </span>pr_vampire <span class="op">/</span><span class="st"> </span>pr_positive) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb76-8" data-line-number="8"><span class="st">  </span><span class="kw">glimpse</span>()</a></code></pre></div>
<pre><code>## Observations: 1
## Variables: 5
## $ pr_positive_vampire &lt;dbl&gt; 0.95
## $ pr_positive_mortal  &lt;dbl&gt; 0.01
## $ pr_vampire          &lt;dbl&gt; 0.001
## $ pr_positive         &lt;dbl&gt; 0.01094
## $ pr_vampire_positive &lt;dbl&gt; 0.08683729</code></pre>
<p>Here’s the other way of tackling the vampire problem, this time using the frequency format.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">pr_vampire          =</span> <span class="dv">100</span> <span class="op">/</span><span class="st"> </span><span class="dv">100000</span>,</a>
<a class="sourceLine" id="cb78-2" data-line-number="2">       <span class="dt">pr_positive_vampire =</span> <span class="dv">95</span> <span class="op">/</span><span class="st"> </span><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb78-3" data-line-number="3">       <span class="dt">pr_positive_mortal  =</span> <span class="dv">99</span> <span class="op">/</span><span class="st"> </span><span class="dv">99900</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pr_positive =</span> <span class="dv">95</span> <span class="op">+</span><span class="st"> </span><span class="dv">999</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pr_vampire_positive =</span> pr_positive_vampire <span class="op">*</span><span class="st"> </span><span class="dv">100</span> <span class="op">/</span><span class="st"> </span>pr_positive) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-6" data-line-number="6"><span class="st">  </span><span class="kw">glimpse</span>()</a></code></pre></div>
<pre><code>## Observations: 1
## Variables: 5
## $ pr_vampire          &lt;dbl&gt; 0.001
## $ pr_positive_vampire &lt;dbl&gt; 0.95
## $ pr_positive_mortal  &lt;dbl&gt; 0.000990991
## $ pr_positive         &lt;dbl&gt; 1094
## $ pr_vampire_positive &lt;dbl&gt; 0.08683729</code></pre>
<blockquote>
<p>The posterior distribution is a probability distribution. And like all probability distributions, we can imagine drawing <em>samples</em> form it. The sampled events in this case are parameter values. Most parameters have no exact empirical realization. The Bayesian formalism treats parameter distributions as relative plausibility, not as any physical random process. In any event, randomness is always a property of information, never of the real world. But inside the computer, parameters are just as empirical as the outcome of a coin flip or a die toss or an agricultural experiment. The posterior defines the expected frequency that different parameter values will appear, once we start plucking parameters out of it. (p. 50, <em>emphasis</em> in the original)</p>
</blockquote>
<div id="sampling-from-a-grid-like-approximate-posterior" class="section level2">
<h2><span class="header-section-number">3.1</span> Sampling from a grid-like approximate posterior</h2>
<p>Once again, here we use grid approximation to generate samples.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="co"># how many grid points would you like?</span></a>
<a class="sourceLine" id="cb80-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">1001</span></a>
<a class="sourceLine" id="cb80-3" data-line-number="3">n_success &lt;-<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb80-4" data-line-number="4">n_trials  &lt;-<span class="st"> </span><span class="dv">9</span></a>
<a class="sourceLine" id="cb80-5" data-line-number="5"></a>
<a class="sourceLine" id="cb80-6" data-line-number="6">(</a>
<a class="sourceLine" id="cb80-7" data-line-number="7">  d &lt;-</a>
<a class="sourceLine" id="cb80-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">p_grid =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> n),</a>
<a class="sourceLine" id="cb80-9" data-line-number="9">         <span class="co"># note we&#39;re still using a flat uniform prior</span></a>
<a class="sourceLine" id="cb80-10" data-line-number="10">         <span class="dt">prior  =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb80-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">dbinom</span>(n_success, <span class="dt">size =</span> n_trials, <span class="dt">prob =</span> p_grid)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb80-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior =</span> (likelihood <span class="op">*</span><span class="st"> </span>prior) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood <span class="op">*</span><span class="st"> </span>prior))</a>
<a class="sourceLine" id="cb80-13" data-line-number="13">)</a></code></pre></div>
<pre><code>## # A tibble: 1,001 x 4
##    p_grid prior likelihood posterior
##     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1  0         1   0.        0.      
##  2  0.001     1   8.37e-17  8.37e-19
##  3  0.002     1   5.34e-15  5.34e-17
##  4  0.003     1   6.07e-14  6.07e-16
##  5  0.004     1   3.40e-13  3.40e-15
##  6  0.005     1   1.29e-12  1.29e-14
##  7  0.006     1   3.85e-12  3.85e-14
##  8  0.007     1   9.68e-12  9.68e-14
##  9  0.008     1   2.15e-11  2.15e-13
## 10  0.009     1   4.34e-11  4.34e-13
## # … with 991 more rows</code></pre>
<p>Now we’ll use the <code>dplyr::sample_n()</code> function to sample rows from <code>d</code>, saving them as <code>sample</code>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="co"># how many samples would you like?</span></a>
<a class="sourceLine" id="cb82-2" data-line-number="2">n_samples &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb82-3" data-line-number="3"></a>
<a class="sourceLine" id="cb82-4" data-line-number="4"><span class="co"># make it reproducible</span></a>
<a class="sourceLine" id="cb82-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb82-6" data-line-number="6"></a>
<a class="sourceLine" id="cb82-7" data-line-number="7">samples &lt;-</a>
<a class="sourceLine" id="cb82-8" data-line-number="8"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb82-9" data-line-number="9"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> n_samples, <span class="dt">weight =</span> posterior, <span class="dt">replace =</span> T)</a>
<a class="sourceLine" id="cb82-10" data-line-number="10"></a>
<a class="sourceLine" id="cb82-11" data-line-number="11"><span class="kw">glimpse</span>(samples)</a></code></pre></div>
<pre><code>## Observations: 10,000
## Variables: 4
## $ p_grid     &lt;dbl&gt; 0.564, 0.651, 0.487, 0.592, 0.596, 0.787, 0.727, 0.490, 0.751, 0.449, 0.619, 0…
## $ prior      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ likelihood &lt;dbl&gt; 0.224085305, 0.271795022, 0.151288232, 0.245578315, 0.248256678, 0.192870804, …
## $ posterior  &lt;dbl&gt; 2.240853e-03, 2.717950e-03, 1.512882e-03, 2.455783e-03, 2.482567e-03, 1.928708…</code></pre>
<p>We’ll plot the zigzagging left panel of Figure 3.1 with <code>geom_line()</code>. But before we do, we’ll need to add a variable numbering the samples.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample_number =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb84-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sample_number, <span class="dt">y =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb84-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb84-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb84-7" data-line-number="7"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;sample number&quot;</span>)</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-6-1.png" width="336" /></p>
<p>We’ll make the density in the right panel with <code>geom_density()</code>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb85-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb85-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-7-1.png" width="336" /></p>
<p>That was based on <code>1e4</code> samples. On page 53, McElreath said the density would converge on the idealized shape if we keep increasing the number of samples. Here’s what it looks like with <code>1e6</code>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb86-2" data-line-number="2"></a>
<a class="sourceLine" id="cb86-3" data-line-number="3">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-4" data-line-number="4"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> <span class="fl">1e6</span>, <span class="dt">weight =</span> posterior, <span class="dt">replace =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb86-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb86-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-8-1.png" width="336" /></p>
<p>Yep, that’s more ideal.</p>
</div>
<div id="sampling-to-summarize" class="section level2">
<h2><span class="header-section-number">3.2</span> Sampling to summarize</h2>
<p>“Once your model produces a posterior distribution, the model’s work is done. But your work has just begun. It is necessary to summarize and interpret the posterior distribution. Exactly how it is summarized depends upon your purpose” (p. 53).</p>
<div id="intervals-of-defined-boundaries." class="section level3">
<h3><span class="header-section-number">3.2.1</span> Intervals of defined boundaries.</h3>
<p>To get the proportion of water less than some value of <code>p_grid</code> within the tidyverse, you might first <code>filter()</code> by that value and then take the <code>sum()</code> within <code>summarise()</code>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(p_grid <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">sum =</span> <span class="kw">sum</span>(posterior))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##     sum
##   &lt;dbl&gt;
## 1 0.171</code></pre>
<p>To learn more about <code>dplyr::summarise()</code> and related functions, check out Baert’s <a href="https://suzan.rbind.io/2018/04/dplyr-tutorial-4/"><em>Data Wrangling Part 4: Summarizing and slicing your data</em></a> and <a href="https://r4ds.had.co.nz/transform.html#grouped-summaries-with-summarise">Chapter 5.6</a> of <em>R4DS</em>.</p>
<p>If what you want is a frequency based on filtering by <code>samples</code>, then you might use <code>n()</code> within <code>summarise()</code>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">samples <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb89-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(p_grid <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb89-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">sum =</span> <span class="kw">n</span>() <span class="op">/</span><span class="st"> </span>n_samples)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##     sum
##   &lt;dbl&gt;
## 1 0.162</code></pre>
<p>A more explicit approach for the same computation is to follow up <code>count()</code> with <code>mutate()</code>.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(p_grid <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">probability =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n))</a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   `p_grid &lt; 0.5`     n probability
##   &lt;lgl&gt;          &lt;int&gt;       &lt;dbl&gt;
## 1 FALSE           8377       0.838
## 2 TRUE            1623       0.162</code></pre>
<p>And an even trickier approach for the same is to insert the logical statement <code>p_grid &lt; .5</code> within the <code>mean()</code> function.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">samples <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb93-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">sum =</span> <span class="kw">mean</span>(p_grid <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##     sum
##   &lt;dbl&gt;
## 1 0.162</code></pre>
<p>Much like McElreath discussed in the <strong>Overthinking: Counting with</strong> <code>sum</code> box, this works “because R internally converts a logical expression, like <code>samples &lt; 0/5</code>, to a vector of <code>TRUE</code> and <code>FALSE</code> results, one for each element of <code>samples</code>, saying whether or not each element matches the criterion” (p. 54). When we inserted that vector of <code>TRUE</code> and <code>FALSE</code> values within the <code>mean()</code> function, they were then internally converted to a vector of 1s and 0s, the mean of which was the probability. Tricky!</p>
<p>To determine the posterior probability between 0.5 and 0.75, you can use <code>&amp;</code> within <code>filter()</code>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb95-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(p_grid <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> <span class="op">&amp;</span><span class="st"> </span>p_grid <span class="op">&lt;</span><span class="st"> </span><span class="fl">.75</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb95-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">sum =</span> <span class="kw">n</span>() <span class="op">/</span><span class="st"> </span>n_samples)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##     sum
##   &lt;dbl&gt;
## 1 0.602</code></pre>
<p>Just multiply that value by 100 to get a percent.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb97-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(p_grid <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> <span class="op">&amp;</span><span class="st"> </span>p_grid <span class="op">&lt;</span><span class="st"> </span><span class="fl">.75</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb97-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">sum     =</span>       <span class="kw">n</span>() <span class="op">/</span><span class="st"> </span>n_samples,</a>
<a class="sourceLine" id="cb97-4" data-line-number="4">            <span class="dt">percent =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="kw">n</span>() <span class="op">/</span><span class="st"> </span>n_samples)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##     sum percent
##   &lt;dbl&gt;   &lt;dbl&gt;
## 1 0.602    60.2</code></pre>
<p>And, of course, you can do that with our <code>mean()</code> trick, too.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1">samples <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb99-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">percent =</span> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(p_grid <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> <span class="op">&amp;</span><span class="st"> </span>p_grid <span class="op">&lt;</span><span class="st"> </span><span class="fl">.75</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   percent
##     &lt;dbl&gt;
## 1    60.2</code></pre>
</div>
<div id="intervals-of-defined-mass." class="section level3">
<h3><span class="header-section-number">3.2.2</span> Intervals of defined mass.</h3>
<p>We’ll create the upper two panels for Figure 3.2 with <code>geom_line()</code>, <code>geom_ribbon()</code>, some careful filtering, and a little patchwork syntax.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="co"># upper left panel</span></a>
<a class="sourceLine" id="cb101-2" data-line-number="2">p1 &lt;-</a>
<a class="sourceLine" id="cb101-3" data-line-number="3"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(p_grid <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb101-7" data-line-number="7">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</a>
<a class="sourceLine" id="cb101-9" data-line-number="9">       <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</a>
<a class="sourceLine" id="cb101-10" data-line-number="10"></a>
<a class="sourceLine" id="cb101-11" data-line-number="11"><span class="co"># upper right panel</span></a>
<a class="sourceLine" id="cb101-12" data-line-number="12">p2 &lt;-</a>
<a class="sourceLine" id="cb101-13" data-line-number="13"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-16" data-line-number="16"><span class="st">  </span><span class="co"># note this next line is the only difference in code from the last plot</span></a>
<a class="sourceLine" id="cb101-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(p_grid <span class="op">&lt;</span><span class="st"> </span><span class="fl">.75</span> <span class="op">&amp;</span><span class="st"> </span>p_grid <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb101-18" data-line-number="18">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</a>
<a class="sourceLine" id="cb101-20" data-line-number="20">       <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</a>
<a class="sourceLine" id="cb101-21" data-line-number="21"></a>
<a class="sourceLine" id="cb101-22" data-line-number="22"><span class="kw">library</span>(patchwork)</a>
<a class="sourceLine" id="cb101-23" data-line-number="23"></a>
<a class="sourceLine" id="cb101-24" data-line-number="24">p1 <span class="op">+</span><span class="st"> </span>p2</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-16-1.png" width="576" /></p>
<p>We’ll come back for the lower two panels in a bit.</p>
<p>Since we saved our <code>p_grid</code> samples within the well-named <code>samples</code> tibble, we’ll have to index with <code>$</code> within <code>quantile</code>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1">(q_<span class="dv">80</span> &lt;-<span class="st"> </span><span class="kw">quantile</span>(samples<span class="op">$</span>p_grid, <span class="dt">prob =</span> <span class="fl">.8</span>))</a></code></pre></div>
<pre><code>##   80% 
## 0.763</code></pre>
<p>That value will come in handy for the lower left panel of Figure 3.2. But anyways, we could <code>select()</code> the <code>samples</code> vector, extract it from the tibble with <code>pull()</code>, and then pump it into <code>quantile()</code>.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-2" data-line-number="2"><span class="st">  </span><span class="kw">pull</span>(p_grid) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-3" data-line-number="3"><span class="st">  </span><span class="kw">quantile</span>(<span class="dt">prob =</span> <span class="fl">.8</span>)</a></code></pre></div>
<pre><code>##   80% 
## 0.763</code></pre>
<p>And we might also use <code>quantile()</code> within <code>summarise()</code>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb106-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">80th percentile</span><span class="st">`</span> =<span class="st"> </span><span class="kw">quantile</span>(p_grid, <span class="dt">p =</span> <span class="fl">.8</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   `80th percentile`
##               &lt;dbl&gt;
## 1             0.763</code></pre>
<p>Here’s the <code>summarise()</code> approach with two probabilities:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">10th percentile</span><span class="st">`</span> =<span class="st"> </span><span class="kw">quantile</span>(p_grid, <span class="dt">p =</span> <span class="fl">.1</span>),</a>
<a class="sourceLine" id="cb108-3" data-line-number="3">            <span class="st">`</span><span class="dt">90th percentile</span><span class="st">`</span> =<span class="st"> </span><span class="kw">quantile</span>(p_grid, <span class="dt">p =</span> <span class="fl">.9</span>))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   `10th percentile` `90th percentile`
##               &lt;dbl&gt;             &lt;dbl&gt;
## 1             0.452             0.814</code></pre>
<p>The tydiverse approach is nice in that that family of functions typically returns a data frame. But sometimes you just want your values in a numeric vector for the sake of quick indexing. In that case, base R <code>quantile()</code> shines.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">(q_<span class="dv">10</span>_and_<span class="dv">90</span> &lt;-<span class="st"> </span><span class="kw">quantile</span>(samples<span class="op">$</span>p_grid, <span class="dt">prob =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">.9</span>)))</a></code></pre></div>
<pre><code>##    10%    90% 
## 0.4520 0.8141</code></pre>
<p>Now we have our cutoff values saved as <code>q_80</code> and <code>q_10_and_90</code>, we’re ready to make the bottom panels of Figure 3.2.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="co"># lower left panel</span></a>
<a class="sourceLine" id="cb112-2" data-line-number="2">p1 &lt;-</a>
<a class="sourceLine" id="cb112-3" data-line-number="3"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb112-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(p_grid <span class="op">&lt;</span><span class="st"> </span>q_<span class="dv">80</span>),</a>
<a class="sourceLine" id="cb112-7" data-line-number="7">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-8" data-line-number="8"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</a>
<a class="sourceLine" id="cb112-9" data-line-number="9">           <span class="dt">x =</span> <span class="fl">.25</span>, <span class="dt">y =</span> <span class="fl">.0025</span>,</a>
<a class="sourceLine" id="cb112-10" data-line-number="10">           <span class="dt">label =</span> <span class="st">&quot;lower 80%&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</a>
<a class="sourceLine" id="cb112-12" data-line-number="12">       <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</a>
<a class="sourceLine" id="cb112-13" data-line-number="13"></a>
<a class="sourceLine" id="cb112-14" data-line-number="14"><span class="co"># lower right panel</span></a>
<a class="sourceLine" id="cb112-15" data-line-number="15">p2 &lt;-</a>
<a class="sourceLine" id="cb112-16" data-line-number="16"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb112-17" data-line-number="17"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(p_grid <span class="op">&gt;</span><span class="st"> </span>q_<span class="dv">10</span>_and_<span class="dv">90</span>[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>p_grid <span class="op">&lt;</span><span class="st"> </span>q_<span class="dv">10</span>_and_<span class="dv">90</span>[<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb112-20" data-line-number="20">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-21" data-line-number="21"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</a>
<a class="sourceLine" id="cb112-22" data-line-number="22">           <span class="dt">x =</span> <span class="fl">.25</span>, <span class="dt">y =</span> <span class="fl">.0025</span>,</a>
<a class="sourceLine" id="cb112-23" data-line-number="23">           <span class="dt">label =</span> <span class="st">&quot;middle 80%&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb112-24" data-line-number="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</a>
<a class="sourceLine" id="cb112-25" data-line-number="25">       <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</a>
<a class="sourceLine" id="cb112-26" data-line-number="26"></a>
<a class="sourceLine" id="cb112-27" data-line-number="27">p1 <span class="op">+</span><span class="st"> </span>p2</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-22-1.png" width="576" /></p>
<p>We’ve already defined <code>p_grid</code> and <code>prior</code> within <code>d</code>, above. Here we’ll reuse them and update the rest of the columns.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" data-line-number="1"><span class="co"># here we update the `dbinom()` parameters</span></a>
<a class="sourceLine" id="cb113-2" data-line-number="2">n_success &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb113-3" data-line-number="3">n_trials  &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb113-4" data-line-number="4"></a>
<a class="sourceLine" id="cb113-5" data-line-number="5"><span class="co"># update `d`</span></a>
<a class="sourceLine" id="cb113-6" data-line-number="6">d &lt;-</a>
<a class="sourceLine" id="cb113-7" data-line-number="7"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">dbinom</span>(n_success, <span class="dt">size =</span> n_trials, <span class="dt">prob =</span> p_grid)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior  =</span> (likelihood <span class="op">*</span><span class="st"> </span>prior) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(posterior))</a>
<a class="sourceLine" id="cb113-10" data-line-number="10"></a>
<a class="sourceLine" id="cb113-11" data-line-number="11"><span class="co"># make the next part reproducible</span></a>
<a class="sourceLine" id="cb113-12" data-line-number="12"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb113-13" data-line-number="13"></a>
<a class="sourceLine" id="cb113-14" data-line-number="14"><span class="co"># here&#39;s our new samples tibble</span></a>
<a class="sourceLine" id="cb113-15" data-line-number="15">(</a>
<a class="sourceLine" id="cb113-16" data-line-number="16">  samples &lt;-</a>
<a class="sourceLine" id="cb113-17" data-line-number="17"><span class="st">    </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-18" data-line-number="18"><span class="st">    </span><span class="kw">sample_n</span>(<span class="dt">size =</span> n_samples, <span class="dt">weight =</span> posterior, <span class="dt">replace =</span> T)</a>
<a class="sourceLine" id="cb113-19" data-line-number="19">)</a></code></pre></div>
<pre><code>## # A tibble: 10,000 x 4
##    p_grid prior likelihood posterior
##     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1  0.716     1     0.367     0.367 
##  2  0.651     1     0.276     0.276 
##  3  0.547     1     0.164     0.164 
##  4  0.999     1     0.997     0.997 
##  5  0.99      1     0.970     0.970 
##  6  0.787     1     0.487     0.487 
##  7  0.94      1     0.831     0.831 
##  8  0.817     1     0.545     0.545 
##  9  0.955     1     0.871     0.871 
## 10  0.449     1     0.0905    0.0905
## # … with 9,990 more rows</code></pre>
<p>The <code>rethinking::PI()</code> function works like a nice shorthand for <code>quantile()</code>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1"><span class="kw">quantile</span>(samples<span class="op">$</span>p_grid, <span class="dt">prob =</span> <span class="kw">c</span>(.<span class="dv">25</span>, <span class="fl">.75</span>))</a></code></pre></div>
<pre><code>##   25%   75% 
## 0.709 0.935</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1">rethinking<span class="op">::</span><span class="kw">PI</span>(samples<span class="op">$</span>p_grid, <span class="dt">prob =</span> <span class="fl">.5</span>)</a></code></pre></div>
<pre><code>##   25%   75% 
## 0.709 0.935</code></pre>
<p>Now’s a good time to introduce Matthew Kay’s <a href="https://mjskay.github.io/tidybayes/">tidybayes package</a>, which offers an <a href="https://cran.r-project.org/package=tidybayes/vignettes/tidy-brms.html">array of convenience functions</a> for summarizing Bayesian models of the type we’ll be working with in this project.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1"><span class="kw">library</span>(tidybayes)</a>
<a class="sourceLine" id="cb119-2" data-line-number="2"></a>
<a class="sourceLine" id="cb119-3" data-line-number="3"><span class="kw">median_qi</span>(samples<span class="op">$</span>p_grid, <span class="dt">.width =</span> <span class="fl">.5</span>)</a></code></pre></div>
<pre><code>##       y  ymin  ymax .width .point .interval
## 1 0.843 0.709 0.935    0.5 median        qi</code></pre>
<p>The tidybayes package offers a <a href="https://cran.r-project.org/package=tidybayes/vignettes/tidybayes.html#point-summaries-and-intervals-with-the-point_interval-functions-medianmeanmode_qihdi">family of functions</a> that make it easy to summarize a distribution with a measure of central tendency accompanied by intervals. With <code>median_qi()</code>, we asked for the median and quantile-based intervals–just like we’ve been doing with <code>quantile()</code>. Note how the <code>.width</code> argument within <code>median_qi()</code> worked the same way the <code>prob</code> argument did within <code>rethinking::PI()</code>. With <code>.width = .5</code>, we indicated we wanted a quantile-based 50% interval, which was returned in the <code>ymin</code> and <code>ymax</code> columns. The tidybayes framework makes it easy to request multiple types of intervals. E.g., here we’ll request 50%, 80%, and 99% intervals.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1"><span class="kw">median_qi</span>(samples<span class="op">$</span>p_grid, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.8</span>, <span class="fl">.99</span>))</a></code></pre></div>
<pre><code>##       y     ymin  ymax .width .point .interval
## 1 0.843 0.709000 0.935   0.50 median        qi
## 2 0.843 0.570000 0.975   0.80 median        qi
## 3 0.843 0.260985 0.999   0.99 median        qi</code></pre>
<p>The <code>.width</code> column in the output indexed which line presented which interval. The value in the <code>y</code> column remained constant across rows. That’s because that column listed the measure of central tendency, the median in this case.</p>
<p>Now let’s use the <code>rethinking::HPDI()</code> function to return 50% highest posterior density intervals (HPDIs).</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1">rethinking<span class="op">::</span><span class="kw">HPDI</span>(samples<span class="op">$</span>p_grid, <span class="dt">prob =</span> <span class="fl">.5</span>)</a></code></pre></div>
<pre><code>##  |0.5  0.5| 
## 0.842 0.999</code></pre>
<p>The reason I introduce tidybayes now is that the functions of the brms package only support percentile-based intervals of the type we computed with <code>quantile()</code> and <code>median_qi()</code>. But tidybayes also supports HPDIs.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" data-line-number="1"><span class="kw">mode_hdi</span>(samples<span class="op">$</span>p_grid, <span class="dt">.width =</span> <span class="fl">.5</span>)</a></code></pre></div>
<pre><code>##           y  ymin  ymax .width .point .interval
## 1 0.9562951 0.842 0.999    0.5   mode       hdi</code></pre>
<p>This time we used the mode as the measure of central tendency. With this family of tidybayes functions, you specify the measure of central tendency in the prefix (i.e., <code>mean</code>, <code>median</code>, or <code>mode</code>) and then the type of interval you’d like (i.e., <code>qi</code> or <code>hdi</code>).</p>
<p>If all you want are the intervals without the measure of central tendency or all that other technical information, tidybayes also offers the handy <code>qi()</code> and <code>hdi()</code> functions.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1"><span class="kw">qi</span>(samples<span class="op">$</span>p_grid, <span class="dt">.width =</span> <span class="fl">.5</span>)</a></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,] 0.709 0.935</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1"><span class="kw">hdi</span>(samples<span class="op">$</span>p_grid, <span class="dt">.width =</span> <span class="fl">.5</span>)</a></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,] 0.842 0.999</code></pre>
<p>These are nice in that they return simple numeric vectors, making them particularly useful to use as references within ggplot2. Now we have that skill, we can use it to make Figure 3.3.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" data-line-number="1"><span class="co"># lower left panel</span></a>
<a class="sourceLine" id="cb131-2" data-line-number="2">p1 &lt;-</a>
<a class="sourceLine" id="cb131-3" data-line-number="3"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb131-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb131-5" data-line-number="5"><span class="st">  </span><span class="co"># check out our sweet `qi()` indexing</span></a>
<a class="sourceLine" id="cb131-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(p_grid <span class="op">&gt;</span><span class="st"> </span><span class="kw">qi</span>(samples<span class="op">$</span>p_grid, <span class="dt">.width =</span> <span class="fl">.5</span>)[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb131-7" data-line-number="7"><span class="st">                                    </span>p_grid <span class="op">&lt;</span><span class="st"> </span><span class="kw">qi</span>(samples<span class="op">$</span>p_grid, <span class="dt">.width =</span> <span class="fl">.5</span>)[<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb131-8" data-line-number="8">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior),</a>
<a class="sourceLine" id="cb131-9" data-line-number="9">              <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb131-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb131-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;50% Percentile Interval&quot;</span>,</a>
<a class="sourceLine" id="cb131-12" data-line-number="12">       <span class="dt">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</a>
<a class="sourceLine" id="cb131-13" data-line-number="13">       <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</a>
<a class="sourceLine" id="cb131-14" data-line-number="14"></a>
<a class="sourceLine" id="cb131-15" data-line-number="15"><span class="co"># lower right panel</span></a>
<a class="sourceLine" id="cb131-16" data-line-number="16">p2 &lt;-</a>
<a class="sourceLine" id="cb131-17" data-line-number="17"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb131-18" data-line-number="18"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb131-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(p_grid <span class="op">&gt;</span><span class="st"> </span><span class="kw">hdi</span>(samples<span class="op">$</span>p_grid, <span class="dt">.width =</span> <span class="fl">.5</span>)[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb131-20" data-line-number="20"><span class="st">                                    </span>p_grid <span class="op">&lt;</span><span class="st"> </span><span class="kw">hdi</span>(samples<span class="op">$</span>p_grid, <span class="dt">.width =</span> <span class="fl">.5</span>)[<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb131-21" data-line-number="21">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior),</a>
<a class="sourceLine" id="cb131-22" data-line-number="22">              <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb131-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb131-24" data-line-number="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;50% HPDI&quot;</span>,</a>
<a class="sourceLine" id="cb131-25" data-line-number="25">       <span class="dt">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</a>
<a class="sourceLine" id="cb131-26" data-line-number="26">       <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</a>
<a class="sourceLine" id="cb131-27" data-line-number="27"></a>
<a class="sourceLine" id="cb131-28" data-line-number="28"><span class="co"># combine!</span></a>
<a class="sourceLine" id="cb131-29" data-line-number="29">p1 <span class="op">|</span><span class="st"> </span>p2</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-30-1.png" width="528" /></p>
<p>In the <code>geom_ribbon()</code> line for the HPDI plot, did you notice how we replaced <code>d</code> with <code>.</code>? When using the pipe (i.e., <code>%&gt;%</code>), you can use the <code>.</code> as a placeholder for the original data object. It’s an odd and handy trick to have. Go <a href="https://magrittr.tidyverse.org/reference/pipe.html">here</a> to learn more.</p>
<blockquote>
<p>The HPDI has some advantages over the PI. But in most cases, these two types of interval are very similar. They only look so different in this case because the posterior distribution is highly skewed. If we instead used samples from the posterior distribution for six waters in nine tosses, these intervals would be nearly identical. Try it for yourself, using different probability masses, such as <code>prob=0.8</code> and <code>prob=0.95</code>. When the posterior is bell shaped, it hardly matters when type of interval you use. (p. 57)</p>
</blockquote>
<p>Let’s try it out. First we’ll update the simulation for six waters in nine tosses.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1">n_success &lt;-<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb132-2" data-line-number="2">n_trials  &lt;-<span class="st"> </span><span class="dv">9</span></a>
<a class="sourceLine" id="cb132-3" data-line-number="3"></a>
<a class="sourceLine" id="cb132-4" data-line-number="4">new_d &lt;-</a>
<a class="sourceLine" id="cb132-5" data-line-number="5"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb132-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">dbinom</span>(n_success, <span class="dt">size =</span> n_trials, <span class="dt">prob =</span> p_grid)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb132-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior =</span> (likelihood <span class="op">*</span><span class="st"> </span>prior) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(posterior))</a>
<a class="sourceLine" id="cb132-8" data-line-number="8"></a>
<a class="sourceLine" id="cb132-9" data-line-number="9"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb132-10" data-line-number="10"></a>
<a class="sourceLine" id="cb132-11" data-line-number="11">new_samples &lt;-</a>
<a class="sourceLine" id="cb132-12" data-line-number="12"><span class="st">  </span>new_d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb132-13" data-line-number="13"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> n_samples, <span class="dt">weight =</span> posterior, <span class="dt">replace =</span> T)</a></code></pre></div>
<p>Here are the intervals by <code>.width</code> and type of <code>.interval</code>.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" data-line-number="1"><span class="kw">bind_rows</span>(<span class="kw">mean_hdi</span>(new_samples<span class="op">$</span>p_grid, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">8</span>, <span class="fl">.95</span>)),</a>
<a class="sourceLine" id="cb133-2" data-line-number="2">          <span class="kw">mean_qi</span>(new_samples<span class="op">$</span>p_grid,  <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">8</span>, <span class="fl">.95</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb133-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(.width, .interval, ymin<span class="op">:</span>ymax) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb133-4" data-line-number="4"><span class="st">  </span><span class="kw">arrange</span>(.width) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb133-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate_if</span>(is.double, round, <span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##   .width .interval ymin ymax
## 1   0.80       hdi 0.48 0.84
## 2   0.80        qi 0.45 0.81
## 3   0.95       hdi 0.37 0.90
## 4   0.95        qi 0.35 0.88</code></pre>
<p>We didn’t need that last <code>mutate_if()</code> line. It just made it easier to compare the <code>ymin</code> and <code>ymax</code> values. Anyway, McElreath was right. This time the differences between the HPDIs and QIs were trivial. Here’s a look at the posterior.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" data-line-number="1">new_d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb135-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb135-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb135-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;Six waters in nine tosses made</span><span class="ch">\n</span><span class="st">for a more symmetrical posterior&quot;</span>,</a>
<a class="sourceLine" id="cb135-5" data-line-number="5">       <span class="dt">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</a>
<a class="sourceLine" id="cb135-6" data-line-number="6">       <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>)</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-33-1.png" width="288" /></p>
</div>
<div id="point-estimates." class="section level3">
<h3><span class="header-section-number">3.2.3</span> Point estimates.</h3>
<p>We’ve been calling point estimates measures of central tendency. If we <code>arrange()</code> our <code>d</code> tibble in descending order by <code>posterior</code>, we’ll see the corresponding <code>p_grid</code> value for its MAP estimate.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb136-2" data-line-number="2"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(posterior))</a></code></pre></div>
<pre><code>## # A tibble: 1,001 x 4
##    p_grid prior likelihood posterior
##     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1  1         1      1         1    
##  2  0.999     1      0.997     0.997
##  3  0.998     1      0.994     0.994
##  4  0.997     1      0.991     0.991
##  5  0.996     1      0.988     0.988
##  6  0.995     1      0.985     0.985
##  7  0.994     1      0.982     0.982
##  8  0.993     1      0.979     0.979
##  9  0.992     1      0.976     0.976
## 10  0.991     1      0.973     0.973
## # … with 991 more rows</code></pre>
<p>To emphasize it, we can use <code>slice()</code> to select the top row.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb138-2" data-line-number="2"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(posterior)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb138-3" data-line-number="3"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   p_grid prior likelihood posterior
##    &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
## 1      1     1          1         1</code></pre>
<p>Or we could use the handy <code>dplyr::top_n()</code> function.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb140-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(posterior) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb140-3" data-line-number="3"><span class="st">  </span><span class="kw">top_n</span>(<span class="dt">n =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   posterior
##       &lt;dbl&gt;
## 1         1</code></pre>
<p>We can get the mode with <code>mode_hdi()</code> or <code>mode_qi()</code>.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mode_hdi</span>(p_grid)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 6
##   p_grid .lower .upper .width .point .interval
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1  0.956  0.477      1   0.95 mode   hdi</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mode_qi</span>(p_grid)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 6
##   p_grid .lower .upper .width .point .interval
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1  0.956  0.401  0.994   0.95 mode   qi</code></pre>
<p>Those returned a lot of output in addition to the mode. If all you want is the mode itself, you can just use <code>tidybayes::Mode()</code>.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1"><span class="kw">Mode</span>(samples<span class="op">$</span>p_grid)</a></code></pre></div>
<pre><code>## [1] 0.9562951</code></pre>
<p>Medians and means are typical measures of central tendency, too.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb148-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean   =</span> <span class="kw">mean</span>(p_grid),</a>
<a class="sourceLine" id="cb148-3" data-line-number="3">            <span class="dt">median =</span> <span class="kw">median</span>(p_grid))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##    mean median
##   &lt;dbl&gt;  &lt;dbl&gt;
## 1 0.803  0.843</code></pre>
<p>We can inspect the three types of point estimate in the left panel of Figure 3.4. First we’ll bundle the three point estimates together in a tibble.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1">(</a>
<a class="sourceLine" id="cb150-2" data-line-number="2">  point_estimates &lt;-</a>
<a class="sourceLine" id="cb150-3" data-line-number="3"><span class="st">  </span><span class="kw">bind_rows</span>(samples <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mean_qi</span>(p_grid),</a>
<a class="sourceLine" id="cb150-4" data-line-number="4">            samples <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">median_qi</span>(p_grid),</a>
<a class="sourceLine" id="cb150-5" data-line-number="5">            samples <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mode_qi</span>(p_grid)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb150-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(p_grid, .point) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb150-7" data-line-number="7"><span class="st">  </span><span class="co"># these last two columns will help us annotate  </span></a>
<a class="sourceLine" id="cb150-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x =</span> p_grid <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>.<span class="dv">03</span>, <span class="fl">.03</span>, <span class="fl">-.03</span>),</a>
<a class="sourceLine" id="cb150-9" data-line-number="9">         <span class="dt">y =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">.25</span>, <span class="fl">.4</span>))</a>
<a class="sourceLine" id="cb150-10" data-line-number="10">)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   p_grid .point     x     y
##    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1  0.803 mean   0.773  0.1 
## 2  0.843 median 0.873  0.25
## 3  0.956 mode   0.926  0.4</code></pre>
<p>The plot:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb152-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb152-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior),</a>
<a class="sourceLine" id="cb152-4" data-line-number="4">              <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb152-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> point_estimates<span class="op">$</span>p_grid) <span class="op">+</span></a>
<a class="sourceLine" id="cb152-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> point_estimates,</a>
<a class="sourceLine" id="cb152-7" data-line-number="7">            <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">label =</span> .point),</a>
<a class="sourceLine" id="cb152-8" data-line-number="8">            <span class="dt">angle =</span> <span class="dv">90</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb152-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</a>
<a class="sourceLine" id="cb152-10" data-line-number="10">       <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb152-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-41-1.png" width="336" /></p>
<p>As it turns out “<em>different loss functions imply different point estimates</em>” (p. 59, <em>emphasis</em> in the original).</p>
<p>Let <span class="math inline">\(p\)</span> be the proportion of the Earth covered by water and <span class="math inline">\(d\)</span> be our guess. If McElreath pays us $100 if we guess exactly right but subtracts money from the prize proportional to how far off we are, then our loss is proportional to <span class="math inline">\(p - d\)</span>. If we decide <span class="math inline">\(d = .5\)</span>, then our expected loss will be:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">loss =</span> posterior <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(<span class="fl">0.5</span> <span class="op">-</span><span class="st"> </span>p_grid)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb153-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">expected loss</span><span class="st">`</span> =<span class="st"> </span><span class="kw">sum</span>(loss))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   `expected loss`
##             &lt;dbl&gt;
## 1            78.4</code></pre>
<p>What McElreath did with <code>sapply()</code>, we’ll do with <code>purrr::map()</code>. If you haven’t used it, <code>map()</code> is part of a family of similarly-named functions (e.g., <code>map2()</code>) from the <a href="https://purrr.tidyverse.org">purrr package</a>, which is itself part of the <a href="https://www.tidyverse.org">tidyverse</a>. The <code>map()</code> family is the tidyverse alternative to the family of <code>apply()</code> functions from the base R framework. You can learn more about how to use the <code>map()</code> family <a href="https://purrr.tidyverse.org/reference/map.html">here</a> or <a href="https://jennybc.github.io/purrr-tutorial/ls01_map-name-position-shortcuts.html">here</a> or <a href="https://data.library.virginia.edu/getting-started-with-the-purrr-package-in-r/">here</a>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1">make_loss &lt;-<span class="st"> </span><span class="cf">function</span>(our_d) {</a>
<a class="sourceLine" id="cb155-2" data-line-number="2">  d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-3" data-line-number="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">loss =</span> posterior <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(our_d <span class="op">-</span><span class="st"> </span>p_grid)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-4" data-line-number="4"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">weighted_average_loss =</span> <span class="kw">sum</span>(loss))</a>
<a class="sourceLine" id="cb155-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb155-6" data-line-number="6"></a>
<a class="sourceLine" id="cb155-7" data-line-number="7">(</a>
<a class="sourceLine" id="cb155-8" data-line-number="8">  l &lt;-</a>
<a class="sourceLine" id="cb155-9" data-line-number="9"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-10" data-line-number="10"><span class="st">  </span><span class="kw">select</span>(p_grid) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-11" data-line-number="11"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">decision =</span> p_grid) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weighted_average_loss =</span> purrr<span class="op">::</span><span class="kw">map</span>(decision, make_loss)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb155-13" data-line-number="13"><span class="st">  </span><span class="kw">unnest</span>(weighted_average_loss) </a>
<a class="sourceLine" id="cb155-14" data-line-number="14">)</a></code></pre></div>
<pre><code>## # A tibble: 1,001 x 2
##    decision weighted_average_loss
##       &lt;dbl&gt;                 &lt;dbl&gt;
##  1    0                      201.
##  2    0.001                  200.
##  3    0.002                  200.
##  4    0.003                  200.
##  5    0.004                  199.
##  6    0.005                  199.
##  7    0.006                  199.
##  8    0.007                  199.
##  9    0.008                  198.
## 10    0.009                  198.
## # … with 991 more rows</code></pre>
<p>Now we’re ready for the right panel of Figure 3.4.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1"><span class="co"># this will help us find the x and y coordinates for the minimum value</span></a>
<a class="sourceLine" id="cb157-2" data-line-number="2">min_loss &lt;-</a>
<a class="sourceLine" id="cb157-3" data-line-number="3"><span class="st">  </span>l <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb157-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(weighted_average_loss <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(weighted_average_loss)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb157-5" data-line-number="5"><span class="st">  </span><span class="kw">as.numeric</span>()</a>
<a class="sourceLine" id="cb157-6" data-line-number="6"></a>
<a class="sourceLine" id="cb157-7" data-line-number="7"><span class="co"># the plot</span></a>
<a class="sourceLine" id="cb157-8" data-line-number="8">l <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb157-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> decision)) <span class="op">+</span></a>
<a class="sourceLine" id="cb157-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> weighted_average_loss),</a>
<a class="sourceLine" id="cb157-11" data-line-number="11">              <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb157-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> min_loss[<span class="dv">1</span>], <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb157-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> min_loss[<span class="dv">2</span>], <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb157-14" data-line-number="14"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;expected proportional loss&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb157-15" data-line-number="15"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-44-1.png" width="336" /></p>
<p>We saved the exact minimum value as <code>min_loss[1]</code>, which is 0.841. Within sampling error, this is the posterior median as depicted by our <code>samples</code>.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb158-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">posterior_median =</span> <span class="kw">median</span>(p_grid))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   posterior_median
##              &lt;dbl&gt;
## 1            0.843</code></pre>
<p>The quadratic loss <span class="math inline">\((d - p)^2\)</span> suggests we should use the mean instead. Let’s investigate.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1"><span class="co"># ammend our loss function</span></a>
<a class="sourceLine" id="cb160-2" data-line-number="2">make_loss &lt;-<span class="st"> </span><span class="cf">function</span>(our_d) {</a>
<a class="sourceLine" id="cb160-3" data-line-number="3">  d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-4" data-line-number="4"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">loss =</span> posterior <span class="op">*</span><span class="st"> </span>(our_d <span class="op">-</span><span class="st"> </span>p_grid)<span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-5" data-line-number="5"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">weighted_average_loss =</span> <span class="kw">sum</span>(loss))</a>
<a class="sourceLine" id="cb160-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb160-7" data-line-number="7"></a>
<a class="sourceLine" id="cb160-8" data-line-number="8"><span class="co"># remake our `l` data</span></a>
<a class="sourceLine" id="cb160-9" data-line-number="9">l &lt;-</a>
<a class="sourceLine" id="cb160-10" data-line-number="10"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-11" data-line-number="11"><span class="st">  </span><span class="kw">select</span>(p_grid) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-12" data-line-number="12"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">decision =</span> p_grid) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weighted_average_loss =</span> purrr<span class="op">::</span><span class="kw">map</span>(decision, make_loss)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-14" data-line-number="14"><span class="st">  </span><span class="kw">unnest</span>(weighted_average_loss)</a>
<a class="sourceLine" id="cb160-15" data-line-number="15"></a>
<a class="sourceLine" id="cb160-16" data-line-number="16"><span class="co"># update to the new minimum loss coordinates</span></a>
<a class="sourceLine" id="cb160-17" data-line-number="17">min_loss &lt;-</a>
<a class="sourceLine" id="cb160-18" data-line-number="18"><span class="st">  </span>l <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-19" data-line-number="19"><span class="st">  </span><span class="kw">filter</span>(weighted_average_loss <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(weighted_average_loss)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-20" data-line-number="20"><span class="st">  </span><span class="kw">as.numeric</span>()</a>
<a class="sourceLine" id="cb160-21" data-line-number="21"></a>
<a class="sourceLine" id="cb160-22" data-line-number="22"><span class="co"># update the plot</span></a>
<a class="sourceLine" id="cb160-23" data-line-number="23">l <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb160-24" data-line-number="24"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> decision)) <span class="op">+</span></a>
<a class="sourceLine" id="cb160-25" data-line-number="25"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> weighted_average_loss),</a>
<a class="sourceLine" id="cb160-26" data-line-number="26">              <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb160-27" data-line-number="27"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> min_loss[<span class="dv">1</span>], <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb160-28" data-line-number="28"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> min_loss[<span class="dv">2</span>], <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb160-29" data-line-number="29"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;expected proportional loss&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb160-30" data-line-number="30"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-46-1.png" width="336" /></p>
<p>Based on quadratic loss <span class="math inline">\((d - p)^2\)</span>, the exact minimum value is 0.8. Within sampling error, this is the posterior mean of our <code>samples</code>.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb161-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">posterior_meaan =</span> <span class="kw">mean</span>(p_grid))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   posterior_meaan
##             &lt;dbl&gt;
## 1           0.803</code></pre>
<blockquote>
<p>Usually, research scientists don’t think about loss functions. And so any point estimate like the mean or MAP that they may report isn’t intended to support any particular decision, but rather to describe the shape of the posterior. You might argue that the decision to make is whether or not to accept an hypothesis. But the challenge then is to say what the relevant costs and benefits would be, in terms of the knowledge gained or lost. Usually it’s better to communicate as much as you can about the posterior distribution, as well as the data and the model itself, so that others can build upon your work. Premature decisions to accept or reject hypotheses can cost lives. (p. 61)</p>
</blockquote>
<p>In the endnote (58) linked to the end of that quote in the text, McElreath wrote: “See <a href="https://statmodeling.stat.columbia.edu/wp-content/uploads/2013/03/1154-Hauer-The-harm-done-by-tests-of-significance.pdf">Hauer (2004)</a> for three tales from transportation safety in which testing resulted in premature incorrect decisions and a demonstrable and continuing loss of human life” (p. 448).</p>
</div>
</div>
<div id="sampling-to-simulate-prediction" class="section level2">
<h2><span class="header-section-number">3.3</span> Sampling to simulate prediction</h2>
<p>McElreath’s four good reasons for posterior simulation were</p>
<ol style="list-style-type: decimal">
<li>model checking,</li>
<li>software validation,</li>
<li>research design, and</li>
<li>forecasting.</li>
</ol>
<div id="dummy-data." class="section level3">
<h3><span class="header-section-number">3.3.1</span> Dummy data.</h3>
<p>Dummy data for the globe tossing model arise from the binomial likelihood. If you let <span class="math inline">\(w\)</span> be a count of water and <span class="math inline">\(n\)</span> be the number of tosses, the binomial likelihood is</p>
<p><span class="math display">\[\text{Pr} (w|n, p) = \frac{n!}{w!(n - w)!} p^w (1 - p)^{n - w}\]</span></p>
<p>Letting <span class="math inline">\(n = 2\)</span>, <span class="math inline">\(p(w) = .7\)</span>, and <span class="math inline">\(w_\text{observed} = 0 \text{ through }2\)</span>, the denisties are:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">n           =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb163-2" data-line-number="2">       <span class="dt">probability =</span> <span class="fl">.7</span>,</a>
<a class="sourceLine" id="cb163-3" data-line-number="3">       <span class="dt">w           =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb163-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dbinom</span>(w, <span class="dt">size =</span> n, <span class="dt">prob =</span> probability))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##       n probability     w density
##   &lt;dbl&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1     2         0.7     0   0.09 
## 2     2         0.7     1   0.42 
## 3     2         0.7     2   0.490</code></pre>
<p>If we’re going to simulate, we should probably <a href="https://stackoverflow.com/questions/13605271/reasons-for-using-the-set-seed-function">set our seed</a>. Doing so makes the results reproducible.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb165-2" data-line-number="2"><span class="kw">rbinom</span>(<span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">prob =</span> <span class="fl">.7</span>)</a></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Here are ten reproducible draws.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb167-2" data-line-number="2"><span class="kw">rbinom</span>(<span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">prob =</span> <span class="fl">.7</span>)</a></code></pre></div>
<pre><code>##  [1] 2 1 2 2 1 1 2 2 1 1</code></pre>
<p>Now generate 100,000 (i.e., <code>1e5</code>) reproducible dummy observations.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" data-line-number="1"><span class="co"># how many would you like?</span></a>
<a class="sourceLine" id="cb169-2" data-line-number="2">n_draws &lt;-<span class="st"> </span><span class="fl">1e5</span></a>
<a class="sourceLine" id="cb169-3" data-line-number="3"></a>
<a class="sourceLine" id="cb169-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb169-5" data-line-number="5">d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">draws =</span> <span class="kw">rbinom</span>(n_draws, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">prob =</span> <span class="fl">.7</span>))</a>
<a class="sourceLine" id="cb169-6" data-line-number="6"></a>
<a class="sourceLine" id="cb169-7" data-line-number="7">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb169-8" data-line-number="8"><span class="st">  </span><span class="kw">count</span>(draws) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb169-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">proportion =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(d))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   draws     n proportion
##   &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
## 1     0  9000      0.09 
## 2     1 42051      0.421
## 3     2 48949      0.489</code></pre>
<p>As McElreath mused in the text (p. 63), those simulated <code>proportion</code> values are very close to the analytically calculated values in our <code>density</code> column a few code blocks up.</p>
<p>Here’s the simulation updated so <span class="math inline">\(n = 9\)</span>, which we plot in our version of Figure 3.5.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb171-2" data-line-number="2">d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">draws =</span> <span class="kw">rbinom</span>(n_draws, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> <span class="fl">.7</span>))</a>
<a class="sourceLine" id="cb171-3" data-line-number="3"></a>
<a class="sourceLine" id="cb171-4" data-line-number="4"><span class="co"># the histogram</span></a>
<a class="sourceLine" id="cb171-5" data-line-number="5">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb171-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> draws)) <span class="op">+</span></a>
<a class="sourceLine" id="cb171-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">center =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb171-8" data-line-number="8">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb171-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>,</a>
<a class="sourceLine" id="cb171-10" data-line-number="10">                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">9</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb171-11" data-line-number="11"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb171-12" data-line-number="12"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb171-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-52-1.png" width="336" /></p>
<p>McElreath suggested we play around with different values of <code>size</code> and <code>prob</code>. With the next block of code, we’ll simulate nine conditions.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" data-line-number="1">n_draws &lt;-<span class="st"> </span><span class="fl">1e5</span></a>
<a class="sourceLine" id="cb172-2" data-line-number="2"></a>
<a class="sourceLine" id="cb172-3" data-line-number="3">simulate_binom &lt;-<span class="st"> </span><span class="cf">function</span>(n, probability) {</a>
<a class="sourceLine" id="cb172-4" data-line-number="4">  <span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb172-5" data-line-number="5">  <span class="kw">rbinom</span>(n_draws, <span class="dt">size =</span> n, <span class="dt">prob =</span> probability) </a>
<a class="sourceLine" id="cb172-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb172-7" data-line-number="7"></a>
<a class="sourceLine" id="cb172-8" data-line-number="8">d &lt;-</a>
<a class="sourceLine" id="cb172-9" data-line-number="9"><span class="st">  </span><span class="kw">crossing</span>(<span class="dt">n           =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>),</a>
<a class="sourceLine" id="cb172-10" data-line-number="10">           <span class="dt">probability =</span> <span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">.6</span>, <span class="fl">.9</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb172-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">draws =</span> <span class="kw">map2</span>(n, probability, simulate_binom)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb172-12" data-line-number="12"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb172-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n           =</span> <span class="kw">str_c</span>(<span class="st">&quot;n = &quot;</span>, n),</a>
<a class="sourceLine" id="cb172-14" data-line-number="14">         <span class="dt">probability =</span> <span class="kw">str_c</span>(<span class="st">&quot;p = &quot;</span>, probability)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb172-15" data-line-number="15"><span class="st">  </span><span class="kw">unnest</span>(draws)</a>
<a class="sourceLine" id="cb172-16" data-line-number="16"></a>
<a class="sourceLine" id="cb172-17" data-line-number="17"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   n     probability draws
##   &lt;chr&gt; &lt;chr&gt;       &lt;int&gt;
## 1 n = 3 p = 0.3         0
## 2 n = 3 p = 0.3         2
## 3 n = 3 p = 0.3         1
## 4 n = 3 p = 0.3         0
## 5 n = 3 p = 0.3         1
## 6 n = 3 p = 0.3         1</code></pre>
<p>Let’s plot the simulation results.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb174-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> draws)) <span class="op">+</span></a>
<a class="sourceLine" id="cb174-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">center =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb174-4" data-line-number="4">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb174-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>,</a>
<a class="sourceLine" id="cb174-6" data-line-number="6">                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">9</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb174-7" data-line-number="7"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb174-8" data-line-number="8"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb174-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb174-10" data-line-number="10"><span class="st">  </span><span class="kw">facet_grid</span>(n <span class="op">~</span><span class="st"> </span>probability)</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-54-1.png" width="576" /></p>
</div>
<div id="model-checking." class="section level3">
<h3><span class="header-section-number">3.3.2</span> Model checking.</h3>
<p>If you’re new to applied statistics, you might be surprised how often mistakes arise.</p>
<div id="did-the-software-work" class="section level4">
<h4><span class="header-section-number">3.3.2.1</span> Did the software work?</h4>
<p>Let this haunt your dreams: “There is no way to really be sure that software works correctly” (p. 64).</p>
<p>If you’d like to dive deeper into these dark waters, check out one my favorite talks from StanCon 2018, <a href="https://youtu.be/pKZLJPrZLhU?t=26285"><em>Esther Williams in the Harold Holt Memorial Swimming Pool</em></a>, by the ineffable <a href="https://twitter.com/dan_p_simpson">Dan Simpson</a>. If Simpson doesn’t end up drowning you, see Gabry and Simpson’s talk at the Royal Statistical Society 2018, <a href="https://www.youtube.com/watch?v=E8vdXoJId8M"><em>Visualization in Bayesian workflow</em></a>, a follow-up blog <a href="https://statmodeling.stat.columbia.edu/2019/03/19/maybe-its-time-to-let-the-old-ways-die-or-we-broke-r-hat-so-now-we-have-to-fix-it/"><em>Maybe it’s time to let the old ways die; or We broke R-hat so now we have to fix it</em></a>, and that blog’s associated pre-print by Vehtari, Gelman, Simpson, Carpenter, and Bürkner <a href="https://arxiv.org/abs/1903.08008"><em>Rank-normalization, folding, and localization: An improved <span class="math inline">\(\hat R\)</span> for assessing convergence of MCMC</em></a>.</p>
</div>
<div id="is-the-model-adequate" class="section level4">
<h4><span class="header-section-number">3.3.2.2</span> Is the model adequate?</h4>
<blockquote>
<p>The implied predictions of the model are uncertain in two ways, and it’s important to be aware of both.</p>
<p>First, there is observation uncertainty. For any unique value of the parameter <span class="math inline">\(p\)</span>, there is a unique implied pattern of observations that the model expects. These patterns of observations are the same gardens of forking data that you explored in the previous chapter. These patterns are also what you sampled in the previous section. There is uncertainty in the predicted observations, because even if you know <span class="math inline">\(p\)</span> with certainty, you won’t know the next globe toss with certainty (unless <span class="math inline">\(p = 0\)</span> or <span class="math inline">\(p = 1\)</span>).</p>
<p>Second, there is uncertainty about <span class="math inline">\(p\)</span>. The posterior distribution over <span class="math inline">\(p\)</span> embodies this uncertainty. And since there is uncertainty about <span class="math inline">\(p\)</span>, there is uncertainty about everything that depends upon <span class="math inline">\(p\)</span>. The uncertainty in <span class="math inline">\(p\)</span> will interact with the sampling variation, when we try to assess what the model tells us about outcomes.</p>
<p>We’d like to <em>propagate</em> the parameter uncertainty–carry it forward–as we evaluate the implied predictions. All that is required is averaging over the posterior density for <span class="math inline">\(p\)</span>, while computing the predictions. For each possible value of the parameter <span class="math inline">\(p\)</span>, there is an implied distribution of outcomes. So if you were to compute the sampling distribution of outcomes at each value of <span class="math inline">\(p\)</span>, then you could average all of these prediction distributions together, using the posterior probabilities of each value of <span class="math inline">\(p\)</span>, to get a posterior predictive distribution. (p. 56, <em>emphasis</em> in the original)</p>
</blockquote>
<p>All this is depicted in Figure 3.6. To get ready to make our version, let’s first refresh our original grid approximation <code>d</code>.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" data-line-number="1"><span class="co"># how many grid points would you like?</span></a>
<a class="sourceLine" id="cb175-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">1001</span></a>
<a class="sourceLine" id="cb175-3" data-line-number="3">n_success &lt;-<span class="st"> </span><span class="dv">6</span></a>
<a class="sourceLine" id="cb175-4" data-line-number="4">n_trials  &lt;-<span class="st"> </span><span class="dv">9</span></a>
<a class="sourceLine" id="cb175-5" data-line-number="5"></a>
<a class="sourceLine" id="cb175-6" data-line-number="6">(</a>
<a class="sourceLine" id="cb175-7" data-line-number="7">  d &lt;-</a>
<a class="sourceLine" id="cb175-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">p_grid =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> n),</a>
<a class="sourceLine" id="cb175-9" data-line-number="9">         <span class="co"># note we&#39;re still using a flat uniform prior</span></a>
<a class="sourceLine" id="cb175-10" data-line-number="10">         <span class="dt">prior  =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb175-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">dbinom</span>(n_success, <span class="dt">size =</span> n_trials, <span class="dt">prob =</span> p_grid)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb175-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior =</span> (likelihood <span class="op">*</span><span class="st"> </span>prior) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood <span class="op">*</span><span class="st"> </span>prior))</a>
<a class="sourceLine" id="cb175-13" data-line-number="13">)</a></code></pre></div>
<pre><code>## # A tibble: 1,001 x 4
##    p_grid prior likelihood posterior
##     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1  0         1   0.        0.      
##  2  0.001     1   8.37e-17  8.37e-19
##  3  0.002     1   5.34e-15  5.34e-17
##  4  0.003     1   6.07e-14  6.07e-16
##  5  0.004     1   3.40e-13  3.40e-15
##  6  0.005     1   1.29e-12  1.29e-14
##  7  0.006     1   3.85e-12  3.85e-14
##  8  0.007     1   9.68e-12  9.68e-14
##  9  0.008     1   2.15e-11  2.15e-13
## 10  0.009     1   4.34e-11  4.34e-13
## # … with 991 more rows</code></pre>
<p>We can make our version of the top of Figure 3.6 with a little tricky <code>filter</code>ing.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb177-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></a>
<a class="sourceLine" id="cb177-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior),</a>
<a class="sourceLine" id="cb177-4" data-line-number="4">              <span class="dt">color =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb177-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb177-6" data-line-number="6"><span class="st">                 </span><span class="kw">filter</span>(p_grid <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">.1</span>, <span class="dt">to =</span> <span class="fl">.9</span>, <span class="dt">by =</span> <span class="fl">.1</span>), <span class="dv">3</span> <span class="op">/</span><span class="st"> </span><span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb177-7" data-line-number="7">               <span class="kw">aes</span>(<span class="dt">xend =</span> p_grid,</a>
<a class="sourceLine" id="cb177-8" data-line-number="8">                   <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">yend =</span> posterior, <span class="dt">size =</span> posterior),</a>
<a class="sourceLine" id="cb177-9" data-line-number="9">               <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>, <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb177-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb177-11" data-line-number="11"><span class="st">               </span><span class="kw">filter</span>(p_grid <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">.1</span>, <span class="dt">to =</span> <span class="fl">.9</span>, <span class="dt">by =</span> <span class="fl">.1</span>), <span class="dv">3</span> <span class="op">/</span><span class="st"> </span><span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb177-12" data-line-number="12">             <span class="kw">aes</span>(<span class="dt">y =</span> posterior)) <span class="op">+</span></a>
<a class="sourceLine" id="cb177-13" data-line-number="13"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.08</span>, <span class="dt">y =</span> <span class="fl">.0025</span>,</a>
<a class="sourceLine" id="cb177-14" data-line-number="14">           <span class="dt">label =</span> <span class="st">&quot;Posterior probability&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb177-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb177-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;probability of water&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">10</span>) <span class="op">/</span><span class="st"> </span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb177-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb177-18" data-line-number="18"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-56-1.png" width="672" /></p>
<p>Note how we weighted the widths of the vertical lines by the <code>posterior</code> density.</p>
<p>We’ll need to do a bit of wrangling before we’re ready to make the plot in the middle panel of Figure 3.6.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" data-line-number="1">n_draws &lt;-<span class="st"> </span><span class="fl">1e5</span></a>
<a class="sourceLine" id="cb178-2" data-line-number="2"></a>
<a class="sourceLine" id="cb178-3" data-line-number="3">simulate_binom &lt;-<span class="st"> </span><span class="cf">function</span>(probability) {</a>
<a class="sourceLine" id="cb178-4" data-line-number="4">  <span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb178-5" data-line-number="5">  <span class="kw">rbinom</span>(n_draws, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> probability) </a>
<a class="sourceLine" id="cb178-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb178-7" data-line-number="7"></a>
<a class="sourceLine" id="cb178-8" data-line-number="8">d_small &lt;-</a>
<a class="sourceLine" id="cb178-9" data-line-number="9"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">probability =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">.1</span>, <span class="dt">to =</span> <span class="fl">.9</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb178-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">draws =</span> purrr<span class="op">::</span><span class="kw">map</span>(probability, simulate_binom)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb178-11" data-line-number="11"><span class="st">  </span><span class="kw">unnest</span>(draws) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb178-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">label =</span> <span class="kw">str_c</span>(<span class="st">&quot;p = &quot;</span>, probability))</a>
<a class="sourceLine" id="cb178-13" data-line-number="13"></a>
<a class="sourceLine" id="cb178-14" data-line-number="14"><span class="kw">head</span>(d_small)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   probability draws label  
##         &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;  
## 1         0.1     0 p = 0.1
## 2         0.1     2 p = 0.1
## 3         0.1     0 p = 0.1
## 4         0.1     0 p = 0.1
## 5         0.1     1 p = 0.1
## 6         0.1     1 p = 0.1</code></pre>
<p>Now we’re ready to plot.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" data-line-number="1">d_small <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb180-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> draws)) <span class="op">+</span></a>
<a class="sourceLine" id="cb180-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">center =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb180-4" data-line-number="4">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb180-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">9</span>, <span class="dt">by =</span> <span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb180-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb180-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;Sampling distributions&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb180-8" data-line-number="8"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb180-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb180-10" data-line-number="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>label, <span class="dt">ncol =</span> <span class="dv">9</span>) </a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-58-1.png" width="768" /></p>
<p>To make the plot at the bottom of Figure 3.6, we’ll redefine our <code>samples</code>, this time including the <code>w</code> variable (see the R code 3.26 block in the text).</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1"><span class="co"># how many samples would you like?</span></a>
<a class="sourceLine" id="cb181-2" data-line-number="2">n_samples &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb181-3" data-line-number="3"></a>
<a class="sourceLine" id="cb181-4" data-line-number="4"><span class="co"># make it reproducible</span></a>
<a class="sourceLine" id="cb181-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb181-6" data-line-number="6"></a>
<a class="sourceLine" id="cb181-7" data-line-number="7">samples &lt;-</a>
<a class="sourceLine" id="cb181-8" data-line-number="8"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb181-9" data-line-number="9"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> n_samples, <span class="dt">weight =</span> posterior, <span class="dt">replace =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb181-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">w =</span> purrr<span class="op">::</span><span class="kw">map_dbl</span>(p_grid, rbinom, <span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">9</span>))</a>
<a class="sourceLine" id="cb181-11" data-line-number="11"></a>
<a class="sourceLine" id="cb181-12" data-line-number="12"><span class="kw">glimpse</span>(samples)</a></code></pre></div>
<pre><code>## Observations: 10,000
## Variables: 5
## $ p_grid     &lt;dbl&gt; 0.564, 0.651, 0.487, 0.592, 0.596, 0.787, 0.727, 0.490, 0.751, 0.449, 0.619, 0…
## $ prior      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ likelihood &lt;dbl&gt; 0.224085305, 0.271795022, 0.151288232, 0.245578315, 0.248256678, 0.192870804, …
## $ posterior  &lt;dbl&gt; 2.240853e-03, 2.717950e-03, 1.512882e-03, 2.455783e-03, 2.482567e-03, 1.928708…
## $ w          &lt;dbl&gt; 4, 7, 3, 3, 7, 6, 8, 2, 6, 4, 5, 5, 8, 6, 4, 6, 8, 2, 6, 9, 9, 7, 4, 8, 9, 8, …</code></pre>
<p>Here’s our histogram.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb183-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> w)) <span class="op">+</span></a>
<a class="sourceLine" id="cb183-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">center =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb183-4" data-line-number="4">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb183-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;number of water samples&quot;</span>,</a>
<a class="sourceLine" id="cb183-6" data-line-number="6">                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">9</span>, <span class="dt">by =</span> <span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb183-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb183-8" data-line-number="8"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior predictive distribution&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb183-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">9</span>,</a>
<a class="sourceLine" id="cb183-10" data-line-number="10">                  <span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">3000</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb183-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-60-1.png" width="288" /></p>
<p>In Figure 3.7, McElreath considered the longst sequence of the sampe values. We’ve been using <code>rbinom()</code> with the size parameter set to 9 for our simulations. E.g.,</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" data-line-number="1"><span class="kw">rbinom</span>(<span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> <span class="fl">.6</span>)</a></code></pre></div>
<pre><code>##  [1] 7 5 6 8 7 5 6 3 3 4</code></pre>
<p>Notice this collapsed (i.e., aggregated) over the sequences within the individual sets of 9. What we need is to simulate nine individual trials many times over. For example, this</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" data-line-number="1"><span class="kw">rbinom</span>(<span class="dv">9</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">.6</span>)</a></code></pre></div>
<pre><code>## [1] 0 1 1 1 0 0 0 0 0</code></pre>
<p>would be the disaggregated version of just one of the numerals returned by <code>rbinom()</code> when <code>size = 9</code>. So let’s try simulating again with un-aggregated samples. We’ll keep adding to our <code>samples</code> tibble. In addition to the disaggregated <code>draws</code> based on the <span class="math inline">\(p\)</span> values listed in <code>p_grid</code>, we’ll also want to add a row index for each of those <code>p_grid</code> values–it’ll come in handy when we plot.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" data-line-number="1"><span class="co"># make it reproducible</span></a>
<a class="sourceLine" id="cb188-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb188-3" data-line-number="3"></a>
<a class="sourceLine" id="cb188-4" data-line-number="4">samples &lt;-</a>
<a class="sourceLine" id="cb188-5" data-line-number="5"><span class="st">  </span>samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb188-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter  =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb188-7" data-line-number="7">         <span class="dt">draws =</span> purrr<span class="op">::</span><span class="kw">map</span>(p_grid, rbinom, <span class="dt">n =</span> <span class="dv">9</span>, <span class="dt">size =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb188-8" data-line-number="8"><span class="st">  </span><span class="kw">unnest</span>(draws)</a>
<a class="sourceLine" id="cb188-9" data-line-number="9"></a>
<a class="sourceLine" id="cb188-10" data-line-number="10"><span class="kw">glimpse</span>(samples)</a></code></pre></div>
<pre><code>## Observations: 90,000
## Variables: 7
## $ p_grid     &lt;dbl&gt; 0.564, 0.564, 0.564, 0.564, 0.564, 0.564, 0.564, 0.564, 0.564, 0.651, 0.651, 0…
## $ prior      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ likelihood &lt;dbl&gt; 0.2240853, 0.2240853, 0.2240853, 0.2240853, 0.2240853, 0.2240853, 0.2240853, 0…
## $ posterior  &lt;dbl&gt; 0.002240853, 0.002240853, 0.002240853, 0.002240853, 0.002240853, 0.002240853, …
## $ w          &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 3, 3, 3, 3, 3, 3, 3, 3, …
## $ iter       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, …
## $ draws      &lt;int&gt; 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, …</code></pre>
<p>The main action is in the <code>draws</code> column.</p>
<p>Now we have to count the longest sequences. The base R <a href="https://www.rdocumentation.org/packages/base/versions/3.3/topics/rle"><code>rle()</code> function</a> will help with that. Consider McElreath’s sequence of tosses.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1">tosses &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>)</a></code></pre></div>
<p>You can plug that into <code>rle()</code>.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1"><span class="kw">rle</span>(tosses)</a></code></pre></div>
<pre><code>## Run Length Encoding
##   lengths: int [1:7] 1 1 3 1 1 1 1
##   values : chr [1:7] &quot;w&quot; &quot;l&quot; &quot;w&quot; &quot;l&quot; &quot;w&quot; &quot;l&quot; &quot;w&quot;</code></pre>
<p>For our purposes, we’re interested in <code>lengths</code>. That tells us the length of each sequences of the same value. The <code>3</code> corresponds to our run of three <code>w</code>s. The <code>max()</code> function will help us confirm it’s the largest value.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1"><span class="kw">rle</span>(tosses)<span class="op">$</span>lengths <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">max</span>()</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Now let’s apply our method to the data and plot.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb195-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb195-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">longest_run_length =</span> <span class="kw">rle</span>(draws)<span class="op">$</span>lengths <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">max</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb195-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb195-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> longest_run_length)) <span class="op">+</span></a>
<a class="sourceLine" id="cb195-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> longest_run_length <span class="op">==</span><span class="st"> </span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb195-7" data-line-number="7">                 <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">center =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb195-8" data-line-number="8">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb195-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb195-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;longest run length&quot;</span>,</a>
<a class="sourceLine" id="cb195-11" data-line-number="11">                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">9</span>, <span class="dt">by =</span> <span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb195-12" data-line-number="12"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb195-13" data-line-number="13"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb195-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb195-15" data-line-number="15">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-67-1.png" width="336" /></p>
<p>Let’s look at <code>rle()</code> again.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1"><span class="kw">rle</span>(tosses)</a></code></pre></div>
<pre><code>## Run Length Encoding
##   lengths: int [1:7] 1 1 3 1 1 1 1
##   values : chr [1:7] &quot;w&quot; &quot;l&quot; &quot;w&quot; &quot;l&quot; &quot;w&quot; &quot;l&quot; &quot;w&quot;</code></pre>
<p>We can use the length of the output (i.e., 7 in this example) as the numbers of switches from, in this case, “w” and “l”.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1"><span class="kw">rle</span>(tosses)<span class="op">$</span>lengths <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">length</span>()</a></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>With that new trick, we’re ready to make the right panel of Figure 3.7.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" data-line-number="1">samples <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb200-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb200-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">longest_run_length =</span> <span class="kw">rle</span>(draws)<span class="op">$</span>lengths <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">length</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb200-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb200-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> longest_run_length)) <span class="op">+</span></a>
<a class="sourceLine" id="cb200-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> longest_run_length <span class="op">==</span><span class="st"> </span><span class="dv">6</span>),</a>
<a class="sourceLine" id="cb200-7" data-line-number="7">                 <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">center =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb200-8" data-line-number="8">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb200-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb200-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;number of switches&quot;</span>,</a>
<a class="sourceLine" id="cb200-11" data-line-number="11">                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">9</span>, <span class="dt">by =</span> <span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb200-12" data-line-number="12"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb200-13" data-line-number="13"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb200-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb200-15" data-line-number="15">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-70-1.png" width="336" /></p>
</div>
</div>
</div>
<div id="summary-lets-practice-in-brms" class="section level2">
<h2><span class="header-section-number">3.4</span> <del>Summary</del> Let’s practice in brms</h2>
<p>Open brms.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1"><span class="kw">library</span>(brms)</a></code></pre></div>
<p>With brms, we’ll fit the primary model of <span class="math inline">\(w = 6\)</span> and <span class="math inline">\(n = 9\)</span> much like we did at the end of the project for Chapter 2.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" data-line-number="1">b3<span class="fl">.1</span> &lt;-</a>
<a class="sourceLine" id="cb202-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">w =</span> <span class="dv">6</span>), </a>
<a class="sourceLine" id="cb202-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;identity&quot;</span>),</a>
<a class="sourceLine" id="cb202-4" data-line-number="4">      w <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(<span class="dv">9</span>) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb202-5" data-line-number="5">      <span class="co"># this is a flat prior</span></a>
<a class="sourceLine" id="cb202-6" data-line-number="6">      <span class="kw">prior</span>(<span class="kw">beta</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb202-7" data-line-number="7">      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">.999</span>),</a>
<a class="sourceLine" id="cb202-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb202-9" data-line-number="9">      <span class="dt">file =</span> <span class="st">&quot;fits/b03.01&quot;</span>)</a></code></pre></div>
<p>We’ll learn more about the beta distribution in Chapter 11. But for now, here’s the posterior summary for <code>b_Intercept</code>, the probability of a “w”.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1"><span class="kw">posterior_summary</span>(b3<span class="fl">.1</span>)[<span class="st">&quot;b_Intercept&quot;</span>, ] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb203-2" data-line-number="2"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
##      0.64      0.14      0.36      0.88</code></pre>
<p>As we’ll fully cover in the next chapter, <code>Estimate</code> is the posterior mean, the two <code>Q</code> columns are the quantile-based 95% intervals, and <code>Est.Error</code> is the posterior standard deviation.</p>
<p>Much like the way we used the <code>samples()</code> function to simulate probability values, above, we can do so with the <code>brms::fitted()</code> function. But we will have to specify <code>scale = &quot;linear&quot;</code> in order to return results in the probability metric. By default, <code>brms::fitted()</code> will return summary information. Since we want actual simulation draws, we’ll specify <code>summary = F</code>.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1">f &lt;-</a>
<a class="sourceLine" id="cb205-2" data-line-number="2"><span class="st">  </span><span class="kw">fitted</span>(b3<span class="fl">.1</span>, </a>
<a class="sourceLine" id="cb205-3" data-line-number="3">         <span class="dt">summary =</span> F,</a>
<a class="sourceLine" id="cb205-4" data-line-number="4">         <span class="dt">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb205-5" data-line-number="5"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb205-6" data-line-number="6"><span class="st">  </span><span class="kw">set_names</span>(<span class="st">&quot;p&quot;</span>)</a>
<a class="sourceLine" id="cb205-7" data-line-number="7"></a>
<a class="sourceLine" id="cb205-8" data-line-number="8"><span class="kw">glimpse</span>(f)</a></code></pre></div>
<pre><code>## Observations: 4,000
## Variables: 1
## $ p &lt;dbl&gt; 0.6920484, 0.5559454, 0.6096088, 0.5305334, 0.4819733, 0.6724561, 0.6402367, 0.8356569,…</code></pre>
<p>By default, we have a generically-named vector <code>V1</code> of 4,000 samples. We’ll explain the defaults in later chapters. For now, notice we can view these in a density.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb207-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p)) <span class="op">+</span></a>
<a class="sourceLine" id="cb207-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb207-4" data-line-number="4"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.08</span>, <span class="dt">y =</span> <span class="fl">2.5</span>,</a>
<a class="sourceLine" id="cb207-5" data-line-number="5">           <span class="dt">label =</span> <span class="st">&quot;Posterior probability&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb207-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;probability of water&quot;</span>,</a>
<a class="sourceLine" id="cb207-7" data-line-number="7">                     <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.5</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb207-8" data-line-number="8">                     <span class="dt">limits =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb207-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb207-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-74-1.png" width="672" /></p>
<p>Looks a lot like the posterior probability density at the top of Figure 3.6, doesn’t it? Much like we did with <code>samples</code>, we can use this distribution of probabilities to predict histograms of <code>w</code> counts. With those in hand, we can make an analogue to the histogram in the bottom panel of Figure 3.6.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" data-line-number="1"><span class="co"># the simulation</span></a>
<a class="sourceLine" id="cb208-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb208-3" data-line-number="3"></a>
<a class="sourceLine" id="cb208-4" data-line-number="4">f &lt;-</a>
<a class="sourceLine" id="cb208-5" data-line-number="5"><span class="st">  </span>f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb208-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">w =</span> <span class="kw">rbinom</span>(<span class="kw">n</span>(), <span class="dt">size =</span> n_trials,  <span class="dt">prob =</span> p))</a>
<a class="sourceLine" id="cb208-7" data-line-number="7"></a>
<a class="sourceLine" id="cb208-8" data-line-number="8"><span class="co"># the plot</span></a>
<a class="sourceLine" id="cb208-9" data-line-number="9">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb208-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> w)) <span class="op">+</span></a>
<a class="sourceLine" id="cb208-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">center =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb208-12" data-line-number="12">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb208-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;number of water samples&quot;</span>,</a>
<a class="sourceLine" id="cb208-14" data-line-number="14">                     <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">9</span>, <span class="dt">by =</span> <span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb208-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1200</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb208-16" data-line-number="16"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Posterior predictive distribution&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb208-17" data-line-number="17"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb208-18" data-line-number="18"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="03_files/figure-gfm/unnamed-chunk-75-1.png" width="288" /></p>
<p>As you might imagine, we can use the output from <code>fitted()</code> to return disaggregated batches of 0s and 1s, too. And we could even use those disaggregated 0s and 1s to examine longest run lengths and numbers of switches as in the analyses for Figure 3.7. I’ll leave those as exercises for the interested reader.</p>
</div>
<div id="reference-2" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://xcelab.net/rm/statistical-rethinking/">McElreath, R. (2015). <em>Statistical rethinking: A Bayesian course with examples in R and Stan.</em> Chapman &amp; Hall/CRC Press.</a></p>
</div>
<div id="session-info-2" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] brms_2.12.0          Rcpp_1.0.3           tidybayes_2.0.1.9000 patchwork_1.0.0     
##  [5] forcats_0.4.0        stringr_1.4.0        dplyr_0.8.4          purrr_0.3.3         
##  [9] readr_1.3.1          tidyr_1.0.2          tibble_2.1.3         ggplot2_3.2.1       
## [13] tidyverse_1.3.0     
## 
## loaded via a namespace (and not attached):
##   [1] colorspace_1.4-1          ggridges_0.5.2            rsconnect_0.8.16         
##   [4] markdown_1.1              base64enc_0.1-3           rethinking_1.59          
##   [7] fs_1.3.1                  rstudioapi_0.10           farver_2.0.3             
##  [10] rstan_2.19.2              DT_0.11                   svUnit_0.7-12            
##  [13] fansi_0.4.1               mvtnorm_1.0-12            lubridate_1.7.4          
##  [16] xml2_1.2.2                bridgesampling_0.8-1      knitr_1.26               
##  [19] shinythemes_1.1.2         bayesplot_1.7.1           jsonlite_1.6.1           
##  [22] broom_0.5.3               dbplyr_1.4.2              shiny_1.4.0              
##  [25] compiler_3.6.2            httr_1.4.1                backports_1.1.5          
##  [28] assertthat_0.2.1          Matrix_1.2-18             fastmap_1.0.1            
##  [31] lazyeval_0.2.2            cli_2.0.1                 later_1.0.0              
##  [34] htmltools_0.4.0           prettyunits_1.1.1         tools_3.6.2              
##  [37] igraph_1.2.4.2            coda_0.19-3               gtable_0.3.0             
##  [40] glue_1.3.1                reshape2_1.4.3            cellranger_1.1.0         
##  [43] vctrs_0.2.2               nlme_3.1-142              crosstalk_1.0.0          
##  [46] xfun_0.12                 ps_1.3.0                  rvest_0.3.5              
##  [49] miniUI_0.1.1.1            mime_0.8                  lifecycle_0.1.0          
##  [52] gtools_3.8.1              MASS_7.3-51.4             zoo_1.8-7                
##  [55] scales_1.1.0              colourpicker_1.0          hms_0.5.3                
##  [58] promises_1.1.0            Brobdingnag_1.2-6         parallel_3.6.2           
##  [61] inline_0.3.15             shinystan_2.5.0           yaml_2.2.1               
##  [64] gridExtra_2.3             loo_2.2.0                 StanHeaders_2.19.0       
##  [67] stringi_1.4.5             dygraphs_1.1.1.6          pkgbuild_1.0.6           
##  [70] rlang_0.4.4               pkgconfig_2.0.3           matrixStats_0.55.0       
##  [73] HDInterval_0.2.0          evaluate_0.14             lattice_0.20-38          
##  [76] rstantools_2.0.0          htmlwidgets_1.5.1         labeling_0.3             
##  [79] processx_3.4.1            tidyselect_1.0.0          plyr_1.8.5               
##  [82] magrittr_1.5              R6_2.4.1                  generics_0.0.2           
##  [85] DBI_1.1.0                 pillar_1.4.3              haven_2.2.0              
##  [88] withr_2.1.2               xts_0.12-0                abind_1.4-5              
##  [91] modelr_0.1.5              crayon_1.3.4              arrayhelpers_1.0-20160527
##  [94] utf8_1.1.4                rmarkdown_2.0             grid_3.6.2               
##  [97] readxl_1.3.1              callr_3.4.1               threejs_0.3.3            
## [100] reprex_0.3.0              digest_0.6.23             xtable_1.8-4             
## [103] httpuv_1.5.2              stats4_3.6.2              munsell_0.5.0            
## [106] viridisLite_0.3.0         shinyjs_1.1</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="small-worlds-and-large-worlds.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
